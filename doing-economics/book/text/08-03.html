
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>
    Doing Economics: Empirical Project 8: Working in R
    </title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="../../assets/favicon.png">
    <meta property="og:title" content="Empirical Project 8: Working in R" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.core-econ.org/doing-economics/book/text/08-03.html" />
    <meta property="og:description" content="A unique resource for learning data handling, software and statistical skills by working through projects that address real-world policy problems." />
    <meta property="og:image" content="https://www.core-econ.org/doing-economics/book/images/web/cover.jpg" />
    <link rel="stylesheet" type="text/css" media="all" href="../styles/web.css?date=20200224120313" />
    <script>
        function delete_cookie(name) {
            document.cookie = name + '=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT;';
            console.log('Expired and removed MathJax menu cookie.');
        }
        delete_cookie('mjx.menu')
    </script>
            <script id="MathJaxConfig" type="text/x-mathjax-config" >
                MathJax.Hub.Config({
                    "HTML-CSS": {
                        availableFonts: [], // force use of webFont
                        webFont: "Gyre-Pagella",
                        scale: 90,
                        styles: {
                            ".MathJax [style*=border-top-width]": {
                                "border-top-width": "0.5pt ! important"
                            }
                        }
                    },
                    messageStyle: "none"
                });
            </script>
            <script id="MathJax"
                src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML">
            </script>
<script>
WebFontConfig = {
     google: {
         families: ['Amiri:400,400i,700', 'Source Sans Pro:400,700,700:latin-ext', 'Asap:400,400i,600,600i']
     }
};
(function(d) {
    var wf = d.createElement('script'), s = d.scripts[0];
    wf.src = 'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js';
    wf.async = true;
    s.parentNode.insertBefore(wf, s);
})(document)
</script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71347024-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-106812057-1');
</script>
</head>
<body class="book chapter subchapter"
>
<div id="wrapper">
<div class="masthead">
        <ul>
                <li class="masthead-book-title">
                    <a href="../../index.html">Doing Economics</a>
                </li>
        </ul>
    <div class="controls">
    </div>
</div><!--.masthead-->
<div class="nav-buttons">
	<a class="nav-back-button">←</a>
	<a class="nav-button" href="#nav">Contents</a>
</div>
    <div class="chapter-opener-image chapter-opener-image-none">
    </div>
	<div id="content">
<h1 id="empirical-project-8-working-in-r"><strong>Empirical Project 8</strong> Working in R</h1>
<blockquote class="info web-full-width">
  <h3 id="download-the-code">Download the code</h3>
  <p>To <a href="https://tinyco.re/9274736">download the code chunks used in this project</a>, right-click on the download link and select ‘Save Link As…’. You’ll need to save the code download to your working directory, and open it in RStudio.</p>
  <p>Don’t forget to also download the data into your working directory by following the steps in this project.</p>
</blockquote>
<h2 class="save-1" id="getting-started-in-r">Getting started in R</h2>
<p>For this project you will need the following packages:</p>
<ul>
  <li><code class="language-r highlighter-rouge"><span class="n">tidyverse</span></code>, to help with data manipulation</li>
  <li><code class="language-r highlighter-rouge"><span class="n">readxl</span></code>, to import an Excel spreadsheet</li>
  <li><code class="language-r highlighter-rouge"><span class="n">knitr</span></code>, to format tables.</li>
</ul>
<p>If you need to install any of these packages, run the following code:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"tidyverse"</span><span class="p">,</span><span class="w"> </span><span class="s2">"readxl"</span><span class="p">,</span><span class="w"> </span><span class="s2">"knitr"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>
<p>You can import the libraries now, or when they are used in the R walk-throughs below.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<h2 id="part-81-cleaning-and-summarizing-the-data">Part 8.1 Cleaning and summarizing the data</h2>
<blockquote class="box fixed">
  <h3 id="learning-objectives-for-this-part">Learning objectives for this part</h3>
  <ul>
    <li>detect and correct entries in a dataset</li>
    <li>recode variables to make them easier to analyse</li>
    <li>calculate percentiles for subsets of the data.</li>
  </ul>
</blockquote>
<p>So far we have been working with data that was formatted correctly. However, sometimes the datasets will be messier and we will need to clean the data before starting any analysis. Data cleaning involves checking that all variables are formatted correctly, all observations are entered correctly (e.g. no typos), and missing values are coded in a way that the software you are using can understand. Otherwise, the software will either not be able to analyse your data, or only analyse the observations it recognizes, which could lead to incorrect results and conclusions.</p>
<p>In the data we will use, the European Values Study (EVS) data has been converted to an Excel spreadsheet from another program, so there are some entries that were not converted correctly and some variables that need to be recoded (for example, replacing words with numbers, or replacing one number with another).</p>
<p>Download the EVS data and documentation:</p>
<ul>
  <li>Download the <a href="https://tinyco.re/9465901" class="show-url">EVS data</a>.</li>
  <li>For the documentation, go to <a href="https://tinyco.re/6701388" class="show-url">the data download site</a>.</li>
  <li>Click on the ‘Data and Documents’ button in the middle of the page, then click the ‘Other Documents’ button and download the PDF file called ‘ZA4804_EVS_VariableCorrespondence.pdf’. This file contains information about each variable in the dataset (e.g. variable name and what it measures).</li>
</ul>
<p>Although we will be performing our analysis in R, the data has been provided as an Excel spreadsheet, so look at the spreadsheet in Excel first to understand its structure.</p>
<ol class="text-question tighten-10">
  <li>The Excel spreadsheet contains multiple worksheets, one for each wave, that need to be joined together to create a single ‘tibble’ (like a spreadsheet for R). The variable names currently do not tell us what the variable is, so we need to provide labels and short descriptions to avoid confusion.</li>
</ol>
<ul class="text-sub-question tighten-15">
  <li>Using the <code class="language-r highlighter-rouge"><span class="n">rbind</span></code> function, load each worksheet containing data (‘Wave 1’ through to ‘Wave 4’) and combine the worksheets into a single dataset.</li>
</ul>
<ul class="text-sub-question tighten-10">
  <li>Use the PDF you have downloaded to create a label and a short description (attribute) for each variable using the <code class="language-r highlighter-rouge"><span class="n">attr</span></code> function. (See R walk-through 8.1 for details.) The second column of the PDF lists all variables in the dataset (alphabetically) and tells you what it measures.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-81-importing-the-data-into-r"><strong>R walk-through 8.1</strong> Importing the data into R</h3>
  <p>As we are importing an Excel file, we use the <code class="language-r highlighter-rouge"><span class="n">read_excel</span></code> function from the <code class="language-r highlighter-rouge"><span class="n">readxl</span></code> package. The file is called <code class="language-r highlighter-rouge"><span class="n">Project</span><span class="m">-8</span><span class="o">-</span><span class="n">datafile.xlsx</span></code> and contains four worksheets that contain the data, named ‘Wave 1’ through to ‘Wave 4’. We will load the worksheets one by one and add them to the previous worksheets using the <code class="language-r highlighter-rouge"><span class="n">rbind</span></code> function, which attaches objects with the same number of rows to each other. The final output is called <code class="language-r highlighter-rouge"><span class="n">lifesat_data</span></code>.</p>
  <div class="language-r print-wrap-words highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">

</span><span class="c1"># Set your working directory to the correct folder.</span><span class="w">
</span><span class="c1"># Insert your file path for 'YOURFILEPATH'.</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="s2">"YOURFILEPATH"</span><span class="p">)</span><span class="w">

</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project-8-datafile.xlsx"</span><span class="p">,</span><span class="w">
  </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wave 1"</span><span class="p">)</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w">
  </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project-8-datafile.xlsx"</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wave 2"</span><span class="p">))</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w">
  </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project-8-datafile.xlsx"</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wave 3"</span><span class="p">))</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w">
  </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project-8-datafile.xlsx"</span><span class="p">,</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Wave 4"</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <p class="tighten-15">The variable names provided in the spreadsheet are not very specific (a combination of letters and numbers that don’t tell us what the variable measures), we can assign a label (<code class="language-r highlighter-rouge"><span class="err">”</span><span class="n">labels</span><span class="err">”</span></code>) and a short description (<code class="language-r highlighter-rouge"><span class="n">shortDescription</span></code>, taken from the Variable Correspondence file) to each variable for reference later. The <code class="language-r highlighter-rouge"><span class="n">attr</span></code> function does this for us (note that the order in each list should be the same as the order of the variable names).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"labels"</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
</span><span class="nf">c</span><span class="p">(</span><span class="s2">"EVS-wave"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Country/region"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Respondent number"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Health"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Life satisfaction"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Work Q1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Work Q2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Work Q3"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Work Q4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Work Q5"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Sex"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Age"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Marital status"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Number of children"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Education"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Employment"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Monthly household income"</span><span class="p">)</span><span class="w">

</span><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"shortDescription"</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
</span><span class="nf">c</span><span class="p">(</span><span class="s2">"EVS-wave"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Country/region"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Original respondent number"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"State of health (subjective)"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Satisfaction with your life"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"To develop talents you need to have a job"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Humiliating to receive money w/o working for it"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"People who don't work become lazy"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Work is a duty towards society"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Work comes first even if it means less spare time"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Sex"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Age"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Marital status"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"How many living children do you have"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Educational level (ISCED-code one digit)"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Employment status"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"Monthly household income (× 1,000s PPP euros)"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p class="keep-together">Throughout this project we will refer to the variables using their original names, but you can use the <code class="language-r highlighter-rouge"><span class="n">attr</span></code> function again to look up the attributes of each variable (the following code uses the variable <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code> to show how you can do this):</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"labels"</span><span class="p">)[</span><span class="w">
  </span><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"names"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"X028"</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "Employment"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"shortDescription"</span><span class="p">)[</span><span class="w">
  </span><span class="nf">attr</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">,</span><span class="w"> </span><span class="s2">"names"</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"X028"</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "Employment status"</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>In general, data dictionaries and variable correspondences are useful because they contain important information about what each variable represents and how it is measured, which usually cannot be summarized in a short variable name.</p>
<ol class="text-question">
  <li>Now we will take a closer look at how some of the variables were measured.</li>
</ol>
<ul class="text-sub-question loosen-10">
  <li>Variable <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code> is reported life satisfaction on a scale of 1 (dissatisfied) to 10 (satisfied). Respondents answered the question ‘All things considered, how satisfied are you with your life as a whole these days?’ Discuss the assumptions needed to use this measure in interpersonal and cross-country comparisons, and whether you think they are plausible. (You may find it helpful to refer to Box 2.1 of the <a href="https://tinyco.re/1768499" class="show-url">OECD Guidelines on Measuring Subjective Well-being</a>.)</li>
</ul>
<ul class="text-sub-question">
  <li>An individual’s employment status (variable X028) was self-reported. Explain whether misreporting of employment status is likely to be an issue, and give some factors that may affect the likelihood of misreporting in this context.</li>
</ul>
<ul class="text-sub-question loosen-15">
  <li>Variables <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code> ask about an individual’s attitudes towards work. With self-reports, we may also be concerned that individuals are using a heuristic (rule of thumb) to answer the questions. Table 2.1 of the <a href="https://tinyco.re/1768499" class="show-url">OECD Guidelines on Measuring Subjective Well-being</a> lists some response biases and heuristics that individuals could use. Pick three that you think particularly apply to questions about life satisfaction or work ethic and describe how we might check whether this issue may be present in our data.</li>
</ul>
<p class="tighten-10">Before doing any data analysis, it is important to check that all variables are coded in a way that the software can recognize. This process involves checking how missing values are coded (usually these need to be coded in a particular way for each software), and that numerical variables (numbers) only contain numbers and not text (in order to calculate summary statistics).</p>
<ol class="text-question keep-with-next">
  <li>We will now check and clean the dataset so it is ready to use.</li>
</ol>
<ul class="text-sub-question">
  <li>Inspect the data and understand what type of data each variable is stored as. Currently, missing values are recorded as ‘.a’, but we would like them to be recorded as ‘NA’ (not available).</li>
</ul>
<ul class="text-sub-question">
  <li>Variable <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code> (life satisfaction) is currently a mixture of numbers (2 to 9) and words (‘Satisfied’ and ‘Dissatisfied’), but we would like it to be all numbers. Replace the word ‘Dissatisfied’ with the number 1, and the word ‘Satisfied’ with the number 10.</li>
</ul>
<ul class="text-sub-question">
  <li>Similarly, variable <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span></code> (number of children) has recorded no children as a word rather than a number. Replace ‘No children’ with the number 0.</li>
</ul>
<ul class="text-sub-question tighten-15">
  <li>The variables <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code> should be replaced with numbers ranging from 1 (‘Strongly disagree’) to 5 (‘Strongly agree’) so we can take averages of them later. Similarly, variable <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">009</span></code> should be recoded as 1 = ‘Very Poor’, 2 = ‘Poor’, 3 = ‘Fair’, 4 = ‘Good’, 5 = ‘Very Good’.</li>
</ul>
<ul class="text-sub-question">
  <li>Split <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">025</span><span class="n">A</span></code> into two variables, one for the number before the colon, and the other containing the words after the colon.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-82-cleaning-data-and-splitting-variables"><strong>R walk-through 8.2</strong> Cleaning data and splitting variables</h3>
  <h4 class="add-1" id="inspect-the-data-and-recode-missing-values">Inspect the data and recode missing values</h4>
  <p>R stores variables as different <code class="language-r highlighter-rouge"><span class="n">types</span></code> depending on the kind of information the variable represents. For categorical data, where, as the name suggests, data is divided into a number of groups, such as country or occupation, the variables can be stored as text (<code class="language-r highlighter-rouge"><span class="n">chr</span></code>). Numerical data (numbers that do not represent categories) should be stored as numbers (<code class="language-r highlighter-rouge"><span class="n">num</span></code>), but sometimes R imports numerical values as text, which can cause problems later when we use these variables in calculations. The <code class="language-r highlighter-rouge"><span class="n">str</span></code> function shows what type each variable is being stored as.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Classes 'tbl_df', 'tbl' and 'data.frame':    164997 obs. of  17 variables:</span><span class="w">
</span><span class="c1">##  $ S002EVS: chr  "1981-1984" "1981-1984" "1981-1984" "1981-1984" ...</span><span class="w">
</span><span class="c1">##  $ S003   : chr  "Belgium" "Belgium" "Belgium" "Belgium" ...</span><span class="w">
</span><span class="c1">##  $ S006   : num  1001 1002 1003 1004 1005 ...</span><span class="w">
</span><span class="c1">##  $ A009   : chr  "Fair" "Very good" "Poor" "Very good" ...</span><span class="w">
</span><span class="c1">##  $ A170   : chr  "9" "9" "3" "9" ...</span><span class="w">
</span><span class="c1">##  $ C036   : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ C037   : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ C038   : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ C039   : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ C041   : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ X001   : chr  "Male" "Male" "Male" "Female" ...</span><span class="w">
</span><span class="c1">##  $ X003   : num  53 30 61 60 60 19 38 39 44 76 ...</span><span class="w">
</span><span class="c1">##  $ X007   : chr  "Single/Never married" "Married" "Separated" "Married" ...</span><span class="w">
</span><span class="c1">##  $ X011_01: chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ X025A  : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  $ X028   : chr  "Full time" "Full time" "Unemployed" "Housewife" ...</span><span class="w">
</span><span class="c1">##  $ X047D  : chr  ".a" ".a" ".a" ".a" ...</span><span class="w">
</span><span class="c1">##  - attr(*, "labels")= chr  "EVS-wave" "Country/region" "Respondent number" "Health" ...</span><span class="w">
</span><span class="c1">##  - attr(*, "shortDescription")= chr  "EVS-wave" "Country/region" "Original respondent number" "State of health (subjective)" ...</span><span class="w">
</span></code></pre></div>  </div>
  <p>You can see that some variables have the value <code class="language-r highlighter-rouge"><span class="err">“</span><span class="n">.a</span><span class="err">”</span></code>, which is how missing values were coded in the original dataset. We start by recoding all missing values as <code class="language-r highlighter-rouge"><span class="kc">NA</span></code> (which is how R recognizes and usually codes missing values).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="p">[</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">".a"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="recode-the-life-satisfaction-variable">Recode the life satisfaction variable</h4>
  <p>To recode the life satisfaction variable (<code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code>), we can use logical indexing (asking R to check if a certain condition is satisfied or not) to select all observations where the variable <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code> is equal to either ‘Dissatisfied’ or ‘Satisfied’ and assign the value 1 or 10 respectively. This variable was imported as a <code class="language-r highlighter-rouge"><span class="n">chr</span></code> (text) instead of <code class="language-r highlighter-rouge"><span class="n">num</span></code> variable because some of the entries included text (the <code class="language-r highlighter-rouge"><span class="n">.a</span></code> for missing values). After changing the text into numerical values, we use the <code class="language-r highlighter-rouge"><span class="n">as.numeric</span></code> function to convert the variable into a numerical type.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="p">[</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="w"> </span><span class="o">==</span><span class="w"> 
  </span><span class="s2">"Dissatisfied"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w">
</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="p">[</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="w"> </span><span class="o">==</span><span class="w"> 
  </span><span class="s2">"Satisfied"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w">
</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">A</span><span class="m">170</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="recode-the-variable-for-number-of-children">Recode the variable for number of children</h4>
  <p>We repeat this process (using logical indexing and then converting to numerical variable) for the variable indicating the number of children (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="o">$</span><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span><span class="p">[</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span><span class="w"> </span><span class="o">==</span><span class="w"> 
  </span><span class="s2">"No children"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span><span class="w">
</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">lifesat_data</span><span class="o">$</span><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="replace-text-with-numbers-for-multiple-variables">Replace text with numbers for multiple variables</h4>
  <p>When we have to recode multiple variables with the same mapping of text to numerical value (i.e. a word/phrase corresponds to the same number for all variables), we can use the <code class="language-r highlighter-rouge"><span class="n">tidyverse</span></code> library and the piping (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>) operator to run the same sequence of steps in one go for all variables, instead of repeating the process used above for each variable. The punctuation <code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code> links the commands together. (At this stage, don’t worry if you can’t understand exactly what this code does, as long as you can adapt it for similar situations. For a more detailed introduction to piping, see the <a href="https://tinyco.re/5531433" class="show-url">University of Manchester’s Econometric Computing Learning Resource</a>.)</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"C036"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C037"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C038"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C039"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C041"</span><span class="p">),</span><span class="w">
    </span><span class="n">funs</span><span class="p">(</span><span class="n">recode</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"Strongly disagree"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"Disagree"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"Neither agree nor disagree"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Agree"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"Strongly agree"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"5"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">),</span><span class="w"> </span><span class="n">funs</span><span class="p">(</span><span class="n">recode</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"Very poor"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Poor"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Fair"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Good"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Very good"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"5"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C036"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C037"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"C038"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C039"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C041"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X047D"</span><span class="p">),</span><span class="w"> </span><span class="n">funs</span><span class="p">(</span><span class="n">as.numeric</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="split-a-variable-containing-numbers-and-text">Split a variable containing numbers and text</h4>
  <p>To split the education variable (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">025</span><span class="n">A</span></code>) into two new columns, we use the <code class="language-r highlighter-rouge"><span class="n">separate</span></code> function, which creates two new variables called <code class="language-r highlighter-rouge"><span class="n">Education_1</span></code> and <code class="language-r highlighter-rouge"><span class="n">Education_2</span></code> containing the numeric value and the text description respectively. Then we use the <code class="language-r highlighter-rouge"><span class="n">mutate_at</span></code> function to convert <code class="language-r highlighter-rouge"><span class="n">Education_1</span></code> into a numeric variable.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">separate</span><span class="p">(</span><span class="n">X</span><span class="m">025</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Education_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Education_2"</span><span class="p">),</span><span class="w">
    </span><span class="s2">" : "</span><span class="p">,</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="s2">"Education_1"</span><span class="p">,</span><span class="w"> </span><span class="n">funs</span><span class="p">(</span><span class="n">as.numeric</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>Although the paper we are following only considered individuals aged 25–80 who were not students, we will retain the other observations in our analysis. However, we need to remove any observations that have missing values for <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code>, <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>, or any of the other variables except <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">047</span><span class="n">D</span></code>. Removing missing data ensures that any summary statistics or analysis we do is done on the same set of data (without having to always account for the fact that some values are missing), and is fine as long as the data are missing at random (i.e. there is no particular reason why certain observations are missing and not others).</p>
<ol class="text-question">
  <li>
    <p>In your dataset, remove all rows in all waves that have missing data for A170. Do the same for:</p>
    <ul>
      <li>X003, X028, X007 and X001 in all waves</li>
      <li>A009 in Waves 1, 2, and 4 only</li>
      <li>C036, C037, C038, C039, C041 and X047D in Waves 3 and 4 only</li>
      <li>X011_01 and X025A, in Wave 4.</li>
    </ul>
    <p>R walk-through 8.3 gives guidance on how to do this.</p>
  </li>
</ol>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-83-dropping-specific-observations"><strong>R walk-through 8.3</strong> Dropping specific observations</h3>
  <p>As not all questions were asked in all waves, we have to be careful when dropping observations with missing values for certain questions, to avoid accidentally dropping an entire wave of data. For example, information on self-reported health (<code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">009</span></code>) was not recorded in Wave 3, and questions on work attitudes (<code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code>) and information on household income are only asked in Waves 3 and 4. Furthermore, information on the number of children (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span></code>) and education (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">025</span><span class="n">A</span></code>) are only collected in the final wave.</p>
  <p class="print-wrap-words">We will first use the <code class="language-r highlighter-rouge"><span class="n">complete.cases</span></code> function to keep observations with complete information on variables present in all waves (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">003</span></code>, <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code>, <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>, <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">007</span></code>, and <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">001</span></code>—stored in the list <code class="language-r highlighter-rouge"><span class="n">include</span></code>). This function tells us which rows in the dataframe have complete information. When used in the code <code class="language-r highlighter-rouge"><span class="n">lifesat_data</span><span class="p">[</span><span class="n">complete.cases</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> </span><span class="n">include</span><span class="p">]),</span><span class="w"> </span><span class="p">]</span></code>, it tells R to only keep the rows that contain complete information of the variables in the list <code class="language-r highlighter-rouge"><span class="n">include</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">include</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
  </span><span class="s2">"X003"</span><span class="p">,</span><span class="w"> </span><span class="s2">"A170"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X028"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X007"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X001"</span><span class="p">)</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="p">[</span><span class="w">
  </span><span class="n">complete.cases</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> </span><span class="n">include</span><span class="p">]),</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>
  <p>Next we will look at variables that were only present in some waves. For each variable/group of variables, we have to only look at the particular wave(s) in which the question was asked, then keep the observations with complete information on those variables. As before, we make lists of variables that only feature in Waves 1, 2, and 4 (<code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">009</span></code>—stored in <code class="language-r highlighter-rouge"><span class="n">include_wave_1_2_4</span></code>), Waves 3 and 4 (<code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code>, <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">047</span><span class="n">D</span></code>—stored in <code class="language-r highlighter-rouge"><span class="n">include_wave_3_4</span></code>), and Wave 4 only (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span></code> and <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">025</span><span class="n">A</span></code>—stored in <code class="language-r highlighter-rouge"><span class="n">include_wave_4</span></code>). Again we use the <code class="language-r highlighter-rouge"><span class="n">complete.cases</span></code> function, but combine it with the logical OR operator <code class="language-r highlighter-rouge"><span class="o">|</span></code> to include all observations for waves that did not ask that question, along with the complete cases for that question in the other waves. For example, the first command keeps an observations if it is in Wave 1 (1981-1984) or Wave 2 (1990-1993), or is in Waves 3 or 4 with complete information.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># A009 is not in Wave 3.</span><span class="w">
</span><span class="n">include_wave_1_2_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">)</span><span class="w">

</span><span class="n">include_wave_3_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> 
</span><span class="c1"># Work attitudes and income are in Waves 3 and 4.</span><span class="w">
</span><span class="nf">c</span><span class="p">(</span><span class="s2">"C036"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C037"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C038"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C039"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C041"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X047D"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Number of children and education are in Wave 4.</span><span class="w">
</span><span class="n">include_wave_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> 
</span><span class="nf">c</span><span class="p">(</span><span class="s2">"X011_01"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X025A"</span><span class="p">)</span><span class="w">

</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"1981-1984"</span><span class="w"> </span><span class="o">|</span><span class="w"> 
    </span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"1990-1993"</span><span class="w"> </span><span class="o">|</span><span class="w"> 
    </span><span class="n">complete.cases</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> </span><span class="n">include_wave_3_4</span><span class="p">]))</span><span class="w"> 

</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="w"> </span><span class="o">|</span><span class="w">  
    </span><span class="n">complete.cases</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> </span><span class="n">include_wave_4</span><span class="p">]))</span><span class="w">

</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"1999-2001"</span><span class="w"> </span><span class="o">|</span><span class="w">  
    </span><span class="n">complete.cases</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> </span><span class="n">include_wave_1_2_4</span><span class="p">]))</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<ol class="text-question">
  <li>We will now create two variables, work ethic and relative income, which we will use in our comparison of life satisfaction.</li>
</ol>
<ul class="text-sub-question">
  <li>Work ethic is measured as the average of <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code>. Create a new variable showing this work ethic measure.</li>
</ul>
<ul class="text-sub-question">
  <li>Since unemployed individuals and students may not have income, the study calculated relative income as the relative household income of that individual, measured as a deviation from the average income in that individual’s country. Explain the issues with using this method if the income distribution is skewed (for example, if it has a long right tail).</li>
</ul>
<ul class="text-sub-question tighten-15">
  <li>Instead of using average income, we will define relative income as the percentile of that individual’s household in the income distribution. Create a new variable showing this information. (See R walk-through 8.4 for one way to do this).</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-84-calculating-averages-and-percentiles"><strong>R walk-through 8.4</strong> Calculating averages and percentiles</h3>
  <h4 class="add-1" id="calculate-average-work-ethic-score">Calculate average work ethic score</h4>
  <p>We use the <code class="language-r highlighter-rouge"><span class="n">rowMeans</span></code> function to calculate the average work ethic score for each observation (<code class="language-r highlighter-rouge"><span class="n">workethic</span></code>) based on the five survey questions related to working attitudes (<code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">036</span></code> to <code class="language-r highlighter-rouge"><span class="n">C</span><span class="m">041</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="o">$</span><span class="n">work_ethic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rowMeans</span><span class="p">(</span><span class="n">lifesat_data</span><span class="p">[,</span><span class="w"> 
  </span><span class="nf">c</span><span class="p">(</span><span class="s2">"C036"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C037"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C038"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C039"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C041"</span><span class="p">)])</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="calculate-income-percentiles-for-each-individual">Calculate income percentiles for each individual</h4>
  <p>R provides a handy function (<code class="language-r highlighter-rouge"><span class="n">ecdf</span></code>) to obtain an individual’s relative income as a percentile. As we want a separate income distribution for each wave, we use the <code class="language-r highlighter-rouge"><span class="n">group_by</span></code> function. Finally, we tidy up the results by converting each value into a percentage and rounding to a single decimal place.</p>
  <p>The <code class="language-r highlighter-rouge"><span class="n">ecdf</span></code> function will not work if there is missing data. Since we don’t have income data for Waves 1 and 2, we will have to split the data when working out the percentiles. First we store all observations from Waves 3 and 4 separately in a temporary dataset (<code class="language-r highlighter-rouge"><span class="n">df.new</span></code>), only keep observations that have income values (<code class="language-r highlighter-rouge"><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">X</span><span class="m">047</span><span class="n">D</span><span class="p">)</span></code>), calculate the percentile values with the <code class="language-r highlighter-rouge"><span class="n">ecdf</span></code> function, and save the values in a variable called <code class="language-r highlighter-rouge"><span class="n">percentile</span></code> (which will be ‘NA’ for Waves 1 and 2). Then we recombine this data with the original observations from Waves 1 and 2.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create the percentile variable for Waves 3 and 4</span><span class="w">
</span><span class="n">df.new</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Waves 3 and 4</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"1999-2001"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Drop observations with missing income data</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">X</span><span class="m">047</span><span class="n">D</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate the percentiles per wave</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate relative income as a percentile</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">percentile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ecdf</span><span class="p">(</span><span class="n">X</span><span class="m">047</span><span class="n">D</span><span class="p">)(</span><span class="n">X</span><span class="m">047</span><span class="n">D</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Express the variable as a percentage</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">percentile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">percentile</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">

</span><span class="c1"># Recombine Waves 3 and 4 with the Waves 1 and 2</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Waves 1 and 2</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"1981-1984"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1990-1993"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Create an empty variable so old and new dataframes are </span><span class="w">
  </span><span class="c1"># same size</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">percentile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Recombine the data</span><span class="w">
  </span><span class="n">bind_rows</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">df.new</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<ol class="text-question">
  <li>Now we have all the variables we need in the format we need. We will make some tables to summarize the data. Using the data for Wave 4:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table showing the breakdown of each country’s population according to employment status, with country (<code class="language-r highlighter-rouge"><span class="n">S</span><span class="m">003</span></code>) as the row variable, and employment status (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>) as the column variable. Express the values as percentages of the row total rather than as frequencies. Discuss any differences or similarities between countries that you find interesting.</li>
</ul>
<ul class="text-sub-question loosen-10">
  <li>Create a new table as shown in Figure 8.1 (similar to Table 1 in the study <a href="https://tinyco.re/1482788" class="show-url">‘Employment status and subjective well-being’</a>) and fill in the missing values. Life satisfaction is measured by <code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code>. Summary tables such as these give a useful overview of what each variable looks like.</li>
</ul>
<div class="figure fixed figure-no-source" id="figure-8-1">
<div class="figure-body">
<div class="figure-html">
<table>
  <tr>
    <th></th>
    <th colspan="2">Male</th>
    <th colspan="2">Female</th>
  </tr>
  <tr>
    <td></td>
    <td>Mean</td>
    <td>Standard deviation</td>
    <td>Mean</td>
    <td>Standard deviation</td>
  </tr>
  <tr>
    <td>Life satisfaction</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Self-reported health</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Work ethic</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Age</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Education</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Number of children</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
</table>
</div>
<p class="description">
Summary statistics by gender, European Values Study.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.1 </span>
Summary statistics by gender, European Values Study.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
<p><span> </span></p>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-85-calculating-summary-statistics"><strong>R walk-through 8.5</strong> Calculating summary statistics</h3>
  <h4 class="add-1" id="create-a-table-showing-employment-status-by-country">Create a table showing employment status, by country</h4>
  <p>One of the most useful R functions to obtain summary information is <code class="language-r highlighter-rouge"><span class="n">summarize</span></code>, which produces many different summary statistics for a set of data. First we select the data for Wave 4 and group it by country (<code class="language-r highlighter-rouge"><span class="n">S</span><span class="m">003</span></code>) and employment type (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>). Then we use the <code class="language-r highlighter-rouge"><span class="n">summarize</span></code> function to obtain the number of observations for each combination of country and employment type. With the data effectively grouped by country only (a single observation contains the number of observations for each level (category) of <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>), we can use the <code class="language-r highlighter-rouge"><span class="n">sum</span></code> function to obtain a total count (number of observations) per country and calculate relative frequencies (saved as <code class="language-r highlighter-rouge"><span class="n">freq</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Wave 4 only</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group by country and employment</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="m">028</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Count the number of observations by group</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate the relative frequency (percentages)</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Drop the count variable</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Reshape the data into a neat table</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">kable</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"markdown"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r print-wrap-words highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">|</span><span class="n">S</span><span class="m">003</span><span class="w">               </span><span class="o">|</span><span class="w"> </span><span class="n">Full</span><span class="w"> </span><span class="n">time</span><span class="o">|</span><span class="w"> </span><span class="n">Housewife</span><span class="o">|</span><span class="w"> </span><span class="n">Other</span><span class="o">|</span><span class="w"> </span><span class="n">Part</span><span class="w"> </span><span class="n">time</span><span class="o">|</span><span class="w"> </span><span class="n">Retired</span><span class="o">|</span><span class="w"> </span><span class="n">Self</span><span class="w"> </span><span class="n">employed</span><span class="o">|</span><span class="w"> </span><span class="n">Students</span><span class="o">|</span><span class="w"> </span><span class="n">Unemployed</span><span class="o">|</span><span class="w">
</span><span class="o">|:------------------|---------:|---------:|-----:|---------:|-------:|-------------:|--------:|----------:|</span><span class="w">
</span><span class="o">|</span><span class="n">Albania</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">29.42</span><span class="o">|</span><span class="w">      </span><span class="m">7.42</span><span class="o">|</span><span class="w">  </span><span class="m">1.50</span><span class="o">|</span><span class="w">      </span><span class="m">5.50</span><span class="o">|</span><span class="w">    </span><span class="m">9.08</span><span class="o">|</span><span class="w">         </span><span class="m">22.08</span><span class="o">|</span><span class="w">     </span><span class="m">7.33</span><span class="o">|</span><span class="w">      </span><span class="m">17.67</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Armenia</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">23.86</span><span class="o">|</span><span class="w">     </span><span class="m">20.92</span><span class="o">|</span><span class="w">  </span><span class="m">1.14</span><span class="o">|</span><span class="w">      </span><span class="m">8.09</span><span class="o">|</span><span class="w">   </span><span class="m">18.38</span><span class="o">|</span><span class="w">          </span><span class="m">5.96</span><span class="o">|</span><span class="w">     </span><span class="m">6.70</span><span class="o">|</span><span class="w">      </span><span class="m">14.95</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Austria</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">39.80</span><span class="o">|</span><span class="w">      </span><span class="m">7.24</span><span class="o">|</span><span class="w">  </span><span class="m">1.89</span><span class="o">|</span><span class="w">      </span><span class="m">9.95</span><span class="o">|</span><span class="w">   </span><span class="m">25.49</span><span class="o">|</span><span class="w">          </span><span class="m">5.02</span><span class="o">|</span><span class="w">     </span><span class="m">8.39</span><span class="o">|</span><span class="w">       </span><span class="m">2.22</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Belarus</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">57.88</span><span class="o">|</span><span class="w">      </span><span class="m">2.43</span><span class="o">|</span><span class="w">  </span><span class="m">1.21</span><span class="o">|</span><span class="w">      </span><span class="m">6.95</span><span class="o">|</span><span class="w">   </span><span class="m">18.59</span><span class="o">|</span><span class="w">          </span><span class="m">3.40</span><span class="o">|</span><span class="w">     </span><span class="m">6.87</span><span class="o">|</span><span class="w">       </span><span class="m">2.67</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Belgium</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">42.89</span><span class="o">|</span><span class="w">      </span><span class="m">5.96</span><span class="o">|</span><span class="w">  </span><span class="m">3.72</span><span class="o">|</span><span class="w">      </span><span class="m">8.94</span><span class="o">|</span><span class="w">   </span><span class="m">23.01</span><span class="o">|</span><span class="w">          </span><span class="m">3.57</span><span class="o">|</span><span class="w">     </span><span class="m">5.21</span><span class="o">|</span><span class="w">       </span><span class="m">6.70</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Bosnia</span><span class="w"> </span><span class="n">Herzegovina</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="m">34.06</span><span class="o">|</span><span class="w">      </span><span class="m">9.33</span><span class="o">|</span><span class="w">  </span><span class="m">0.82</span><span class="o">|</span><span class="w">      </span><span class="m">2.90</span><span class="o">|</span><span class="w">   </span><span class="m">14.67</span><span class="o">|</span><span class="w">          </span><span class="m">3.08</span><span class="o">|</span><span class="w">     </span><span class="m">8.15</span><span class="o">|</span><span class="w">      </span><span class="m">26.99</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Bulgaria</span><span class="w">           </span><span class="o">|</span><span class="w">     </span><span class="m">46.32</span><span class="o">|</span><span class="w">      </span><span class="m">2.62</span><span class="o">|</span><span class="w">  </span><span class="m">0.76</span><span class="o">|</span><span class="w">      </span><span class="m">2.79</span><span class="o">|</span><span class="w">   </span><span class="m">31.28</span><span class="o">|</span><span class="w">          </span><span class="m">5.58</span><span class="o">|</span><span class="w">     </span><span class="m">2.37</span><span class="o">|</span><span class="w">       </span><span class="m">8.28</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Croatia</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">41.58</span><span class="o">|</span><span class="w">      </span><span class="m">3.37</span><span class="o">|</span><span class="w">  </span><span class="m">0.93</span><span class="o">|</span><span class="w">      </span><span class="m">2.78</span><span class="o">|</span><span class="w">   </span><span class="m">26.01</span><span class="o">|</span><span class="w">          </span><span class="m">2.86</span><span class="o">|</span><span class="w">     </span><span class="m">8.75</span><span class="o">|</span><span class="w">      </span><span class="m">13.72</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Cyprus</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">46.32</span><span class="o">|</span><span class="w">     </span><span class="m">13.68</span><span class="o">|</span><span class="w">  </span><span class="m">1.29</span><span class="o">|</span><span class="w">      </span><span class="m">2.84</span><span class="o">|</span><span class="w">   </span><span class="m">24.39</span><span class="o">|</span><span class="w">          </span><span class="m">6.58</span><span class="o">|</span><span class="w">     </span><span class="m">1.68</span><span class="o">|</span><span class="w">       </span><span class="m">3.23</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Czech</span><span class="w"> </span><span class="n">Republic</span><span class="w">     </span><span class="o">|</span><span class="w">     </span><span class="m">46.56</span><span class="o">|</span><span class="w">      </span><span class="m">3.06</span><span class="o">|</span><span class="w">  </span><span class="m">4.66</span><span class="o">|</span><span class="w">      </span><span class="m">1.68</span><span class="o">|</span><span class="w">   </span><span class="m">31.27</span><span class="o">|</span><span class="w">          </span><span class="m">3.82</span><span class="o">|</span><span class="w">     </span><span class="m">5.43</span><span class="o">|</span><span class="w">       </span><span class="m">3.52</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Denmark</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">55.89</span><span class="o">|</span><span class="w">      </span><span class="m">0.28</span><span class="o">|</span><span class="w">  </span><span class="m">1.32</span><span class="o">|</span><span class="w">      </span><span class="m">6.69</span><span class="o">|</span><span class="w">   </span><span class="m">24.32</span><span class="o">|</span><span class="w">          </span><span class="m">5.94</span><span class="o">|</span><span class="w">     </span><span class="m">4.15</span><span class="o">|</span><span class="w">       </span><span class="m">1.41</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Estonia</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">50.35</span><span class="o">|</span><span class="w">      </span><span class="m">4.08</span><span class="o">|</span><span class="w">  </span><span class="m">2.20</span><span class="o">|</span><span class="w">      </span><span class="m">5.11</span><span class="o">|</span><span class="w">   </span><span class="m">28.52</span><span class="o">|</span><span class="w">          </span><span class="m">3.61</span><span class="o">|</span><span class="w">     </span><span class="m">3.38</span><span class="o">|</span><span class="w">       </span><span class="m">2.75</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Finland</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">52.34</span><span class="o">|</span><span class="w">      </span><span class="m">1.38</span><span class="o">|</span><span class="w">  </span><span class="m">3.94</span><span class="o">|</span><span class="w">      </span><span class="m">5.11</span><span class="o">|</span><span class="w">   </span><span class="m">22.77</span><span class="o">|</span><span class="w">          </span><span class="m">6.17</span><span class="o">|</span><span class="w">     </span><span class="m">3.72</span><span class="o">|</span><span class="w">       </span><span class="m">4.57</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">France</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">46.83</span><span class="o">|</span><span class="w">      </span><span class="m">5.59</span><span class="o">|</span><span class="w">  </span><span class="m">1.94</span><span class="o">|</span><span class="w">      </span><span class="m">6.04</span><span class="o">|</span><span class="w">   </span><span class="m">28.78</span><span class="o">|</span><span class="w">          </span><span class="m">2.76</span><span class="o">|</span><span class="w">     </span><span class="m">3.13</span><span class="o">|</span><span class="w">       </span><span class="m">4.92</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Georgia</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">19.46</span><span class="o">|</span><span class="w">     </span><span class="m">11.60</span><span class="o">|</span><span class="w">  </span><span class="m">0.81</span><span class="o">|</span><span class="w">      </span><span class="m">6.57</span><span class="o">|</span><span class="w">   </span><span class="m">19.38</span><span class="o">|</span><span class="w">          </span><span class="m">7.06</span><span class="o">|</span><span class="w">     </span><span class="m">2.60</span><span class="o">|</span><span class="w">      </span><span class="m">32.52</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Germany</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">38.44</span><span class="o">|</span><span class="w">      </span><span class="m">4.58</span><span class="o">|</span><span class="w">  </span><span class="m">3.03</span><span class="o">|</span><span class="w">      </span><span class="m">8.44</span><span class="o">|</span><span class="w">   </span><span class="m">28.64</span><span class="o">|</span><span class="w">          </span><span class="m">2.97</span><span class="o">|</span><span class="w">     </span><span class="m">2.67</span><span class="o">|</span><span class="w">      </span><span class="m">11.23</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Great</span><span class="w"> </span><span class="n">Britain</span><span class="w">      </span><span class="o">|</span><span class="w">     </span><span class="m">33.50</span><span class="o">|</span><span class="w">      </span><span class="m">7.32</span><span class="o">|</span><span class="w">  </span><span class="m">4.01</span><span class="o">|</span><span class="w">     </span><span class="m">11.23</span><span class="o">|</span><span class="w">   </span><span class="m">28.99</span><span class="o">|</span><span class="w">          </span><span class="m">5.72</span><span class="o">|</span><span class="w">     </span><span class="m">1.40</span><span class="o">|</span><span class="w">       </span><span class="m">7.82</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Greece</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">28.49</span><span class="o">|</span><span class="w">     </span><span class="m">17.42</span><span class="o">|</span><span class="w">  </span><span class="m">0.40</span><span class="o">|</span><span class="w">      </span><span class="m">2.97</span><span class="o">|</span><span class="w">   </span><span class="m">26.73</span><span class="o">|</span><span class="w">         </span><span class="m">13.72</span><span class="o">|</span><span class="w">     </span><span class="m">6.18</span><span class="o">|</span><span class="w">       </span><span class="m">4.09</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Hungary</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">46.39</span><span class="o">|</span><span class="w">      </span><span class="m">1.20</span><span class="o">|</span><span class="w">  </span><span class="m">7.21</span><span class="o">|</span><span class="w">      </span><span class="m">2.00</span><span class="o">|</span><span class="w">   </span><span class="m">24.04</span><span class="o">|</span><span class="w">          </span><span class="m">3.53</span><span class="o">|</span><span class="w">     </span><span class="m">6.57</span><span class="o">|</span><span class="w">       </span><span class="m">9.05</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Iceland</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">54.50</span><span class="o">|</span><span class="w">      </span><span class="m">2.25</span><span class="o">|</span><span class="w">  </span><span class="m">6.01</span><span class="o">|</span><span class="w">      </span><span class="m">9.91</span><span class="o">|</span><span class="w">    </span><span class="m">7.06</span><span class="o">|</span><span class="w">         </span><span class="m">11.41</span><span class="o">|</span><span class="w">     </span><span class="m">4.95</span><span class="o">|</span><span class="w">       </span><span class="m">3.90</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Ireland</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">41.87</span><span class="o">|</span><span class="w">     </span><span class="m">19.84</span><span class="o">|</span><span class="w">  </span><span class="m">1.59</span><span class="o">|</span><span class="w">      </span><span class="m">9.72</span><span class="o">|</span><span class="w">   </span><span class="m">13.89</span><span class="o">|</span><span class="w">          </span><span class="m">4.96</span><span class="o">|</span><span class="w">     </span><span class="m">1.59</span><span class="o">|</span><span class="w">       </span><span class="m">6.55</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Italy</span><span class="w">              </span><span class="o">|</span><span class="w">     </span><span class="m">32.88</span><span class="o">|</span><span class="w">      </span><span class="m">8.33</span><span class="o">|</span><span class="w">  </span><span class="m">0.46</span><span class="o">|</span><span class="w">      </span><span class="m">9.13</span><span class="o">|</span><span class="w">   </span><span class="m">23.06</span><span class="o">|</span><span class="w">         </span><span class="m">13.70</span><span class="o">|</span><span class="w">     </span><span class="m">7.08</span><span class="o">|</span><span class="w">       </span><span class="m">5.37</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Kosovo</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">19.57</span><span class="o">|</span><span class="w">     </span><span class="m">11.65</span><span class="o">|</span><span class="w">  </span><span class="m">0.52</span><span class="o">|</span><span class="w">      </span><span class="m">5.23</span><span class="o">|</span><span class="w">    </span><span class="m">5.83</span><span class="o">|</span><span class="w">          </span><span class="m">9.41</span><span class="o">|</span><span class="w">    </span><span class="m">18.00</span><span class="o">|</span><span class="w">      </span><span class="m">29.80</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Latvia</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">52.05</span><span class="o">|</span><span class="w">      </span><span class="m">6.18</span><span class="o">|</span><span class="w">  </span><span class="m">2.34</span><span class="o">|</span><span class="w">      </span><span class="m">3.76</span><span class="o">|</span><span class="w">   </span><span class="m">23.22</span><span class="o">|</span><span class="w">          </span><span class="m">3.26</span><span class="o">|</span><span class="w">     </span><span class="m">4.26</span><span class="o">|</span><span class="w">       </span><span class="m">4.93</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Lithuania</span><span class="w">          </span><span class="o">|</span><span class="w">     </span><span class="m">50.13</span><span class="o">|</span><span class="w">      </span><span class="m">4.11</span><span class="o">|</span><span class="w">  </span><span class="m">2.89</span><span class="o">|</span><span class="w">      </span><span class="m">5.16</span><span class="o">|</span><span class="w">   </span><span class="m">23.97</span><span class="o">|</span><span class="w">          </span><span class="m">3.41</span><span class="o">|</span><span class="w">     </span><span class="m">6.04</span><span class="o">|</span><span class="w">       </span><span class="m">4.29</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Luxembourg</span><span class="w">         </span><span class="o">|</span><span class="w">     </span><span class="m">51.33</span><span class="o">|</span><span class="w">      </span><span class="m">9.36</span><span class="o">|</span><span class="w">  </span><span class="m">1.12</span><span class="o">|</span><span class="w">      </span><span class="m">7.38</span><span class="o">|</span><span class="w">   </span><span class="m">15.36</span><span class="o">|</span><span class="w">          </span><span class="m">3.00</span><span class="o">|</span><span class="w">     </span><span class="m">9.87</span><span class="o">|</span><span class="w">       </span><span class="m">2.58</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Macedonia</span><span class="w">          </span><span class="o">|</span><span class="w">     </span><span class="m">35.74</span><span class="o">|</span><span class="w">      </span><span class="m">4.34</span><span class="o">|</span><span class="w">  </span><span class="m">1.24</span><span class="o">|</span><span class="w">      </span><span class="m">1.71</span><span class="o">|</span><span class="w">   </span><span class="m">16.74</span><span class="o">|</span><span class="w">          </span><span class="m">3.72</span><span class="o">|</span><span class="w">     </span><span class="m">8.53</span><span class="o">|</span><span class="w">      </span><span class="m">27.98</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Malta</span><span class="w">              </span><span class="o">|</span><span class="w">     </span><span class="m">33.84</span><span class="o">|</span><span class="w">     </span><span class="m">32.33</span><span class="o">|</span><span class="w">  </span><span class="m">0.68</span><span class="o">|</span><span class="w">      </span><span class="m">3.84</span><span class="o">|</span><span class="w">   </span><span class="m">23.42</span><span class="o">|</span><span class="w">          </span><span class="m">2.33</span><span class="o">|</span><span class="w">     </span><span class="m">0.55</span><span class="o">|</span><span class="w">       </span><span class="m">3.01</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Moldova</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">30.49</span><span class="o">|</span><span class="w">      </span><span class="m">7.24</span><span class="o">|</span><span class="w">  </span><span class="m">1.87</span><span class="o">|</span><span class="w">      </span><span class="m">7.58</span><span class="o">|</span><span class="w">   </span><span class="m">25.64</span><span class="o">|</span><span class="w">          </span><span class="m">4.86</span><span class="o">|</span><span class="w">     </span><span class="m">4.43</span><span class="o">|</span><span class="w">      </span><span class="m">17.89</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Montenegro</span><span class="w">         </span><span class="o">|</span><span class="w">     </span><span class="m">39.02</span><span class="o">|</span><span class="w">      </span><span class="m">4.63</span><span class="o">|</span><span class="w">  </span><span class="m">0.60</span><span class="o">|</span><span class="w">      </span><span class="m">2.14</span><span class="o">|</span><span class="w">   </span><span class="m">16.64</span><span class="o">|</span><span class="w">          </span><span class="m">4.97</span><span class="o">|</span><span class="w">     </span><span class="m">4.80</span><span class="o">|</span><span class="w">      </span><span class="m">27.19</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Netherlands</span><span class="w">        </span><span class="o">|</span><span class="w">     </span><span class="m">32.40</span><span class="o">|</span><span class="w">      </span><span class="m">9.52</span><span class="o">|</span><span class="w">  </span><span class="m">3.68</span><span class="o">|</span><span class="w">     </span><span class="m">18.24</span><span class="o">|</span><span class="w">   </span><span class="m">27.76</span><span class="o">|</span><span class="w">          </span><span class="m">6.48</span><span class="o">|</span><span class="w">     </span><span class="m">0.80</span><span class="o">|</span><span class="w">       </span><span class="m">1.12</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Northern</span><span class="w"> </span><span class="n">Cyprus</span><span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="m">31.19</span><span class="o">|</span><span class="w">     </span><span class="m">19.55</span><span class="o">|</span><span class="w">  </span><span class="m">2.23</span><span class="o">|</span><span class="w">      </span><span class="m">5.20</span><span class="o">|</span><span class="w">    </span><span class="m">8.91</span><span class="o">|</span><span class="w">          </span><span class="m">8.91</span><span class="o">|</span><span class="w">    </span><span class="m">13.61</span><span class="o">|</span><span class="w">      </span><span class="m">10.40</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Northern</span><span class="w"> </span><span class="n">Ireland</span><span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="m">30.10</span><span class="o">|</span><span class="w">     </span><span class="m">10.36</span><span class="o">|</span><span class="w">  </span><span class="m">4.53</span><span class="o">|</span><span class="w">      </span><span class="m">8.74</span><span class="o">|</span><span class="w">   </span><span class="m">29.45</span><span class="o">|</span><span class="w">          </span><span class="m">3.56</span><span class="o">|</span><span class="w">     </span><span class="m">1.29</span><span class="o">|</span><span class="w">      </span><span class="m">11.97</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Norway</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">53.23</span><span class="o">|</span><span class="w">      </span><span class="m">2.22</span><span class="o">|</span><span class="w">  </span><span class="m">6.55</span><span class="o">|</span><span class="w">      </span><span class="m">9.48</span><span class="o">|</span><span class="w">   </span><span class="m">12.60</span><span class="o">|</span><span class="w">          </span><span class="m">8.17</span><span class="o">|</span><span class="w">     </span><span class="m">7.06</span><span class="o">|</span><span class="w">       </span><span class="m">0.71</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Poland</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">41.81</span><span class="o">|</span><span class="w">      </span><span class="m">6.00</span><span class="o">|</span><span class="w">  </span><span class="m">0.10</span><span class="o">|</span><span class="w">      </span><span class="m">3.14</span><span class="o">|</span><span class="w">   </span><span class="m">28.00</span><span class="o">|</span><span class="w">          </span><span class="m">5.81</span><span class="o">|</span><span class="w">     </span><span class="m">7.62</span><span class="o">|</span><span class="w">       </span><span class="m">7.52</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Portugal</span><span class="w">           </span><span class="o">|</span><span class="w">     </span><span class="m">46.20</span><span class="o">|</span><span class="w">      </span><span class="m">5.24</span><span class="o">|</span><span class="w">  </span><span class="m">1.57</span><span class="o">|</span><span class="w">      </span><span class="m">3.27</span><span class="o">|</span><span class="w">   </span><span class="m">33.51</span><span class="o">|</span><span class="w">          </span><span class="m">1.70</span><span class="o">|</span><span class="w">     </span><span class="m">1.05</span><span class="o">|</span><span class="w">       </span><span class="m">7.46</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Romania</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">41.07</span><span class="o">|</span><span class="w">     </span><span class="m">10.54</span><span class="o">|</span><span class="w">  </span><span class="m">1.95</span><span class="o">|</span><span class="w">      </span><span class="m">3.22</span><span class="o">|</span><span class="w">   </span><span class="m">33.95</span><span class="o">|</span><span class="w">          </span><span class="m">3.02</span><span class="o">|</span><span class="w">     </span><span class="m">3.61</span><span class="o">|</span><span class="w">       </span><span class="m">2.63</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Russian</span><span class="w"> </span><span class="n">Federation</span><span class="w"> </span><span class="o">|</span><span class="w">     </span><span class="m">54.36</span><span class="o">|</span><span class="w">      </span><span class="m">5.81</span><span class="o">|</span><span class="w">  </span><span class="m">2.72</span><span class="o">|</span><span class="w">      </span><span class="m">5.08</span><span class="o">|</span><span class="w">   </span><span class="m">23.77</span><span class="o">|</span><span class="w">          </span><span class="m">1.27</span><span class="o">|</span><span class="w">     </span><span class="m">2.72</span><span class="o">|</span><span class="w">       </span><span class="m">4.26</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Serbia</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">34.21</span><span class="o">|</span><span class="w">      </span><span class="m">5.02</span><span class="o">|</span><span class="w">  </span><span class="m">1.07</span><span class="o">|</span><span class="w">      </span><span class="m">2.38</span><span class="o">|</span><span class="w">   </span><span class="m">25.16</span><span class="o">|</span><span class="w">          </span><span class="m">6.91</span><span class="o">|</span><span class="w">     </span><span class="m">4.11</span><span class="o">|</span><span class="w">      </span><span class="m">21.13</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Slovakia</span><span class="w">           </span><span class="o">|</span><span class="w">     </span><span class="m">40.98</span><span class="o">|</span><span class="w">      </span><span class="m">1.73</span><span class="o">|</span><span class="w">  </span><span class="m">4.89</span><span class="o">|</span><span class="w">      </span><span class="m">2.21</span><span class="o">|</span><span class="w">   </span><span class="m">39.73</span><span class="o">|</span><span class="w">          </span><span class="m">3.55</span><span class="o">|</span><span class="w">     </span><span class="m">1.25</span><span class="o">|</span><span class="w">       </span><span class="m">5.66</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Slovenia</span><span class="w">           </span><span class="o">|</span><span class="w">     </span><span class="m">47.44</span><span class="o">|</span><span class="w">      </span><span class="m">2.50</span><span class="o">|</span><span class="w">  </span><span class="m">2.75</span><span class="o">|</span><span class="w">      </span><span class="m">1.25</span><span class="o">|</span><span class="w">   </span><span class="m">31.59</span><span class="o">|</span><span class="w">          </span><span class="m">4.37</span><span class="o">|</span><span class="w">     </span><span class="m">6.99</span><span class="o">|</span><span class="w">       </span><span class="m">3.12</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Spain</span><span class="w">              </span><span class="o">|</span><span class="w">     </span><span class="m">41.52</span><span class="o">|</span><span class="w">     </span><span class="m">16.30</span><span class="o">|</span><span class="w">  </span><span class="m">0.11</span><span class="o">|</span><span class="w">      </span><span class="m">4.63</span><span class="o">|</span><span class="w">   </span><span class="m">19.93</span><span class="o">|</span><span class="w">          </span><span class="m">6.28</span><span class="o">|</span><span class="w">     </span><span class="m">3.19</span><span class="o">|</span><span class="w">       </span><span class="m">8.04</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Sweden</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">54.82</span><span class="o">|</span><span class="w">      </span><span class="m">0.38</span><span class="o">|</span><span class="w">  </span><span class="m">6.60</span><span class="o">|</span><span class="w">      </span><span class="m">7.36</span><span class="o">|</span><span class="w">   </span><span class="m">15.36</span><span class="o">|</span><span class="w">          </span><span class="m">7.23</span><span class="o">|</span><span class="w">     </span><span class="m">4.06</span><span class="o">|</span><span class="w">       </span><span class="m">4.19</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Switzerland</span><span class="w">        </span><span class="o">|</span><span class="w">     </span><span class="m">48.50</span><span class="o">|</span><span class="w">      </span><span class="m">6.42</span><span class="o">|</span><span class="w">  </span><span class="m">3.21</span><span class="o">|</span><span class="w">     </span><span class="m">14.03</span><span class="o">|</span><span class="w">   </span><span class="m">21.31</span><span class="o">|</span><span class="w">          </span><span class="m">2.89</span><span class="o">|</span><span class="w">     </span><span class="m">1.39</span><span class="o">|</span><span class="w">       </span><span class="m">2.25</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Turkey</span><span class="w">             </span><span class="o">|</span><span class="w">     </span><span class="m">16.42</span><span class="o">|</span><span class="w">     </span><span class="m">42.39</span><span class="o">|</span><span class="w">  </span><span class="m">0.60</span><span class="o">|</span><span class="w">      </span><span class="m">2.14</span><span class="o">|</span><span class="w">   </span><span class="m">10.00</span><span class="o">|</span><span class="w">          </span><span class="m">7.66</span><span class="o">|</span><span class="w">     </span><span class="m">5.92</span><span class="o">|</span><span class="w">      </span><span class="m">14.88</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Ukraine</span><span class="w">            </span><span class="o">|</span><span class="w">     </span><span class="m">40.92</span><span class="o">|</span><span class="w">      </span><span class="m">6.79</span><span class="o">|</span><span class="w">  </span><span class="m">1.02</span><span class="o">|</span><span class="w">      </span><span class="m">4.84</span><span class="o">|</span><span class="w">   </span><span class="m">32.09</span><span class="o">|</span><span class="w">          </span><span class="m">4.41</span><span class="o">|</span><span class="w">     </span><span class="m">3.23</span><span class="o">|</span><span class="w">       </span><span class="m">6.71</span><span class="o">|</span><span class="w">

</span></code></pre></div>  </div>
  <h4 id="calculate-summary-statistics-by-gender">Calculate summary statistics by gender</h4>
  <p>We can also obtain summary statistics on a number of variables at the same time using the <code class="language-r highlighter-rouge"><span class="n">summarize_at</span></code> function. To obtain the mean value for each of the required variables, grouped by the gender variable (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">001</span></code>), we can use the piping operator again:</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Obtain mean value</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We only require Wave 4.</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group by gender</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">X</span><span class="m">001</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">,</span><span class="w"> </span><span class="s2">"A170"</span><span class="p">,</span><span class="w"> </span><span class="s2">"work_ethic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X003"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Education_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X011_01"</span><span class="p">),</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 2 x 7</span><span class="w">
</span><span class="c1">##   X001    A009  A170 work_ethic  X003 Education_1 X011_01</span><span class="w">
</span><span class="c1">##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span><span class="w">
</span><span class="c1">## 1 Female  3.60  6.93       3.64  47.3        3.05    1.69</span><span class="w">
</span><span class="c1">## 2 Male    3.77  7.03       3.72  46.9        3.14    1.55</span><span class="w">
</span></code></pre></div>  </div>
  <p>We can repeat the same steps to obtain the standard deviation, again grouped by gender.</p>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Obtain standard deviation</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">X</span><span class="m">001</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">,</span><span class="w"> </span><span class="s2">"A170"</span><span class="p">,</span><span class="w"> </span><span class="s2">"work_ethic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X003"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Education_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X011_01"</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 2 x 7</span><span class="w">
</span><span class="c1">##   X001    A009  A170 work_ethic  X003 Education_1 X011_01</span><span class="w">
</span><span class="c1">##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span><span class="w">
</span><span class="c1">## 1 Female 0.969  2.32      0.765  17.5        1.40    1.39</span><span class="w">
</span><span class="c1">## 2 Male   0.929  2.28      0.757  17.4        1.31    1.43</span><span class="w">
</span></code></pre></div>  </div>
  <p>We can combine these two operations into a single code block and ask <code class="language-r highlighter-rouge"><span class="n">summarize_at</span></code> to perform multiple functions on multiple variables at the same time.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Obtain mean and standard deviations</span><span class="w">
</span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">X</span><span class="m">001</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise_at</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A009"</span><span class="p">,</span><span class="w"> </span><span class="s2">"A170"</span><span class="p">,</span><span class="w"> </span><span class="s2">"work_ethic"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X003"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Education_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"X011_01"</span><span class="p">),</span><span class="w"> </span><span class="n">funs</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 2 x 13</span><span class="w">
</span><span class="c1">##   X001   A009_mean A170_mean work_ethic_mean X003_mean Education_1_mean</span><span class="w">
</span><span class="c1">##   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;           &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;</span><span class="w">
</span><span class="c1">## 1 Female      3.60      6.93            3.64      47.3             3.05</span><span class="w">
</span><span class="c1">## 2 Male        3.77      7.03            3.72      46.9             3.14</span><span class="w">
</span><span class="c1">## # ... with 7 more variables: X011_01_mean &lt;dbl&gt;, A009_sd &lt;dbl&gt;,</span><span class="w">
</span><span class="c1">## #   A170_sd &lt;dbl&gt;, work_ethic_sd &lt;dbl&gt;, X003_sd &lt;dbl&gt;,</span><span class="w">
</span><span class="c1">## #   Education_1_sd &lt;dbl&gt;, X011_01_sd &lt;dbl&gt;</span><span class="w">
</span></code></pre></div>  </div>
  <p class="tighten-12">In this example, R automatically appends the function name (in this case, <code class="language-r highlighter-rouge"><span class="err">_</span><span class="n">mean</span></code> or <code class="language-r highlighter-rouge"><span class="err">_</span><span class="n">sd</span></code>) to the end of the variables. If you need these variables in subsequent calculations, you need to reformat the data and variable names.</p>
</blockquote>
<h2 id="part-82-visualizing-the-data">Part 8.2 Visualizing the data</h2>
<blockquote class="info">
  <h3 id="note">Note</h3>
  <p>You will need to have done Questions 1–5 in Part 8.1 before doing this part.</p>
</blockquote>
<blockquote class="box fixed">
  <h3 id="learning-objectives-for-this-part-1">Learning objectives for this part</h3>
  <ul>
    <li>use column charts, line charts, and scatterplots to visualize data</li>
    <li>calculate and interpret correlation coefficients.</li>
  </ul>
</blockquote>
<p>We will now create some summary charts of the self-reported measures (work ethic and life satisfaction), starting with column charts to show the distributions of values. Along with employment status, these are the main variables of interest, so it is important to look at them carefully before doing further data analysis.</p>
<p class="loosen-10">The distribution of work ethic and life satisfaction may vary across countries but may also change over time within a country, especially since the surveys are conducted around once a decade. To compare distributions for a particular country over time, we have to use the same horizontal axis, so we will first need to make a separate frequency table for each distribution of interest (survey wave). Also, since the number of people surveyed in each wave may differ, we will use percentages instead of frequencies as the vertical axis variable.</p>
<ol class="text-question">
  <li>Use the data from Wave 3 and Wave 4 only, for three countries of your choice:</li>
</ol>
<ul class="text-sub-question">
  <li>For each of your chosen countries create a frequency table that contains the frequency of each unique value of the work ethic scores. Also include the percentage of individuals at each value, grouped by Wave 3 and Wave 4 separately.</li>
</ul>
<ul class="text-sub-question">
  <li>Plot a separate column chart for each country to show the distribution of work ethic scores in Wave 3, with the percentage of individuals on the vertical axis and the range of work ethic scores on the horizontal axis. On each chart, plot the distribution of scores in Wave 4 on top of the Wave 3 distribution.</li>
</ul>
<ul class="text-sub-question">
  <li>Based on your charts from 1<em>(b)</em>, does it appear that the attitudes towards work in each country of your choice have changed over time? (<em>Hint:</em> For example, look at where the distribution is centred, the percentages of observations on the left tail or the right tail of the distribution, and how spread out the data is.)</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-86-calculating-frequencies-and-percentages"><strong>R walk-through 8.6</strong> Calculating frequencies and percentages</h3>
  <p class="tighten-15">First we need to create a frequency table of the <code class="language-r highlighter-rouge"><span class="n">work_ethic</span></code> variable for each wave. This variable only takes values from 1.0 to 5.0 in increments of 0.2 (since it is an average of five whole numbers), so we can group by each value and count the number of observations in each group using the <code class="language-r highlighter-rouge"><span class="n">summarize</span></code> function. Once we have counted the number of observations that have each value (separately for each wave), we compute the percentages by dividing these numbers by the total number of observations for that wave. For example, if there are 50 observations between 1 and 1.2, and 1,000 observations in that wave, the percentage would be 5%.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">waves</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"1999-2001"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w">
</span><span class="n">df.new</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="c1"># Select Waves 3 and 4</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">waves</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We use Germany in this example.</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Germany"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group by each wave and the discrete values of </span><span class="w">
  </span><span class="c1"># work_ethic</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">,</span><span class="w"> </span><span class="n">work_ethic</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="w"> </span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">))</span><span class="o">*</span><span class="m">100</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p class="tighten-15">The frequencies and percentages are saved in a new dataframe called <code class="language-r highlighter-rouge"><span class="n">df.new</span></code>. If you want to look at it, type <code class="language-r highlighter-rouge"><span class="n">view</span><span class="p">(</span><span class="n">df.new</span><span class="p">)</span></code> into the console window. Now that we have the percentages and frequency data, we use <code class="language-r highlighter-rouge"><span class="n">ggplot</span></code> to plot a column chart. To overlay the column charts for both waves and make sure that the plot for each wave is visible, we use the <code class="language-r highlighter-rouge"><span class="n">alpha</span></code> option in the <code class="language-r highlighter-rouge"><span class="n">geom_bar</span></code> function to set the transparency level (try changing the transparency to see how it affects your chart’s appearance).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df.new</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">work_ethic</span><span class="p">,</span><span class="w"> </span><span class="n">percentage</span><span class="p">,</span><span class="w"> 
  </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">    
  </span><span class="c1"># Set the colour and fill of each wave </span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> 
    </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Distribution of work ethic for Germany"</span><span class="p">))</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-8-2">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-08-02.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-02.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-02.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Distribution of work ethic scores for Germany.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-02.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-02-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-02.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Distribution of work ethic scores for Germany.
" class="" />
        </a>
</div>
<p class="description">
Distribution of work ethic scores for Germany.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.2 </span>
Distribution of work ethic scores for Germany.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
</blockquote>
<ol class="text-question">
  <li>We will use line charts to make a similar comparison for life satisfaction (<code class="language-r highlighter-rouge"><span class="n">A</span><span class="m">170</span></code>) over time. Using data for countries that are present in Waves 1 to 4:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table showing the average life satisfaction, by wave (column variable) and by country (row variable).</li>
</ul>
<ul class="text-sub-question">
  <li>Plot a line chart with wave number (1 to 4) on the horizontal axis and the average life satisfaction on the vertical axis.</li>
</ul>
<ul class="text-sub-question">
  <li>From your results in 2<em>(a)</em> and <em>(b)</em>, how has the distribution of life satisfaction changed over time? What other information about the distribution of life satisfaction could we use to supplement these results?</li>
</ul>
<ul class="text-sub-question">
  <li>Choose one or two countries and research events that could explain the observed changes in average life satisfaction over time shown in 2<em>(a)</em> and <em>(b)</em>.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-87-plotting-multiple-lines-on-a-chart"><strong>R walk-through 8.7</strong> Plotting multiple lines on a chart</h3>
  <h4 class="add-1" id="calculate-average-life-satisfaction-by-wave-and-country">Calculate average life satisfaction, by wave and country</h4>
  <p>Before we can plot the line charts, we have to calculate the average life satisfaction for each country in each wave.</p>
  <p>In <a href="#r-walk-through-85-calculating-summary-statistics" class="show-page-number">R walk-through 8.5</a> we produced summary tables, grouped by country and employment status. We will copy this process, but now we only require mean values. Countries that do not report the life satisfaction variable for all waves will have an average life satisfaction of ‘NA’. Since each country is represented by a row in the summary table, we use the <code class="language-r highlighter-rouge"><span class="n">rowwise</span></code> and <code class="language-r highlighter-rouge"><span class="n">na.omit</span></code> functions to drop any countries that do not have a value for the average life satisfaction for all four waves.</p>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.new</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate average life satisfaction per wave and country</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">avg_lifesat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="m">170</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Reshape the data to one row per country</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="p">,</span><span class="w"> </span><span class="n">avg_lifesat</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Set subsequent operations to be performed on each row</span><span class="w">
  </span><span class="n">rowwise</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Drop any rows with missing observations</span><span class="w">
  </span><span class="n">na.omit</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 11 x 5</span><span class="w">
</span><span class="c1">##    S003             `1981-1984` `1990-1993` `1999-2001` `2008-2010`</span><span class="w">
</span><span class="c1">##    &lt;chr&gt;                  &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span><span class="w">
</span><span class="c1">##  1 Belgium                 7.37        7.6         7.42        7.63</span><span class="w">
</span><span class="c1">##  2 Denmark                 8.21        8.17        8.31        8.41</span><span class="w">
</span><span class="c1">##  3 France                  6.71        6.77        6.98        7.05</span><span class="w">
</span><span class="c1">##  4 Germany                 7.22        7.03        7.43        6.77</span><span class="w">
</span><span class="c1">##  5 Iceland                 8.05        8.01        8.08        8.07</span><span class="w">
</span><span class="c1">##  6 Ireland                 7.82        7.88        8.21        7.82</span><span class="w">
</span><span class="c1">##  7 Italy                   6.65        7.3         7.18        7.4 </span><span class="w">
</span><span class="c1">##  8 Netherlands             7.75        7.77        7.83        7.99</span><span class="w">
</span><span class="c1">##  9 Northern Ireland        7.66        7.88        8.07        7.82</span><span class="w">
</span><span class="c1">## 10 Spain                   6.6         7.15        6.97        7.29</span><span class="w">
</span><span class="c1">## 11 Sweden                  8.03        7.99        7.62        7.68</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="create-a-line-chart-for-average-life-satisfaction">Create a line chart for average life satisfaction</h4>
  <p>To draw the lines for all countries on a single plot, we need to use the <code class="language-r highlighter-rouge"><span class="n">gather</span></code> function to transform the data into the correct format to use in <code class="language-r highlighter-rouge"><span class="n">ggplot</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.new</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">Wave</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">`1981-1984`</span><span class="o">:</span><span class="n">`2008-2010`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group the data by country </span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Wave</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="p">),</span><span class="w"> 
      </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-8-3">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-08-03.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-03.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-03.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Line chart of average life satisfaction across countries and survey waves.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-03.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-03-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-03.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Line chart of average life satisfaction across countries and survey waves.
" class="" />
        </a>
</div>
<p class="description">
Line chart of average life satisfaction across countries and survey waves.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.3 </span>
Line chart of average life satisfaction across countries and survey waves.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
</blockquote>
<dl class="definition">
<dt class="definition-term">correlation coefficient</dt><dd class="definition-description">A numerical measure, ranging between 1 and −1, of how closely associated two variables are—whether they tend to rise and fall together, or move in opposite directions. A positive coefficient indicates that when one variable takes a high (low) value, the other tends to be high (low) too, and a negative coefficient indicates that when one variable is high the other is likely to be low. A value of 1 or −1 indicates that knowing the value of one of the variables would allow you to perfectly predict the value of the other. A value of 0 indicates that knowing one of the variables provides no information about the value of the other.</dd>
</dl>
<p class="loosen-10">After describing patterns in our main variables over time, we will use <strong data-term="correlation coefficient">correlation coefficients</strong> and scatter plots to look at the relationship between these variables and the other variables in our dataset.</p>
<ol class="text-question">
  <li>Using the Wave 4 data:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table as shown in Figure 8.4 and calculate the required correlation coefficients. For employment status and gender, you will need to create new variables: full-time employment should be equal to 1 if full-time employed and 0 if unemployed, and treated as missing data (left as a blank cell) otherwise. Gender should be 0 if male and 1 if female.</li>
</ul>
<div class="figure fixed figure-no-source" id="figure-8-4">
<div class="figure-body">
<div class="figure-html">
<table class="data-align-right">
  <tr>
    <th>Variable</th>
    <th>Life satisfaction</th>
    <th>Work ethic</th>
  </tr>
  <tr>
    <td>Age</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Education</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Full-time employment</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Gender</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Self-reported health</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Income</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Number of children</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Relative income</td>
    <td></td>
    <td></td>
  </tr>
  <tr>
    <td>Life satisfaction</td>
    <td>1</td>
    <td></td>
  </tr>
  <tr>
    <td>Work ethic</td>
    <td></td>
    <td>1</td>
  </tr>
</table>
</div>
<p class="description">
Correlation between life satisfaction, work ethic and other variables, Wave 4.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.4 </span>
Correlation between life satisfaction, work ethic and other variables, Wave 4.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
<ul class="text-sub-question">
  <li>Interpret the coefficients, paying close attention to how the variables are coded. (For example, you could comment on the absolute magnitude and sign of the coefficients). Explain whether the relationships implied by the coefficients are what you expected (for example, would you expect life satisfaction to increase or decrease with health, income, etc.)</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-88-creating-dummy-variables-and-calculating-correlation-coefficients"><strong>R walk-through 8.8</strong> Creating dummy variables and calculating correlation coefficients</h3>
  <p class="loosen-15">To obtain the correlation coefficients between variables, we have to make sure that all variables are numeric. However, the data on sex and employment status are coded using text, so we need to create two new variables (<code class="language-r highlighter-rouge"><span class="n">gender</span></code> and <code class="language-r highlighter-rouge"><span class="n">employment</span></code>). (We choose to create a new variable rather than overwrite the original variable so that even if we make a mistake, the raw data is still preserved). We can use the <code class="language-r highlighter-rouge"><span class="n">ifelse</span></code> function to make the value of the variable conditional on whether a logical statement (e.g. <code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">001</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Male"</span></code>) is satisfied or not. As shown below, we can nest <code class="language-r highlighter-rouge"><span class="n">ifelse</span></code> statements to create more complex conditions, which is useful if the variable contains more than two values. We used two <code class="language-r highlighter-rouge"><span class="n">ifelse</span></code> statements for the unemployment variable (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>) so that the new variable will be 1 for full-time employed, 0 for unemployed, and NA if neither condition is satisfied.</p>
  <p>Although we had previously removed observations with missing values (‘NA’), we have reintroduced ‘NA’ values in the previous step when creating the <code class="language-r highlighter-rouge"><span class="n">employment</span></code> variable. This would cause problems when obtaining the correlation coefficients using the <code class="language-r highlighter-rouge"><span class="n">cor</span></code> function, so we include the option <code class="language-r highlighter-rouge"><span class="n">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pairwise.complete.obs"</span></code> to exclude observations containing ‘NA’ from the calculations.</p>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We only require Wave 4.</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Create a gender variable</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">gender</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="w">
    </span><span class="n">ifelse</span><span class="p">(</span><span class="n">X</span><span class="m">001</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Male"</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Provide nested condition for employment</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">employment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="w">
    </span><span class="n">ifelse</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Full time"</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
      </span><span class="n">ifelse</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Unemployed"</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="kc">NA</span><span class="p">))))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">X</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">Education_1</span><span class="p">,</span><span class="w"> </span><span class="n">employment</span><span class="p">,</span><span class="w">
    </span><span class="n">gender</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="m">009</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="m">047</span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="m">011</span><span class="err">_</span><span class="m">01</span><span class="p">,</span><span class="w">
    </span><span class="n">percentile</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="m">170</span><span class="p">,</span><span class="w"> </span><span class="n">work_ethic</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Store output in matrix       </span><span class="w">
  </span><span class="n">cor</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pairwise.complete.obs"</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w">

</span><span class="c1"># Only interested in two columns, so use matrix indexing</span><span class="w">
</span><span class="n">M</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"A170"</span><span class="p">,</span><span class="w"> </span><span class="s2">"work_ethic"</span><span class="p">)]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                    A170  work_ethic</span><span class="w">
</span><span class="c1">## X003        -0.08220504  0.13333312</span><span class="w">
</span><span class="c1">## Education_1  0.09363900 -0.14535643</span><span class="w">
</span><span class="c1">## employment   0.18387286 -0.02710835</span><span class="w">
</span><span class="c1">## gender      -0.02105535 -0.04781557</span><span class="w">
</span><span class="c1">## A009         0.37560287 -0.07320865</span><span class="w">
</span><span class="c1">## X047D        0.23542497 -0.15226999</span><span class="w">
</span><span class="c1">## X011_01     -0.01729372  0.08925452</span><span class="w">
</span><span class="c1">## percentile   0.29592968 -0.18679869</span><span class="w">
</span><span class="c1">## A170         1.00000000 -0.03352464</span><span class="w">
</span><span class="c1">## work_ethic  -0.03352464  1.00000000</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>Next we will look at the relationship between employment status and life satisfaction, and investigate the paper’s hypothesis that this relationship varies with a country’s average work ethic.</p>
<ol class="text-question">
  <li>Using the data from Wave 4, carry out the following:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table showing the average life satisfaction according to employment status (showing the full-time employed, retired, and unemployed categories only) with country (<code class="language-r highlighter-rouge"><span class="n">S</span><span class="m">003</span></code>) as the row variable, and employment status (<code class="language-r highlighter-rouge"><span class="n">X</span><span class="m">028</span></code>) as the column variable. Comment on any differences in average life satisfaction between these three groups, and whether social norms is a plausible explanation for these differences.</li>
</ul>
<ul class="text-sub-question">
  <li>Use the table from Question 4<em>(a)</em> to calculate the difference in average life satisfaction (full-time employed minus unemployed, and full-time employed minus retired).</li>
</ul>
<ul class="text-sub-question">
  <li>Make a separate scatterplot for each of these differences in life satisfaction, with average work ethic on the horizontal axis and difference in life satisfaction on the vertical axis.</li>
</ul>
<ul class="text-sub-question">
  <li>For each difference (employed vs unemployed, employed vs retired), calculate and interpret the correlation coefficient between average work ethic and difference in life satisfaction.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-89-calculating-group-means"><strong>R walk-through 8.9</strong> Calculating group means</h3>
  <h4 class="add-1" id="calculate-average-life-satisfaction-and-differences-in-average-life-satisfaction">Calculate average life satisfaction and differences in average life satisfaction</h4>
  <p>We can achieve the tasks in Question 4<em>(a)</em> and <em>(b)</em> in one go using an approach similar to that used in <a href="#r-walk-through-85-calculating-summary-statistics" class="show-page-number">R walk-through 8.5</a>, although now we are interested in calculating the average life satisfaction by country and employment type. Once we have tabulated these means, we can compute the difference in the average values. We will create two new variables: <code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">1</span></code> for the difference between the average life satisfaction for full-time employed and unemployed, and <code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">2</span></code> for the difference in average life satisfaction for full-time employed and retired individuals.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Set the employment types that we want to report</span><span class="w">
</span><span class="n">employment_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Full time"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Retired"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Unemployed"</span><span class="p">)</span><span class="w">
</span><span class="n">df.employment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Wave 4</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select only observations with these employment types</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">employment_list</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group by country and then employment type</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="m">028</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate the mean by country/employment type group</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="m">170</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Reshape to one row per country</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Create the difference in means</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">D</span><span class="m">1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`Full time`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Unemployed</span><span class="p">,</span><span class="w"> 
    </span><span class="n">D</span><span class="m">2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`Full time`</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Retired</span><span class="p">)</span><span class="w">

</span><span class="n">kable</span><span class="p">(</span><span class="n">df.employment</span><span class="p">,</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"markdown"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r print-wrap-words highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">|</span><span class="n">S</span><span class="m">003</span><span class="w">               </span><span class="o">|</span><span class="w"> </span><span class="n">Full</span><span class="w"> </span><span class="n">time</span><span class="o">|</span><span class="w">  </span><span class="n">Retired</span><span class="o">|</span><span class="w"> </span><span class="n">Unemployed</span><span class="o">|</span><span class="w">         </span><span class="n">D</span><span class="m">1</span><span class="o">|</span><span class="w">         </span><span class="n">D</span><span class="m">2</span><span class="o">|</span><span class="w">
</span><span class="o">|:------------------|---------:|--------:|----------:|----------:|----------:|</span><span class="w">
</span><span class="o">|</span><span class="n">Albania</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.634561</span><span class="o">|</span><span class="w"> </span><span class="m">5.807339</span><span class="o">|</span><span class="w">   </span><span class="m">6.066038</span><span class="o">|</span><span class="w">  </span><span class="m">0.5685232</span><span class="o">|</span><span class="w">  </span><span class="m">0.8272215</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Armenia</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.037671</span><span class="o">|</span><span class="w"> </span><span class="m">4.853333</span><span class="o">|</span><span class="w">   </span><span class="m">5.459016</span><span class="o">|</span><span class="w">  </span><span class="m">0.5786548</span><span class="o">|</span><span class="w">  </span><span class="m">1.1843379</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Austria</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.435950</span><span class="o">|</span><span class="w"> </span><span class="m">7.741936</span><span class="o">|</span><span class="w">   </span><span class="m">6.074074</span><span class="o">|</span><span class="w">  </span><span class="m">1.3618763</span><span class="o">|</span><span class="w"> </span><span class="m">-0.3059851</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Belarus</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.099162</span><span class="o">|</span><span class="w"> </span><span class="m">5.617391</span><span class="o">|</span><span class="w">   </span><span class="m">5.606061</span><span class="o">|</span><span class="w">  </span><span class="m">0.4931014</span><span class="o">|</span><span class="w">  </span><span class="m">0.4817707</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Belgium</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.717014</span><span class="o">|</span><span class="w"> </span><span class="m">7.834951</span><span class="o">|</span><span class="w">   </span><span class="m">6.366667</span><span class="o">|</span><span class="w">  </span><span class="m">1.3503472</span><span class="o">|</span><span class="w"> </span><span class="m">-0.1179376</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Bosnia</span><span class="w"> </span><span class="n">Herzegovina</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="m">7.332447</span><span class="o">|</span><span class="w"> </span><span class="m">7.006173</span><span class="o">|</span><span class="w">   </span><span class="m">6.771812</span><span class="o">|</span><span class="w">  </span><span class="m">0.5606347</span><span class="o">|</span><span class="w">  </span><span class="m">0.3262740</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Bulgaria</span><span class="w">           </span><span class="o">|</span><span class="w">  </span><span class="m">6.177007</span><span class="o">|</span><span class="w"> </span><span class="m">4.972973</span><span class="o">|</span><span class="w">   </span><span class="m">4.693878</span><span class="o">|</span><span class="w">  </span><span class="m">1.4831297</span><span class="o">|</span><span class="w">  </span><span class="m">1.2040343</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Croatia</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.305668</span><span class="o">|</span><span class="w"> </span><span class="m">6.478964</span><span class="o">|</span><span class="w">   </span><span class="m">7.165644</span><span class="o">|</span><span class="w">  </span><span class="m">0.1400238</span><span class="o">|</span><span class="w">  </span><span class="m">0.8267036</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Cyprus</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.384401</span><span class="o">|</span><span class="w"> </span><span class="m">7.031746</span><span class="o">|</span><span class="w">   </span><span class="m">6.560000</span><span class="o">|</span><span class="w">  </span><span class="m">0.8244011</span><span class="o">|</span><span class="w">  </span><span class="m">0.3526551</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Czech</span><span class="w"> </span><span class="n">Republic</span><span class="w">     </span><span class="o">|</span><span class="w">  </span><span class="m">7.302135</span><span class="o">|</span><span class="w"> </span><span class="m">6.885086</span><span class="o">|</span><span class="w">   </span><span class="m">6.065217</span><span class="o">|</span><span class="w">  </span><span class="m">1.2369173</span><span class="o">|</span><span class="w">  </span><span class="m">0.4170491</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Denmark</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">8.541315</span><span class="o">|</span><span class="w"> </span><span class="m">8.205426</span><span class="o">|</span><span class="w">   </span><span class="m">7.200000</span><span class="o">|</span><span class="w">  </span><span class="m">1.3413153</span><span class="o">|</span><span class="w">  </span><span class="m">0.3358890</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Estonia</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.925117</span><span class="o">|</span><span class="w"> </span><span class="m">6.253444</span><span class="o">|</span><span class="w">   </span><span class="m">4.971429</span><span class="o">|</span><span class="w">  </span><span class="m">1.9536884</span><span class="o">|</span><span class="w">  </span><span class="m">0.6716735</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Finland</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.817073</span><span class="o">|</span><span class="w"> </span><span class="m">8.018692</span><span class="o">|</span><span class="w">   </span><span class="m">5.767442</span><span class="o">|</span><span class="w">  </span><span class="m">2.0496313</span><span class="o">|</span><span class="w"> </span><span class="m">-0.2016184</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">France</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.200637</span><span class="o">|</span><span class="w"> </span><span class="m">6.974093</span><span class="o">|</span><span class="w">   </span><span class="m">6.242424</span><span class="o">|</span><span class="w">  </span><span class="m">0.9582127</span><span class="o">|</span><span class="w">  </span><span class="m">0.2265437</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Georgia</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.116667</span><span class="o">|</span><span class="w"> </span><span class="m">4.690377</span><span class="o">|</span><span class="w">   </span><span class="m">5.421446</span><span class="o">|</span><span class="w">  </span><span class="m">0.6952203</span><span class="o">|</span><span class="w">  </span><span class="m">1.4262901</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Germany</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.258114</span><span class="o">|</span><span class="w"> </span><span class="m">6.848548</span><span class="o">|</span><span class="w">   </span><span class="m">4.608466</span><span class="o">|</span><span class="w">  </span><span class="m">2.6496488</span><span class="o">|</span><span class="w">  </span><span class="m">0.4095667</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Great</span><span class="w"> </span><span class="n">Britain</span><span class="w">      </span><span class="o">|</span><span class="w">  </span><span class="m">7.532934</span><span class="o">|</span><span class="w"> </span><span class="m">7.930796</span><span class="o">|</span><span class="w">   </span><span class="m">6.025641</span><span class="o">|</span><span class="w">  </span><span class="m">1.5072931</span><span class="o">|</span><span class="w"> </span><span class="m">-0.3978617</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Greece</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.152113</span><span class="o">|</span><span class="w"> </span><span class="m">6.621622</span><span class="o">|</span><span class="w">   </span><span class="m">5.980392</span><span class="o">|</span><span class="w">  </span><span class="m">1.1717205</span><span class="o">|</span><span class="w">  </span><span class="m">0.5304911</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Hungary</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.645941</span><span class="o">|</span><span class="w"> </span><span class="m">5.890000</span><span class="o">|</span><span class="w">   </span><span class="m">4.858407</span><span class="o">|</span><span class="w">  </span><span class="m">1.7875342</span><span class="o">|</span><span class="w">  </span><span class="m">0.7559413</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Iceland</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">8.203857</span><span class="o">|</span><span class="w"> </span><span class="m">8.446808</span><span class="o">|</span><span class="w">   </span><span class="m">7.230769</span><span class="o">|</span><span class="w">  </span><span class="m">0.9730875</span><span class="o">|</span><span class="w"> </span><span class="m">-0.2429518</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Ireland</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.895735</span><span class="o">|</span><span class="w"> </span><span class="m">7.828571</span><span class="o">|</span><span class="w">   </span><span class="m">7.181818</span><span class="o">|</span><span class="w">  </span><span class="m">0.7139164</span><span class="o">|</span><span class="w">  </span><span class="m">0.0671632</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Italy</span><span class="w">              </span><span class="o">|</span><span class="w">  </span><span class="m">7.427083</span><span class="o">|</span><span class="w"> </span><span class="m">7.440594</span><span class="o">|</span><span class="w">   </span><span class="m">6.595745</span><span class="o">|</span><span class="w">  </span><span class="m">0.8313387</span><span class="o">|</span><span class="w"> </span><span class="m">-0.0135107</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Kosovo</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">6.297710</span><span class="o">|</span><span class="w"> </span><span class="m">6.038462</span><span class="o">|</span><span class="w">   </span><span class="m">6.784461</span><span class="o">|</span><span class="w"> </span><span class="m">-0.4867512</span><span class="o">|</span><span class="w">  </span><span class="m">0.2592484</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Latvia</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">6.516854</span><span class="o">|</span><span class="w"> </span><span class="m">5.928058</span><span class="o">|</span><span class="w">   </span><span class="m">5.305085</span><span class="o">|</span><span class="w">  </span><span class="m">1.2117692</span><span class="o">|</span><span class="w">  </span><span class="m">0.5887964</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Lithuania</span><span class="w">          </span><span class="o">|</span><span class="w">  </span><span class="m">6.586387</span><span class="o">|</span><span class="w"> </span><span class="m">5.631387</span><span class="o">|</span><span class="w">   </span><span class="m">4.530612</span><span class="o">|</span><span class="w">  </span><span class="m">2.0557752</span><span class="o">|</span><span class="w">  </span><span class="m">0.9550006</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Luxembourg</span><span class="w">         </span><span class="o">|</span><span class="w">  </span><span class="m">7.866221</span><span class="o">|</span><span class="w"> </span><span class="m">8.240224</span><span class="o">|</span><span class="w">   </span><span class="m">5.500000</span><span class="o">|</span><span class="w">  </span><span class="m">2.3662207</span><span class="o">|</span><span class="w"> </span><span class="m">-0.3740027</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Macedonia</span><span class="w">          </span><span class="o">|</span><span class="w">  </span><span class="m">7.193059</span><span class="o">|</span><span class="w"> </span><span class="m">6.671296</span><span class="o">|</span><span class="w">   </span><span class="m">6.609418</span><span class="o">|</span><span class="w">  </span><span class="m">0.5836403</span><span class="o">|</span><span class="w">  </span><span class="m">0.5217623</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Malta</span><span class="w">              </span><span class="o">|</span><span class="w">  </span><span class="m">7.700405</span><span class="o">|</span><span class="w"> </span><span class="m">7.760234</span><span class="o">|</span><span class="w">   </span><span class="m">5.954546</span><span class="o">|</span><span class="w">  </span><span class="m">1.7458594</span><span class="o">|</span><span class="w"> </span><span class="m">-0.0598291</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Moldova</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.117318</span><span class="o">|</span><span class="w"> </span><span class="m">5.976744</span><span class="o">|</span><span class="w">   </span><span class="m">6.071429</span><span class="o">|</span><span class="w">  </span><span class="m">1.0458899</span><span class="o">|</span><span class="w">  </span><span class="m">1.1405742</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Montenegro</span><span class="w">         </span><span class="o">|</span><span class="w">  </span><span class="m">7.632967</span><span class="o">|</span><span class="w"> </span><span class="m">7.216495</span><span class="o">|</span><span class="w">   </span><span class="m">7.473186</span><span class="o">|</span><span class="w">  </span><span class="m">0.1597809</span><span class="o">|</span><span class="w">  </span><span class="m">0.4164722</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Netherlands</span><span class="w">        </span><span class="o">|</span><span class="w">  </span><span class="m">8.037037</span><span class="o">|</span><span class="w"> </span><span class="m">7.945245</span><span class="o">|</span><span class="w">   </span><span class="m">7.000000</span><span class="o">|</span><span class="w">  </span><span class="m">1.0370370</span><span class="o">|</span><span class="w">  </span><span class="m">0.0917921</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Northern</span><span class="w"> </span><span class="n">Cyprus</span><span class="w">    </span><span class="o">|</span><span class="w">  </span><span class="m">6.738095</span><span class="o">|</span><span class="w"> </span><span class="m">6.444444</span><span class="o">|</span><span class="w">   </span><span class="m">5.642857</span><span class="o">|</span><span class="w">  </span><span class="m">1.0952381</span><span class="o">|</span><span class="w">  </span><span class="m">0.2936508</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Northern</span><span class="w"> </span><span class="n">Ireland</span><span class="w">   </span><span class="o">|</span><span class="w">  </span><span class="m">7.677419</span><span class="o">|</span><span class="w"> </span><span class="m">7.769231</span><span class="o">|</span><span class="w">   </span><span class="m">7.540540</span><span class="o">|</span><span class="w">  </span><span class="m">0.1368788</span><span class="o">|</span><span class="w"> </span><span class="m">-0.0918114</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Norway</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">8.193182</span><span class="o">|</span><span class="w"> </span><span class="m">8.264000</span><span class="o">|</span><span class="w">   </span><span class="m">8.000000</span><span class="o">|</span><span class="w">  </span><span class="m">0.1931818</span><span class="o">|</span><span class="w"> </span><span class="m">-0.0708182</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Poland</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.464692</span><span class="o">|</span><span class="w"> </span><span class="m">6.574830</span><span class="o">|</span><span class="w">   </span><span class="m">7.063291</span><span class="o">|</span><span class="w">  </span><span class="m">0.4014013</span><span class="o">|</span><span class="w">  </span><span class="m">0.8898626</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Portugal</span><span class="w">           </span><span class="o">|</span><span class="w">  </span><span class="m">6.838527</span><span class="o">|</span><span class="w"> </span><span class="m">5.878906</span><span class="o">|</span><span class="w">   </span><span class="m">5.438597</span><span class="o">|</span><span class="w">  </span><span class="m">1.3999304</span><span class="o">|</span><span class="w">  </span><span class="m">0.9596207</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Romania</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">7.135392</span><span class="o">|</span><span class="w"> </span><span class="m">6.574713</span><span class="o">|</span><span class="w">   </span><span class="m">7.407407</span><span class="o">|</span><span class="w"> </span><span class="m">-0.2720155</span><span class="o">|</span><span class="w">  </span><span class="m">0.5606793</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Russian</span><span class="w"> </span><span class="n">Federation</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="m">6.861436</span><span class="o">|</span><span class="w"> </span><span class="m">5.702290</span><span class="o">|</span><span class="w">   </span><span class="m">6.404255</span><span class="o">|</span><span class="w">  </span><span class="m">0.4571804</span><span class="o">|</span><span class="w">  </span><span class="m">1.1591456</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Serbia</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.170673</span><span class="o">|</span><span class="w"> </span><span class="m">6.673203</span><span class="o">|</span><span class="w">   </span><span class="m">6.731517</span><span class="o">|</span><span class="w">  </span><span class="m">0.4391556</span><span class="o">|</span><span class="w">  </span><span class="m">0.4974705</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Slovakia</span><span class="w">           </span><span class="o">|</span><span class="w">  </span><span class="m">7.468384</span><span class="o">|</span><span class="w"> </span><span class="m">6.710145</span><span class="o">|</span><span class="w">   </span><span class="m">6.118644</span><span class="o">|</span><span class="w">  </span><span class="m">1.3497400</span><span class="o">|</span><span class="w">  </span><span class="m">0.7582391</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Slovenia</span><span class="w">           </span><span class="o">|</span><span class="w">  </span><span class="m">7.834211</span><span class="o">|</span><span class="w"> </span><span class="m">7.130435</span><span class="o">|</span><span class="w">   </span><span class="m">6.760000</span><span class="o">|</span><span class="w">  </span><span class="m">1.0742105</span><span class="o">|</span><span class="w">  </span><span class="m">0.7037757</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Spain</span><span class="w">              </span><span class="o">|</span><span class="w">  </span><span class="m">7.336870</span><span class="o">|</span><span class="w"> </span><span class="m">7.209945</span><span class="o">|</span><span class="w">   </span><span class="m">7.191781</span><span class="o">|</span><span class="w">  </span><span class="m">0.1450892</span><span class="o">|</span><span class="w">  </span><span class="m">0.1269253</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Sweden</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">7.877315</span><span class="o">|</span><span class="w"> </span><span class="m">8.173554</span><span class="o">|</span><span class="w">   </span><span class="m">6.515151</span><span class="o">|</span><span class="w">  </span><span class="m">1.3621633</span><span class="o">|</span><span class="w"> </span><span class="m">-0.2962389</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Switzerland</span><span class="w">        </span><span class="o">|</span><span class="w">  </span><span class="m">8.037528</span><span class="o">|</span><span class="w"> </span><span class="m">8.115578</span><span class="o">|</span><span class="w">   </span><span class="m">5.761905</span><span class="o">|</span><span class="w">  </span><span class="m">2.2756228</span><span class="o">|</span><span class="w"> </span><span class="m">-0.0780503</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Turkey</span><span class="w">             </span><span class="o">|</span><span class="w">  </span><span class="m">6.500000</span><span class="o">|</span><span class="w"> </span><span class="m">6.606965</span><span class="o">|</span><span class="w">   </span><span class="m">5.762542</span><span class="o">|</span><span class="w">  </span><span class="m">0.7374582</span><span class="o">|</span><span class="w"> </span><span class="m">-0.1069652</span><span class="o">|</span><span class="w">
</span><span class="o">|</span><span class="n">Ukraine</span><span class="w">            </span><span class="o">|</span><span class="w">  </span><span class="m">6.344398</span><span class="o">|</span><span class="w"> </span><span class="m">5.444444</span><span class="o">|</span><span class="w">   </span><span class="m">4.949367</span><span class="o">|</span><span class="w">  </span><span class="m">1.3950313</span><span class="o">|</span><span class="w">  </span><span class="m">0.8999539</span><span class="o">|</span><span class="w">
</span></code></pre></div>  </div>
  <h4 id="make-a-scatterplot-sorted-according-to-work-ethic">Make a scatterplot, sorted according to work ethic</h4>
  <p>In order to plot the differences ordered by the average work ethic, we first need to get all data from Wave 4 (using <code class="language-r highlighter-rouge"><span class="n">subset</span></code>), summarize the <code class="language-r highlighter-rouge"><span class="n">work_ethic</span></code> variable by country (<code class="language-r highlighter-rouge"><span class="n">group_by</span></code> then <code class="language-r highlighter-rouge"><span class="n">summarize</span></code>), and store the results in a temporary dataframe (<code class="language-r highlighter-rouge"><span class="n">df.work.ethic</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.work_ethic</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">    
  </span><span class="n">select</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">work_ethic</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">mean_work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">work_ethic</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <p>We can now combine the average <code class="language-r highlighter-rouge"><span class="n">work_ethic</span></code> data with the table containing the difference in means (using <code class="language-r highlighter-rouge"><span class="n">inner_join</span></code> to match the data correctly by country) and make a scatterplot using <code class="language-r highlighter-rouge"><span class="n">ggplot</span></code>. This process can be repeated for the difference in means between full-time employed and retired individuals by changing <code class="language-r highlighter-rouge"><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span></code> to <code class="language-r highlighter-rouge"><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">2</span></code> in the <code class="language-r highlighter-rouge"><span class="n">ggplot</span></code> function.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.employment</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Combine with the average work ethic data</span><span class="w">
  </span><span class="n">inner_join</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">df.work_ethic</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"S003"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean_work</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_point</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Work ethic"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Difference"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Difference in wellbeing between the 
      full-time employed and the unemployed"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="c1"># Rotate the country names</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="w">
      </span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> 
      </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-8-5">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-08-05.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-05.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-05.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Difference in life satisfaction (wellbeing) between the full-time employed and the unemployed vs average work ethic.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-05.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-05-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-05.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Difference in life satisfaction (wellbeing) between the full-time employed and the unemployed vs average work ethic.
" class="" />
        </a>
</div>
<p class="description">
Difference in life satisfaction (wellbeing) between the full-time employed and the unemployed vs average work ethic.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.5 </span>
Difference in life satisfaction (wellbeing) between the full-time employed and the unemployed vs average work ethic.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>To calculate correlation coefficients, use the <code class="language-r highlighter-rouge"><span class="n">cor</span></code> function. You can see that the correlation between average work ethic and difference in life satisfaction is quite weak for employed vs unemployed, but moderate and positive for employed vs retired.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Full-time vs unemployed</span><span class="w">
</span><span class="n">cor</span><span class="p">(</span><span class="n">df.employment</span><span class="o">$</span><span class="n">D</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">df.work_ethic</span><span class="o">$</span><span class="n">mean_work</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] -0.1575654</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Full-time vs retired</span><span class="w">
</span><span class="n">cor</span><span class="p">(</span><span class="n">df.employment</span><span class="o">$</span><span class="n">D</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df.work_ethic</span><span class="o">$</span><span class="n">mean_work</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] 0.4842609</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>So far we have described the data using tables and charts, but have not made any statements about whether what we observe is consistent with an assumption that work ethic has no bearing on differences in life satisfaction between different subgroups. In the next part, we will assess the relationship between employment status and life satisfaction and assess whether the observed data lead us to reject the above assumption.</p>
<h2 id="part-83-confidence-intervals-for-difference-in-the-mean">Part 8.3 Confidence intervals for difference in the mean</h2>
<blockquote class="info">
  <h3 id="note-1">Note</h3>
  <p>You will need to have done Questions 1–5 in Part 8.1 before doing this part. Part 8.2 is not necessary but is helpful to get an idea of what the data looks like.</p>
</blockquote>
<blockquote class="box fixed">
  <h3 id="learning-objectives-for-this-part-2">Learning objectives for this part</h3>
  <ul>
    <li>calculate and interpret confidence intervals for the difference in means between two groups.</li>
  </ul>
</blockquote>
<p>The aim of this project was to look at the empirical relationship between employment and life satisfaction.</p>
<p>When we calculate differences between groups, we collect evidence which may or may not support a hypothesis that life satisfaction is identical between different subgroups. Economists often call this testing for statistical significance. In <a href="06-03.html#part-62-do-management-practices-differ-between-countries" class="show-page-number">Part 6.2</a> of Empirical Project 6, we constructed 95% confidence intervals for means, and used a rule of thumb to assess our hypothesis that the two groups considered were identical (at the population level) in the variable of interest. Now we will learn how to construct confidence intervals for the difference in two means, which allows us to make such a judgment on the basis of a single confidence interval.</p>
<p class="loosen-15">Remember that the width of a confidence interval depends on the standard deviation and number of observations. (Read <a href="06-03.html#part-62-do-management-practices-differ-between-countries" class="show-page-number">Part 6.2</a> of Empirical Project 6 to understand why.) When making a confidence interval for a sample mean (such as the mean life satisfaction of the unemployed), we use the sample standard deviation and number of observations in that sample (unemployed people) to obtain the standard error of the sample mean.</p>
<script type="math/tex; mode=display">\text{Standard error of sample mean (SE)} = \frac{\text{SD of sample data}}{\sqrt{\text{number of observations (n)}}}</script>
<p>When we look at the difference in means (such as life satisfaction of employed minus unemployed), we are using data from two groups (the unemployed and the employed) to make one confidence interval. To calculate the standard error for the difference in means, we use the standard errors (SE) of each group:</p>
<script type="math/tex; mode=display">\text{SE (difference in means)} = \sqrt{(\text{SE of group 1})^2 + (\text{SE of group 2})^2}</script>
<p class="loosen-10">This formula requires the two groups of data to be independent, meaning that the data from one group is not related, paired, or matched with data from the other group. This assumption is reasonable for the life satisfaction data we are using. However, if the two groups of data are not independent, for example if the same people generated both groups of data (as in the public goods experiments of <a href="02-01.html" class="show-page-number">Empirical Project 2</a>), then we cannot use this formula.</p>
<p>Once we have the new standard error and number of observations, we can calculate the width of the confidence interval (distance from the mean to one end of the interval) as before. The width of the confidence interval tells us how precisely the difference in means was estimated, and this precision tells us how compatible the sample data is with the hypothesis that there is no difference between the population means. If the value 0 falls outside the 95% confidence interval, this implies that the data is unlikely to have been sampled from a population with equal population means. For example, if the estimated difference is positive, and the 95% confidence interval is not wide enough to include 0, we can be reasonably confident that the true difference is positive too. In other words, it tells us that the p-value for the difference we have found is less than 0.05, so we would be very unlikely to find such a big difference if the population means were in fact identical.</p>
<p>In Figure 8.6, for Great Britain, we can be reasonably confident that the true difference in average life satisfaction between the full-time employed and the unemployed is positive. However, for Spain, we do not have strong evidence of a real difference in mean life satisfaction.</p>
<div class="figure fixed figure-no-source" id="figure-8-6">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/figure-08-07.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/figure-08-07.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/figure-08-07-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/figure-08-07-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/figure-08-07-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/figure-08-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="95% confidence intervals for the average difference in life satisfaction (full-time employed minus unemployed) in Great Britain and Spain.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/figure-08-07.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/figure-08-07-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/figure-08-07-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/figure-08-07-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/figure-08-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="95% confidence intervals for the average difference in life satisfaction (full-time employed minus unemployed) in Great Britain and Spain.
" class="" />
        </a>
</div>
<p class="description">
95% confidence intervals for the average difference in life satisfaction (full-time employed minus unemployed) in Great Britain and Spain.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.6 </span>
95% confidence intervals for the average difference in life satisfaction (full-time employed minus unemployed) in Great Britain and Spain.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
<ol class="text-question">
  <li>We will apply this method to make confidence intervals for differences in life satisfaction. Choose three countries: one with an average work ethic in the top third of scores, one in the middle third, and one in the lower third. (See <a href="06-03.html#r-walk-through-63-creating-box-and-whisker-plots" class="show-page-number">R walk-through 6.3</a> for help on calculating confidence intervals and adding them to a chart.)</li>
</ol>
<ul class="text-sub-question">
  <li>
    <p>In Question 4 of <a href="#part-82-visualizing-the-data" class="show-page-number">Part 8.2</a> you computed the average life satisfaction score by country and employment type (using Wave 4 data). Repeat this procedure to obtain the standard error for the means for each of your chosen countries.</p>
    <p>Create a table for these countries, showing the average life satisfaction score, standard deviation of life satisfaction, and number of observations, with country (<code class="language-r highlighter-rouge"><span class="n">S</span><span class="m">003</span></code>) as the row variable, and employment status (full-time employed, retired, and unemployed only) as the column variable.</p>
  </li>
</ul>
<ul class="text-sub-question">
  <li>Use your table from Question 1<em>(a)</em> to calculate the difference in means (full-time employed minus unemployed, and full-time employed minus retired), the standard deviation of these differences, the number of observations, and the confidence interval.</li>
</ul>
<ul class="text-sub-question">
  <li>Use R’s <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function to determine the 95% confidence interval width of the difference in means and compare your results with Question 1<em>(b)</em>.</li>
</ul>
<ul class="text-sub-question">
  <li>Plot a column chart for your chosen countries showing the difference in life satisfaction (employed vs unemployed and employed vs retired) on the vertical axis, and country on the horizontal axis (sorted according to low, medium, and high work ethic). Add the confidence intervals from Question 1<em>(c)</em> to your chart.</li>
</ul>
<ul class="text-sub-question">
  <li>Interpret your findings from Question 1<em>(d)</em>, commenting on the size of the observed differences in means, and the precision of your estimates.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-810-calculating-confidence-intervals-and-adding-error-bars"><strong>R walk-through 8.10</strong> Calculating confidence intervals and adding error bars</h3>
  <p>We will use Turkey, Spain, and Great Britain as example countries in the top, middle, and bottom third of work ethic scores respectively.</p>
  <p>In the tasks in Questions 1<em>(a)</em> and <em>(b)</em> we will obtain the means, standard errors, and 95% confidence intervals step-by-step, then for Question 1<em>(c)</em> we show how to use a shortcut to obtain confidence intervals from a single function.</p>
  <h4 id="calculate-confidence-intervals-manually">Calculate confidence intervals manually</h4>
  <p>We obtained the difference in means in <a href="#r-walk-through-89-calculating-group-means" class="show-page-number">R walk-through 8.9</a> (<code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">1</span></code> and <code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">2</span></code>), so now we can calculate the standard error of the means for each country of interest.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># List chosen countries</span><span class="w">
</span><span class="n">country_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Turkey"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Spain"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Great Britain"</span><span class="p">)</span><span class="w">
</span><span class="n">df.employment.se</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Wave 4</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="c1"># Select the employment types we are interested in</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">employment_list</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select countries</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">country_list</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Group by country and employment type</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="m">028</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate the standard error of each group mean</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">A</span><span class="m">170</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">()))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Calculate the SE of difference</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">D</span><span class="m">1</span><span class="err">_</span><span class="n">SE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">`Full time`</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Unemployed</span><span class="o">^</span><span class="m">2</span><span class="p">),</span><span class="w"> 
    </span><span class="n">D</span><span class="m">2</span><span class="err">_</span><span class="n">SE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">`Full time`</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Retired</span><span class="o">^</span><span class="m">2</span><span class="p">))</span><span class="w"> 
</span></code></pre></div>  </div>
  <p>We can now combine the standard errors with the difference in means, and compute the 95% confidence interval width.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df.employment</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df.employment</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select chosen countries</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">country_list</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We only need the differences.</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">`Full time`</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">Retired</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">Unemployed</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Join the means with the respective SEs</span><span class="w">
  </span><span class="n">inner_join</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">df.employment.se</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"S003"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">`Full time`</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">Retired</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">Unemployed</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Compute confidence interval width for both differences</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">CI_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.96</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">D</span><span class="m">1</span><span class="err">_</span><span class="n">SE</span><span class="p">,</span><span class="w"> </span><span class="n">CI_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.96</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">D</span><span class="m">2</span><span class="err">_</span><span class="n">SE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 3 x 7</span><span class="w">
</span><span class="c1">## # Groups:   S003 [3]</span><span class="w">
</span><span class="c1">##   S003             D1     D2 D1_SE D2_SE  CI_1  CI_2</span><span class="w">
</span><span class="c1">##   &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span><span class="w">
</span><span class="c1">## 1 Great Britain 1.51  -0.398 0.267 0.154 0.524 0.302</span><span class="w">
</span><span class="c1">## 2 Spain         0.145  0.127 0.265 0.168 0.520 0.330</span><span class="w">
</span><span class="c1">## 3 Turkey        0.737 -0.107 0.229 0.231 0.449 0.452</span><span class="w">
</span></code></pre></div>  </div>
  <p class="tighten-15">We now have a table containing the difference in means, the standard error of the difference in means, and the confidence intervals for each of the two differences. (Recall that <code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">1</span></code> is the difference between the average life satisfaction for full-time employed and unemployed, and <code class="language-r highlighter-rouge"><span class="n">D</span><span class="m">2</span></code> is the difference in average life satisfaction for full-time employed and retired individuals.)</p>
  <h4 id="calculate-confidence-intervals-using-the-ttest-function">Calculate confidence intervals using the <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function</h4>
  <p>We could obtain the confidence intervals directly by using the <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function. First we need to prepare the data in two groups. In the following example we go through the difference in average life satisfaction for full-time employed and unemployed individuals in Turkey, but the process can be repeated for the difference between full-time employed and retired individuals by changing the code appropriately (also for your other two chosen countries).</p>
  <p>We start by selecting the data for full-time and unemployed people in Turkey, and storing it in two separate temporary matrices (arrays of rows and columns) called <code class="language-r highlighter-rouge"><span class="n">turkey_full</span></code> and <code class="language-r highlighter-rouge"><span class="n">turkey_unemployed</span></code> respectively, which is the format needed for the <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">turkey_full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select Wave 4 only</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select country</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Turkey"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Select employment type</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Full time"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We only need the life satisfaction data.</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">A</span><span class="m">170</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># We have to set it as a matrix for t.test.</span><span class="w">
  </span><span class="n">as.matrix</span><span class="p">()</span><span class="w">

</span><span class="c1"># Repeat for second group</span><span class="w">
</span><span class="n">turkey_unemployed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lifesat_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">002</span><span class="n">EVS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"2008-2010"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">    
  </span><span class="n">subset</span><span class="p">(</span><span class="n">S</span><span class="m">003</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Turkey"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="n">X</span><span class="m">028</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Unemployed"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">A</span><span class="m">170</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">as.matrix</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <p>We can now use the <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function on the two newly created matrices. We also set the confidence level to 95%. The <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function produces quite a bit of output, but we are only interested in the confidence interval, which we can obtain by using <code class="language-r highlighter-rouge"><span class="o">$</span><span class="n">conf.int</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">turkey_ci</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t.test</span><span class="p">(</span><span class="n">turkey_full</span><span class="p">,</span><span class="w"> </span><span class="n">turkey_unemployed</span><span class="p">,</span><span class="w"> 
  </span><span class="n">conf.level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="p">)</span><span class="o">$</span><span class="n">conf.int</span><span class="w">
</span><span class="n">turkey_ci</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] 0.2873459 1.1875704</span><span class="w">
</span><span class="c1">## attr(,"conf.level")</span><span class="w">
</span><span class="c1">## [1] 0.95</span><span class="w">
</span></code></pre></div>  </div>
  <p>We can then calculate the difference in means by finding the midpoint of the interval (<code class="language-r highlighter-rouge"><span class="p">(</span><span class="n">turkey_ci</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">turkey_ci</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="o">/</span><span class="m">2</span></code> is 0.7374582), which should be the same as the figures obtained in Question 1<em>(b)</em> (<code class="language-r highlighter-rouge"><span class="n">df.employment</span><span class="p">[</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span></code> is 0.7374582).</p>
  <h4 id="add-error-bars-to-the-column-charts">Add error bars to the column charts</h4>
  <p>We can now use these confidence intervals (and widths) to add error bars to our column charts. To do so, we use the <code class="language-r highlighter-rouge"><span class="n">geom_errorbar</span></code> option, and specify the lower and upper levels of the confidence interval for the <code class="language-r highlighter-rouge"><span class="n">ymin</span></code> and <code class="language-r highlighter-rouge"><span class="n">ymax</span></code> options respectively. In this case it is easier to use the results from Questions 1<em>(a)</em> and <em>(b)</em>, as we already have the values for the difference in means and the CI width stored as variables.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">df.employment</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="m">003</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_errorbar</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CI_1</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">CI_1</span><span class="p">),</span><span class="w"> 
    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Difference in means"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Country"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Difference in wellbeing 
    (full-time and unemployed)"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-8-7">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-08-07.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-07.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-08-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Difference in life satisfaction (wellbeing) between full-time employed and unemployed.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-08-07.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-07-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-08-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Difference in life satisfaction (wellbeing) between full-time employed and unemployed.
" class="" />
        </a>
</div>
<p class="description">
Difference in life satisfaction (wellbeing) between full-time employed and unemployed.
</p>
<p class="caption">
<span class="figure-reference">Figure 8.7 </span>
Difference in life satisfaction (wellbeing) between full-time employed and unemployed.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>Again, this can be repeated for the difference in life satisfaction between full-time employed and retired. Remember to change <code class="language-r highlighter-rouge"><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">1</span></code> to <code class="language-r highlighter-rouge"><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">D</span><span class="m">2</span></code>, and change the upper and lower limits for the error bars.</p>
</blockquote>
<ol class="text-question">
  <li>The method we used to compare life satisfaction relied on making comparisons between people with different employment statuses, but a person’s employment status is not entirely random. We cannot therefore make causal statements such as ‘being unemployed causes life satisfaction to decrease’. Describe how we could use the following methods to assess better the effect of being unemployed on life satisfaction, and make some statements about causality:</li>
</ol>
<ul class="text-sub-question">
  <li>a natural experiment</li>
</ul>
<ul class="text-sub-question tighten-15">
  <li>panel data (data on the same individuals, taken at different points in time).</li>
</ul>
	</div><!--#content-->
    <div id="nav" class="non-printing">
            <h2>Doing Economics</h2>
            <div class="search">
<form class="search" action="../../search.html" method="get">
  <label for="search-box"></label>
  <input type="text" id="search-box" class="search-box" name="query" placeholder="Search">
  <input id="search-language" type="hidden" name="lang" value="en">
</form>
            </div><!--.search-->
            <div class="nav-list">
                    <ol class="nav-series-home">
                        <li><a href="../../index.html">Home</a></li>
                    </ol>
    <ol>
        <li class="
        no-children
        ">
            <a href="0-3-contents.html#contents"
               class="">
                Table of contents
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-4-preface.html#preface"
               class="">
                Preface
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-5-note-to-instructors.html#a-note-to-instructors"
               class="">
                A note to instructors
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-6-contributors.html#producing-doing-economics"
               class="">
                Producing <em>Doing Economics</em>
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-7-resources.html#resources"
               class="">
                List of resources
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                1—Measuring climate change
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-02.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-02.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-02.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-11-the-behaviour-of-average-surface-temperature-over-time"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-05.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-05.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-05.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-04.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-04.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-04.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                2—Collecting and analysing data from experiments
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-02.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-02.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-02.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-21-collecting-data-by-playing-a-public-goods-game"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-05.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-05.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-05.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-04.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-04.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-04.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                3—Measuring the effect of a sugar tax
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-02.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-02.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-03.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-03.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-05.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-05.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-04.html"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-04.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                4—Measuring wellbeing
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-02.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-02.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-03.html"
               class="">
                R-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#getting-started-in-r"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-05.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-05.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-04.html"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-04.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                5—Measuring inequality: Lorenz curves and Gini coefficients
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-02.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-02.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-03.html"
               class="">
                R-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#getting-started-in-r"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#part-51-measuring-income-inequality"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        has-children
        ">
            <a href="05-05.html#empirical-project-5-working-in-google-sheets"
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-05.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-05.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-04.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-04.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                6—Measuring management practices
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-02.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-02.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-02.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-61-looking-for-patterns-in-the-survey-data"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-05.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-05.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-05.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-04.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-04.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-04.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                7—Supply and demand
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-02.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-02.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-03.html#part-71-drawing-supply-and-demand-diagrams"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-03.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-05.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-05.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-04.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-04.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                8—Measuring the non-monetary cost of unemployment
            </a>
    <ol class="active">
        <li class="
        no-children
        ">
            <a href="08-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-02.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-02.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-02.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="active
        no-file
        no-link
        has-children
        ">
            <a 
               class="active">
                Working in R
            </a>
    <ol class="active">
        <li class="active
        no-children
        ">
            <a href="08-03.html"
               class="active">
                Getting started in R
            </a>
        </li>
        <li class="active
        no-children
        ">
            <a href="08-03.html#part-81-cleaning-and-summarizing-the-data"
               class="active">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="active
        no-children
        ">
            <a href="08-03.html#part-82-visualizing-the-data"
               class="active">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="active
        no-children
        ">
            <a href="08-03.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="active">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-05.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-05.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-05.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-04.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-04.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-04.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                9—Credit-excluded households in a developing country
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-02.html#part-91-households-that-did-not-get-a-loan"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-02.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-03.html#part-91-households-that-did-not-get-a-loan"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-03.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-05.html#part-91-households-that-did-not-get-a-loan"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-05.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-04.html"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-04.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                10—Characteristics of banking systems around the world
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-02.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-02.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-03.html#part-101-summarizing-the-data"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-03.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-05.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-05.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-04.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-04.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                11—Measuring willingness to pay for climate change mitigation
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-02.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-02.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-03.html#part-111-summarizing-the-data"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-03.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-05.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-05.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-04.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-04.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                12—Government policies and popularity: Hong Kong cash handout
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-02.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-02.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-03.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-03.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-05.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-05.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-04.html"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-04.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-00-technical-reference.html"
               class="">
                Technical Reference
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-01-glossary.html#glossary"
               class="">
                Glossary
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-02-bibliography.html#bibliography"
               class="">
                Bibliography
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-03-copyright-acknowledgements.html#copyright-acknowledgements"
               class="">
                Copyright acknowledgements
            </a>
        </li>
    </ol>
            </div><!--.nav-list-->
            <div class="widgets">
            </div><!--.widgets-->
    </div><!--#nav-->
    <div id="footer" dir="ltr">
        <div class="footer-content">
            <div class="footer-logos">
                <a href="http://core-econ.org">
                    <img src="../../assets/coreecon_logo_bw.png">
                </a>
            </div>
            <div class="footer-text">
                <p>This ebook is developed by the CORE project. More information and additional resources for learning and teaching can be found at <a href="https://www.core-econ.org">www.core-econ.org</a>.</p>
            </div>
            <div class="footer-licence">
                <a title="Licensed under Creative Commons BY NC ND" alt="Licensed under Creative Commons BY NC ND" href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="../../assets/cc-byncnd.png"></a>
                <br />
                Version 1.0.0 &bull; Produced by <a href='https://electricbookworks.com'>Electric Book Works</a>
            </div>
        </div><!--.footer-content-->
    </div><!--#footer-->
    <script src="../../assets/js/bundle.js?date=20200224120313"></script>
    <style>
        .js-mcq .mcq-correct .mcq-feedback:before {
            content: "Correct!";
        }
        .js-mcq .mcq-incorrect .mcq-feedback:before {
            content: "Incorrect";
        }
        .js-mcq .mcq-partially-correct .mcq-feedback:before {
            content: "You haven't selected all the correct answers.";
        }
    </style>
</div><!--#wrapper-->
</body>
</html>
