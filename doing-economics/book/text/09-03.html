
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>
    Doing Economics: Empirical Project 9: Working in R
    </title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="../../assets/favicon.png">
    <meta property="og:title" content="Empirical Project 9: Working in R" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.core-econ.org/doing-economics/book/text/09-03.html" />
    <meta property="og:description" content="A unique resource for learning data handling, software and statistical skills by working through projects that address real-world policy problems." />
    <meta property="og:image" content="https://www.core-econ.org/doing-economics/book/images/web/cover.jpg" />
    <link rel="stylesheet" type="text/css" media="all" href="../styles/web.css?date=20200224120313" />
    <script>
        function delete_cookie(name) {
            document.cookie = name + '=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT;';
            console.log('Expired and removed MathJax menu cookie.');
        }
        delete_cookie('mjx.menu')
    </script>
            <script id="MathJaxConfig" type="text/x-mathjax-config" >
                MathJax.Hub.Config({
                    "HTML-CSS": {
                        availableFonts: [], // force use of webFont
                        webFont: "Gyre-Pagella",
                        scale: 90,
                        styles: {
                            ".MathJax [style*=border-top-width]": {
                                "border-top-width": "0.5pt ! important"
                            }
                        }
                    },
                    messageStyle: "none"
                });
            </script>
            <script id="MathJax"
                src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML">
            </script>
<script>
WebFontConfig = {
     google: {
         families: ['Amiri:400,400i,700', 'Source Sans Pro:400,700,700:latin-ext', 'Asap:400,400i,600,600i']
     }
};
(function(d) {
    var wf = d.createElement('script'), s = d.scripts[0];
    wf.src = 'https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js';
    wf.async = true;
    s.parentNode.insertBefore(wf, s);
})(document)
</script>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-71347024-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-106812057-1');
</script>
</head>
<body class="book chapter subchapter"
>
<div id="wrapper">
<div class="masthead">
        <ul>
                <li class="masthead-book-title">
                    <a href="../../index.html">Doing Economics</a>
                </li>
        </ul>
    <div class="controls">
    </div>
</div><!--.masthead-->
<div class="nav-buttons">
	<a class="nav-back-button">←</a>
	<a class="nav-button" href="#nav">Contents</a>
</div>
    <div class="chapter-opener-image chapter-opener-image-none">
    </div>
	<div id="content">
<h1 id="empirical-project-9-working-in-r"><strong>Empirical Project 9</strong> Working in R</h1>
<blockquote class="info web-full-width">
  <h3 id="download-the-code">Download the code</h3>
  <p>To <a href="https://tinyco.re/8264624">download the code chunks used in this project</a>, right-click on the download link and select ‘Save Link As…’. You’ll need to save the code download to your working directory, and open it in RStudio.</p>
  <p>Don’t forget to also download the data into your working directory by following the steps in this project.</p>
</blockquote>
<h2 class="save-2" id="getting-started-in-r">Getting started in R</h2>
<p>For this project you will need the following packages:</p>
<ul>
  <li><code class="language-r highlighter-rouge"><span class="n">tidyverse</span></code>, to help with data manipulation</li>
  <li><code class="language-r highlighter-rouge"><span class="n">readxl</span></code>, to import an Excel spreadsheet</li>
  <li><code class="language-r highlighter-rouge"><span class="n">knitr</span></code>, to format tables</li>
  <li><code class="language-r highlighter-rouge"><span class="n">mosaic</span></code>, to help create frequency tables.</li>
</ul>
<p>If you need to install these packages, run the following code:</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"readxl"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tidyverse"</span><span class="p">,</span><span class="w"> </span><span class="s2">"knitr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mosaic"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>
<p>You can import the libraries now, or when they are used in the R walk-throughs below.</p>
<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">  
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mosaic</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>
<h2 id="part-91-households-that-did-not-get-a-loan">Part 9.1 Households that did not get a loan</h2>
<blockquote class="box fixed">
  <h3 id="learning-objectives-for-this-part">Learning objectives for this part</h3>
  <ul>
    <li>identify credit-constrained and credit-excluded households using survey information</li>
    <li>create dummy (indicator) variables</li>
    <li>compare characteristics of successful borrowers, discouraged borrowers, credit-constrained households, and credit-excluded households</li>
    <li>explain why selection bias is an important issue.</li>
  </ul>
</blockquote>
<p class="tighten-15">The Ethiopian Socioeconomic Survey (ESS) data was collected in 2013–14 from a nationally representative sample of households. Households were asked about topics such as their housing conditions, assets, and access to credit.</p>
<p>Download the ESS data and survey questionnaire:</p>
<ul>
  <li>Download the <a href="https://tinyco.re/6067633" class="show-url">ESS data</a>. The Excel file contains three tabs (‘Data dictionary’, ‘All households’, and ‘Got loan’). Read the ‘Data dictionary’ tab and make sure you know what each variable represents. For Part 9.1 we will use the data from the ‘All households’ tab. The ‘Got loan’ data will be used in Part 9.2.</li>
  <li>For the documentation, go to <a href="https://tinyco.re/9757350" class="show-url">the data download site</a>. Click on the ‘Documentation’ tab in the middle of the page.</li>
  <li class="tighten-15">Under the heading ‘Questionnaires’, download the PDF file called ‘2013–2014 Ethiopian Socioeconomic Survey, Household Questionnaire’ by clicking the ‘Download’ button on the right-hand side of the page. You may find it helpful to refer to Section 14 of the questionnaire for the exact questions asked about credit and saving.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-91-importing-data-into-r"><strong>R walk-through 9.1</strong> Importing data into R</h3>
  <p>Before importing the data, open it in Excel to look at its structure. You can see there are three tabs: ‘Data dictionary’, ‘All households’, and ‘Got loan’. We will import them into separate dataframes (<code class="language-r highlighter-rouge"><span class="n">DataDict</span></code>, <code class="language-r highlighter-rouge"><span class="n">allHH</span></code>, and <code class="language-r highlighter-rouge"><span class="n">gotL</span></code> respectively). We import the ‘Data dictionary’ so that we do not have to return to the Excel spreadsheet.</p>
  <p class="tighten-15">Also note that there are a lot of empty cells, which is how missing data is coded in Excel (but not in R). In the <code class="language-r highlighter-rouge"><span class="n">read_excel</span></code> function we therefore use the <code class="language-r highlighter-rouge"><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span></code> option so that R recognizes empty cells as missing data.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">

</span><span class="c1"># Set your working directory to the correct folder.</span><span class="w">
</span><span class="c1"># Insert your file path for 'YOURFILEPATH'.</span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="s2">"YOURFILEPATH"</span><span class="p">)</span><span class="w">

</span><span class="n">allHH</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project 9 datafile.xlsx"</span><span class="p">,</span><span class="w"> 
  </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"All households"</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">)</span><span class="w">

</span><span class="n">gotL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project 9 datafile.xlsx"</span><span class="p">,</span><span class="w"> 
  </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Got loan"</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">)</span><span class="w">

</span><span class="n">DataDict</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"Project 9 datafile.xlsx"</span><span class="p">,</span><span class="w"> 
  </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Data dictionary"</span><span class="p">,</span><span class="w"> </span><span class="n">na</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now let’s look at the variable types for<code class="language-r highlighter-rouge"><span class="n">allHH</span></code> and <code class="language-r highlighter-rouge"><span class="n">gotL</span></code>. To see the variable definitions, use the command <code class="language-r highlighter-rouge"><span class="n">view</span><span class="p">(</span><span class="n">DataDict</span><span class="p">)</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">allHH</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Classes 'tbl_df', 'tbl' and 'data.frame':    5262 obs. of  19 variables:</span><span class="w">
</span><span class="c1">##  $ household_id2     : num  1.01e+16 1.01e+16 1.01e+16 1.01e+16 1.01e+16 ...</span><span class="w">
</span><span class="c1">##  $ got_loan          : chr  "No" "No" "No" "Yes" ...</span><span class="w">
</span><span class="c1">##  $ rural             : chr  "Rural" "Rural" "Rural" "Rural" ...</span><span class="w">
</span><span class="c1">##  $ hhsize            : num  8 8 1 3 4 4 5 5 6 7 ...</span><span class="w">
</span><span class="c1">##  $ region            : chr  "Tigray" "Tigray" "Tigray" "Tigray" ...</span><span class="w">
</span><span class="c1">##  $ gender            : chr  "Female" "Male" "Female" "Female" ...</span><span class="w">
</span><span class="c1">##  $ age               : num  78 37 78 30 71 28 37 32 51 43 ...</span><span class="w">
</span><span class="c1">##  $ young_children    : num  4 5 0 1 1 3 2 3 3 2 ...</span><span class="w">
</span><span class="c1">##  $ working_age_adults: num  3 3 0 2 1 1 3 2 3 6 ...</span><span class="w">
</span><span class="c1">##  $ max_education     : num  3 0 0 4 8 4 9 6 4 5 ...</span><span class="w">
</span><span class="c1">##  $ number_assets     : num  32 19 3 6 34 5 45 35 20 64 ...</span><span class="w">
</span><span class="c1">##  $ loan_rejected     : chr  "No" "No" "No" "No" ...</span><span class="w">
</span><span class="c1">##  $ rejection_source1 : chr  NA NA NA NA ...</span><span class="w">
</span><span class="c1">##  $ rejection_source2 : chr  NA NA NA NA ...</span><span class="w">
</span><span class="c1">##  $ loan_purpose      : chr  NA NA NA NA ...</span><span class="w">
</span><span class="c1">##  $ loan_purpose_other: chr  NA NA NA NA ...</span><span class="w">
</span><span class="c1">##  $ did_not_apply     : chr  "Did not apply" "Did not apply" "Did not apply" "Applied" ...</span><span class="w">
</span><span class="c1">##  $ reason_not_apply1 : chr  "Too Expensive" "Believe Would Be Refused" "Too Expensive" NA ...</span><span class="w">
</span><span class="c1">##  $ reason_not_apply2 : chr  "Fear Not Be Able To Pay" NA "Fear Not Be Able To Pay" NA ...</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">gotL</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Classes 'tbl_df', 'tbl' and 'data.frame':    1480 obs. of  21 variables:</span><span class="w">
</span><span class="c1">##  $ household_id2      : num  1.01e+16 1.01e+16 1.01e+16 1.01e+16 1.01e+16 ...</span><span class="w">
</span><span class="c1">##  $ got_loan           : chr  "Yes" "Yes" "Yes" "Yes" ...</span><span class="w">
</span><span class="c1">##  $ rural              : chr  "Rural" "Rural" "Rural" "Rural" ...</span><span class="w">
</span><span class="c1">##  $ hhsize             : num  3 4 5 9 7 7 8 7 10 8 ...</span><span class="w">
</span><span class="c1">##  $ region             : chr  "Tigray" "Tigray" "Tigray" "Tigray" ...</span><span class="w">
</span><span class="c1">##  $ gender             : chr  "Female" "Male" "Male" "Male" ...</span><span class="w">
</span><span class="c1">##  $ age                : num  30 71 53 52 56 38 44 47 52 37 ...</span><span class="w">
</span><span class="c1">##  $ young_children     : num  1 1 3 4 3 4 4 3 2 6 ...</span><span class="w">
</span><span class="c1">##  $ working_age_adults : num  2 1 2 6 3 3 4 4 8 2 ...</span><span class="w">
</span><span class="c1">##  $ max_education      : num  4 8 5 8 7 7 8 6 10 1 ...</span><span class="w">
</span><span class="c1">##  $ number_assets      : num  6 34 14 16 9 14 24 15 22 10 ...</span><span class="w">
</span><span class="c1">##  $ borrowed_from      : chr  "Relative" "Relative" "Relative" "Other (specify)" ...</span><span class="w">
</span><span class="c1">##  $ borrowed_from_other: chr  NA NA NA "Cooperatives" ...</span><span class="w">
</span><span class="c1">##  $ loan_purpose       : chr  "Purchase Agricultural Inputs for Food Crop" "Purchase Agricultural Inputs for Food Crop" "Purchase Agricultural Inputs for Food Crop" "Purchase Agricultural Inputs for Food Crop" ...</span><span class="w">
</span><span class="c1">##  $ loan_startmonth    : chr  "March" "November" "November" "June" ...</span><span class="w">
</span><span class="c1">##  $ loan_startyear     : num  2004 2006 2006 2005 2005 ...</span><span class="w">
</span><span class="c1">##  $ loan_repaid        : chr  "Yes" "Yes" "No" "No" ...</span><span class="w">
</span><span class="c1">##  $ loan_endmonth      : chr  NA NA "June" "March" ...</span><span class="w">
</span><span class="c1">##  $ loan_endyear       : num  NA NA 2006 2006 2006 ...</span><span class="w">
</span><span class="c1">##  $ loan_amount        : num  1000 800 2500 2653 1600 ...</span><span class="w">
</span><span class="c1">##  $ loan_interest      : num  300 0 1750 325 300 1750 290 300 300 268 ...</span><span class="w">
</span></code></pre></div>  </div>
  <p>It is important to ensure that all variables we expect to be numerical (numbers) are coded as <code class="language-r highlighter-rouge"><span class="n">num</span></code>, and in this case, they are. You can see that there are many variables that are coded as character (<code class="language-r highlighter-rouge"><span class="n">chr</span></code>) variables because they are text (for example <code class="language-r highlighter-rouge"><span class="n">gender</span></code> or <code class="language-r highlighter-rouge"><span class="n">region</span></code>), but since we can use these variables to group data by category, we will use <code class="language-r highlighter-rouge"><span class="n">as.factor</span></code> to change them into categorical (factor) variables for later use.</p>
  <p>Instead of converting each character variable to a factor variable individually, say <code class="language-r highlighter-rouge"><span class="n">allHH</span><span class="o">$</span><span class="n">gender</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">allHH</span><span class="o">$</span><span class="n">gender</span><span class="p">)</span></code>, we use the piping operator (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>) from the <code class="language-r highlighter-rouge"><span class="n">tidyverse</span></code> package to do this step in one go. (For a more detailed introduction to piping, see the <a href="https://tinyco.re/5531433" class="show-url">University of Manchester’s Econometric Computing Learning Resource</a>).</p>
  <p>We take <code class="language-r highlighter-rouge"><span class="n">allHH</span></code> and use the <code class="language-r highlighter-rouge"><span class="n">mutate_if</span></code> function, which applies the <code class="language-r highlighter-rouge"><span class="n">as.factor</span></code> function to character variables only. Then we do the same for <code class="language-r highlighter-rouge"><span class="n">gotL</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">allHH</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHH</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">mutate_if</span><span class="p">(</span><span class="n">is.character</span><span class="p">,</span><span class="w"> </span><span class="n">as.factor</span><span class="p">)</span><span class="w">

</span><span class="n">gotL</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotL</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">mutate_if</span><span class="p">(</span><span class="n">is.character</span><span class="p">,</span><span class="w"> </span><span class="n">as.factor</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Typing <code class="language-r highlighter-rouge"><span class="n">str</span><span class="p">(</span><span class="n">allHH</span><span class="p">)</span></code> and <code class="language-r highlighter-rouge"><span class="n">str</span><span class="p">(</span><span class="n">gotL</span><span class="p">)</span></code> will confirm that all character variables are now categorical variables.</p>
</blockquote>
<ol class="text-question page-break-before">
  <li>The data is already in a format clean enough to use, so we will begin by summarizing the information in the ‘All households’ tab, starting with region and household characteristics.</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table showing the proportion of households that lived in each region and area type, with <code class="language-r highlighter-rouge"><span class="n">region</span></code> as the row variable and <code class="language-r highlighter-rouge"><span class="n">rural</span></code> as the column variable. (For help on creating tables, see <a href="03-03.html#r-walk-through-33-creating-frequency-tables" class="show-page-number">R walk-through 3.3</a>.)</li>
</ul>
<ul class="text-sub-question">
  <li>Use the <code class="language-r highlighter-rouge"><span class="n">Gender</span></code> variable to find what percentage of household heads were female.</li>
</ul>
<ul class="text-sub-question">
  <li>Create an appropriate summary table for the variables <code class="language-r highlighter-rouge"><span class="n">hhsize</span></code>, <code class="language-r highlighter-rouge"><span class="n">gender</span></code>, <code class="language-r highlighter-rouge"><span class="n">age</span></code>, <code class="language-r highlighter-rouge"><span class="n">young_children</span></code>, <code class="language-r highlighter-rouge"><span class="n">working_age_adults</span></code>, <code class="language-r highlighter-rouge"><span class="n">max_education</span></code>, and <code class="language-r highlighter-rouge"><span class="n">number_assets</span></code>. (You may find it helpful to refer to <a href="02-03.html#r-walk-through-27-creating-a-table-of-summary-statistics" class="show-page-number">R walk-through 2.7</a> in Empirical Project 2 for one possible format to use.)</li>
</ul>
<ul class="text-sub-question">
  <li>Write a short paragraph describing the information in your tables for 1<em>(c)</em>.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-92-creating-summary-tables"><strong>R walk-through 9.2</strong> Creating summary tables</h3>
  <p>In order to get the proportions of households living in large towns, small towns, or rural areas (encoded in the variable <code class="language-r highlighter-rouge"><span class="n">rural</span></code>), we use the <code class="language-r highlighter-rouge"><span class="n">table</span></code> function. The counts (number) of households in the respective regions and area types are contained in stab1. Running this table through the <code class="language-r highlighter-rouge"><span class="n">prop.table</span><span class="p">()</span></code> function changes the values from counts to proportions. The optional input <code class="language-r highlighter-rouge"><span class="p">(,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span></code> makes the proportions for each row add to one. (You could see what happens when you leave this option out, or if you choose the value <code class="language-r highlighter-rouge"><span class="m">2</span></code>.) To obtain detailed information, use the command <code class="language-r highlighter-rouge"><span class="o">?</span><span class="n">prop.table</span><span class="w"> </span><span class="n">.</span></code></p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Control how many digits are printed</span><span class="w">
</span><span class="n">options</span><span class="p">(</span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">

</span><span class="n">stab1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">allHH</span><span class="o">$</span><span class="n">region</span><span class="p">,</span><span class="w"> </span><span class="n">allHH</span><span class="o">$</span><span class="n">rural</span><span class="p">)</span><span class="w">

</span><span class="n">prop.table</span><span class="p">(</span><span class="n">stab1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                  </span><span class="w">
</span><span class="c1">##                   Large town (urban)  Rural Small town (urban)</span><span class="w">
</span><span class="c1">##   Addis Ababa                 1.0000 0.0000             0.0000</span><span class="w">
</span><span class="c1">##   Afar                        0.0956 0.7574             0.1471</span><span class="w">
</span><span class="c1">##   Amhara                      0.2176 0.6692             0.1132</span><span class="w">
</span><span class="c1">##   Benshagul Gumuz             0.0000 0.9040             0.0960</span><span class="w">
</span><span class="c1">##   Diredwa                     0.4685 0.5315             0.0000</span><span class="w">
</span><span class="c1">##   Gambelia                    0.1154 0.8000             0.0846</span><span class="w">
</span><span class="c1">##   Harari                      0.2727 0.7273             0.0000</span><span class="w">
</span><span class="c1">##   Oromia                      0.2831 0.6070             0.1098</span><span class="w">
</span><span class="c1">##   SNNP                        0.1826 0.7270             0.0905</span><span class="w">
</span><span class="c1">##   Somalie                     0.1552 0.7552             0.0897</span><span class="w">
</span><span class="c1">##   Tigray                      0.3670 0.5628             0.0701</span><span class="w">
</span></code></pre></div>  </div>
  <p>Let’s use a similar approach to calculate the percentage of households with female heads (encoded in the variable <code class="language-r highlighter-rouge"><span class="n">gender</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stab2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">allHH</span><span class="o">$</span><span class="n">gender</span><span class="p">)</span><span class="w">

</span><span class="n">prop.table</span><span class="p">(</span><span class="n">stab2</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## </span><span class="w">
</span><span class="c1">## Female   Male </span><span class="w">
</span><span class="c1">##  0.304  0.696</span><span class="w">
</span></code></pre></div>  </div>
  <p>As shown, 30.4% of households have a female head.</p>
  <p>We need to provide summary statistics for a range of variables. Most of these variables are numeric variables, but one, <code class="language-r highlighter-rouge"><span class="n">gender</span></code>, is a factor variable. For the latter, we use the <code class="language-r highlighter-rouge"><span class="n">summary</span></code> function. For the numeric variables we use the <code class="language-r highlighter-rouge"><span class="n">favstats</span></code> function, which is part of the <code class="language-r highlighter-rouge"><span class="n">mosaic</span></code> package. We could also use the <code class="language-r highlighter-rouge"><span class="n">summary</span></code> function, but it does not provide the standard deviations that we need.</p>
  <p>The summary statistics for the numeric variables are generated using the <code class="language-r highlighter-rouge"><span class="n">lapply</span></code> (list apply) function. Inside the function we specify the subset of variables we are interested in, <code class="language-r highlighter-rouge"><span class="n">subset</span><span class="p">(</span><span class="n">allHH</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sel_q</span><span class="p">)</span></code>, and specify the function we want to apply to these variables, namely the <code class="language-r highlighter-rouge"><span class="n">favstats</span></code> function.</p>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load the mosaic package</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mosaic</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">allHH</span><span class="o">$</span><span class="n">gender</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Female   Male   NA's </span><span class="w">
</span><span class="c1">##   1599   3662      1</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a list of the numeric variable names</span><span class="w">
</span><span class="n">sel_q</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'hhsize'</span><span class="p">,</span><span class="w"> </span><span class="s1">'age'</span><span class="p">,</span><span class="w"> </span><span class="s1">'young_children'</span><span class="p">,</span><span class="w"> 
  </span><span class="s1">'working_age_adults'</span><span class="p">,</span><span class="w"> </span><span class="s1">'max_education'</span><span class="p">,</span><span class="w"> </span><span class="s1">'number_assets'</span><span class="p">)</span><span class="w">

</span><span class="n">lapply</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">allHH</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sel_q</span><span class="p">),</span><span class="w"> </span><span class="n">favstats</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## $hhsize</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean  sd    n missing</span><span class="w">
</span><span class="c1">##    1  3      4  6  16 4.58 2.4 5260       2</span><span class="w">
</span><span class="c1">## </span><span class="w">
</span><span class="c1">## $age</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean   sd    n missing</span><span class="w">
</span><span class="c1">##    3 32     42 55  99 44.2 15.6 5253       9</span><span class="w">
</span><span class="c1">## </span><span class="w">
</span><span class="c1">## $young_children</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean   sd    n missing</span><span class="w">
</span><span class="c1">##    0  0      2  3  10 1.89 1.71 5262       0</span><span class="w">
</span><span class="c1">## </span><span class="w">
</span><span class="c1">## $working_age_adults</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean   sd    n missing</span><span class="w">
</span><span class="c1">##    0  2      2  3  10 2.58 1.52 5262       0</span><span class="w">
</span><span class="c1">## </span><span class="w">
</span><span class="c1">## $max_education</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean   sd    n missing</span><span class="w">
</span><span class="c1">##    0  2      6 10  30 7.53 7.28 5262       0</span><span class="w">
</span><span class="c1">## </span><span class="w">
</span><span class="c1">## $number_assets</span><span class="w">
</span><span class="c1">##  min Q1 median Q3 max mean   sd    n missing</span><span class="w">
</span><span class="c1">##    0  5      9 18 203 14.9 17.2 5262       0</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>Now that we have an idea of what our data looks like, we will move on to identifying households that are potentially excluded from the credit market or are credit constrained. The former are households that find it impossible to borrow, and the latter are households that can only borrow on unfavourable terms (see <a href="https://tinyco.re/5630844" class="show-url">Section 9.10</a> of <em>Economy, Society, and Public Policy</em>).</p>
<p>The variables in our dataset that are related to this issue are <code class="language-r highlighter-rouge"><span class="n">did_not_apply</span></code> and <code class="language-r highlighter-rouge"><span class="n">loan_rejected</span></code>. Later we will also look at the responses given in the variables ‘reason_not_apply1’ and ‘reason_not_apply2’.</p>
<ol class="text-question keep-with-next">
  <li>Using the ‘All households’ dataset:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a frequency table with <code class="language-r highlighter-rouge"><span class="n">did_not_apply</span></code> as the row variable and <code class="language-r highlighter-rouge"><span class="n">loan_rejected</span></code> as the column variable. Include all ‘NA’ as a separate row.</li>
</ul>
<ul class="text-sub-question">
  <li>Looking at these two variables, explain why some observations should be excluded and remove them from the dataset. Also remove all households with missing information for one or more of these variables. Of the non-excluded observations, what percentage of households applied for a loan over the past 12 months? Of those households, what percentage were successful?</li>
</ul>
<ul class="text-sub-question">
  <li>For the resulting categories in the frequency table, explain whether the households in that category can be described as credit constrained, credit excluded, or both.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-93-making-frequency-tables-for-loan-applications-and-outcomes"><strong>R walk-through 9.3</strong> Making frequency tables for loan applications and outcomes</h3>
  <p>The easiest way to make a frequency table is to use the <code class="language-r highlighter-rouge"><span class="n">table</span></code> function. Note that we nested the <code class="language-r highlighter-rouge"><span class="n">table</span><span class="w"> </span><span class="p">()</span></code> function in the <code class="language-r highlighter-rouge"><span class="n">addmargins</span></code> function to obtain row and column totals.</p>
  <p>By default, the table function excludes missing (<code class="language-r highlighter-rouge"><span class="kc">NA</span></code>) values. Consulting the help function (type <code class="language-r highlighter-rouge"><span class="o">?</span><span class="n">table</span></code> in the command window) will show that the option <code class="language-r highlighter-rouge"><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"always"</span></code> includes these values.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stab3</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">addmargins</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="w">
  </span><span class="n">allHH</span><span class="o">$</span><span class="n">did_not_apply</span><span class="p">,</span><span class="w"> 
  </span><span class="n">allHH</span><span class="o">$</span><span class="n">loan_rejected</span><span class="p">,</span><span class="w">
  </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"always"</span><span class="p">,</span><span class="w"> </span><span class="n">dnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Applied?"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rejected?"</span><span class="p">)))</span><span class="w">

</span><span class="n">stab3</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                Rejected?</span><span class="w">
</span><span class="c1">## Applied?          No  Yes &lt;NA&gt;  Sum</span><span class="w">
</span><span class="c1">##   Applied       1363  201    1 1565</span><span class="w">
</span><span class="c1">##   Did not apply 3632   24    2 3658</span><span class="w">
</span><span class="c1">##   &lt;NA&gt;            37    2    0   39</span><span class="w">
</span><span class="c1">##   Sum           5032  227    3 5262</span><span class="w">
</span></code></pre></div>  </div>
  <p class="keep-together">Here, we decide to exclude the 24 households that indicated that they did not apply for a loan, but also indicated that they were refused a loan. This is a contestable decision, as it results in excluding more than 10% of households that indicated that they were refused a loan. We shall also remove all observations that have missing data for any of these two questions.</p>
  <p>Now we create the dataset with the non-missing data only (<code class="language-r highlighter-rouge"><span class="n">allHHc</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Remove NAs in did_not_apply</span><span class="w">
</span><span class="n">allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">allHH</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">allHH</span><span class="o">$</span><span class="n">did_not_apply</span><span class="p">))</span><span class="w">
</span><span class="n">allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">allHHc</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">loan_rejected</span><span class="p">))</span><span class="w"> 

</span><span class="c1"># Show the number of observations</span><span class="w">
</span><span class="n">nrow</span><span class="p">(</span><span class="n">allHHc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] 5220</span><span class="w">
</span></code></pre></div>  </div>
  <p>At this stage we have dropped 42 observations. Now we delete the 24 observations that gave a nonsensical answer.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">allHHc</span><span class="p">,</span><span class="w"> 
  </span><span class="o">!</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">loan_rejected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> 
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">did_not_apply</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Did not apply"</span><span class="p">))</span><span class="w"> 

</span><span class="c1"># Show the number of observations</span><span class="w">
</span><span class="n">nrow</span><span class="p">(</span><span class="n">allHHc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] 5196</span><span class="w">
</span></code></pre></div>  </div>
  <p>We are left with 5,196 observations. Let’s recreate the frequency table, but this time adding the <code class="language-r highlighter-rouge"><span class="n">prop.table</span></code> function to calculate proportions. (To obtain percentages, multiply the proportions by 100.)</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stab4</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">addmargins</span><span class="p">(</span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">did_not_apply</span><span class="p">,</span><span class="w"> 
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">loan_rejected</span><span class="p">,</span><span class="w">
  </span><span class="n">dnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Applied?"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rejected?"</span><span class="p">))))</span><span class="w">

</span><span class="n">stab4</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                Rejected?</span><span class="w">
</span><span class="c1">## Applied?            No    Yes    Sum</span><span class="w">
</span><span class="c1">##   Applied       0.2623 0.0387 0.3010</span><span class="w">
</span><span class="c1">##   Did not apply 0.6990 0.0000 0.6990</span><span class="w">
</span><span class="c1">##   Sum           0.9613 0.0387 1.0000</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p class="keep-with-next">To create operational categories to use throughout this project, we will label households as either:</p>
<ul>
  <li>‘successful’: households that applied for a loan and were given the loan</li>
  <li>‘denied’: households that applied but were not given the loan</li>
  <li>‘did not apply’: households that did not apply for a loan.</li>
</ul>
<p>You should note that the ‘denied’ households are only a subset of the credit-excluded households, as there will be households that are credit excluded and do not even apply for a loan. One could, for instance, reason that households who answered ‘Inadequate Collateral’ or ‘Do Not Know Any Lender’ are also likely to be credit excluded.</p>
<ol class="text-question">
  <li>Using the subset of data from Question 2<em>(b)</em>:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a new variable called <code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> with the above categories.</li>
</ul>
<ul class="text-sub-question">
  <li>Create a new variable <code class="language-r highlighter-rouge"><span class="n">discouraged_borrower</span></code> that takes the value 1 if the household did not apply for a loan because it believed that it would not receive a loan (answered ‘Believe Would Be Refused’ in <code class="language-r highlighter-rouge"><span class="n">reason_not_apply1</span></code> or <code class="language-r highlighter-rouge"><span class="n">reason_not_apply2</span></code>). How many households (and what percentage) are discouraged borrowers? (<em>Note:</em> This is a fairly narrow definition of ‘discouraged’ and one could easily argue that other criteria should also be considered under this label.)</li>
</ul>
<p class="sidenote">Note that arguably other answers are also indicative of being credit constrained, so the criteria we use is definitely only a subset of all households that are credit constrained. For example, one could include households that have been denied a loan, and it is also likely that some households that have been granted a loan are in fact credit constrained.</p>
<ul class="text-sub-question">
  <li>Create a new variable <code class="language-r highlighter-rouge"><span class="n">credit_constrained</span></code> that takes the value 1 (or yes) for households that gave a reason for not applying other than ‘NA’, ‘Other’, or ‘Have Adequate Farm’ in either of the two questions <code class="language-r highlighter-rouge"><span class="n">reason_not_apply1</span></code> or <code class="language-r highlighter-rouge"><span class="n">reason_not_apply2</span></code>, and 0 otherwise. For example, a household that answers ‘Have Adequate Farm’ in <code class="language-r highlighter-rouge"><span class="n">reason_not_apply1</span></code> and ‘Do Not Know Any Lender’ would not be classified as credit constrained. How many households (and what percentage) are credit constrained?</li>
</ul>
<ul class="text-sub-question tighten-15">
  <li>Create a frequency table showing the most important reason for not applying for a loan, and another showing the second most important reason for not applying. What were the most common reasons for not applying?</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-94-creating-variables-to-classify-households"><strong>R walk-through 9.4</strong> Creating variables to classify households</h3>
  <p>Let’s first create the <code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> variable. We set the values of <code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> to <code class="language-r highlighter-rouge"><span class="err">”</span><span class="n">not</span><span class="w"> </span><span class="n">applied</span><span class="err">”</span></code>, then use logical indexing to change all entries where households applied for a loan (<code class="language-r highlighter-rouge"><span class="n">allHHc</span><span class="o">$</span><span class="n">did_not_apply</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">“</span><span class="n">Applied</span><span class="err">”</span></code>) and were accepted (<code class="language-r highlighter-rouge"><span class="n">allHHC</span><span class="o">$</span><span class="n">loan_rejected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">“</span><span class="n">No</span><span class="err">”</span></code>) to <code class="language-r highlighter-rouge"><span class="err">“</span><span class="n">successful</span><span class="err">”</span></code>, and households who were denied ((<code class="language-r highlighter-rouge"><span class="n">allHHC</span><span class="o">$</span><span class="n">loan_rejected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">“</span><span class="n">Yes</span><span class="err">”</span></code>) to <code class="language-r highlighter-rouge"><span class="err">”</span><span class="n">denied</span><span class="err">”</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is the default category.</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"not applied"</span><span class="w">

</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">did_not_apply</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Applied"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> 
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">loan_rejected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"No"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"successful"</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">did_not_apply</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Applied"</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> 
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">loan_rejected</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"denied"</span><span class="w">

</span><span class="c1"># Change from character to factor variable</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Typing <code class="language-r highlighter-rouge"><span class="n">summary</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">)</span></code> should give you numbers that correspond to the frequency table from Question 2.</p>
  <p>Let’s continue by using the same steps to make the <code class="language-r highlighter-rouge"><span class="n">discouraged_borrower</span></code> variable.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># This is the default category.</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"No"</span><span class="w">

</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="w"> </span><span class="o">==</span><span class="w"> 
  </span><span class="s2">"Believe Would Be Refused"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply2</span><span class="w"> </span><span class="o">==</span><span class="w"> 
  </span><span class="s2">"Believe Would Be Refused"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w">

</span><span class="c1"># Change from character to factor variable</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">factor</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##   No  Yes </span><span class="w">
</span><span class="c1">## 4608  588</span><span class="w">
</span></code></pre></div>  </div>
  <p>To make the <code class="language-r highlighter-rouge"><span class="n">credit_constrained</span></code> variable, we use the <code class="language-r highlighter-rouge"><span class="n">levels</span></code> function to check all the possible answers to the <code class="language-r highlighter-rouge"><span class="n">reason_not_apply1</span></code> variable. We store these answers in the object <code class="language-r highlighter-rouge"><span class="n">sel_ans</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_ans</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="p">)</span><span class="w">
</span><span class="n">sel_ans</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##  [1] "Believe Would Be Refused"  "Do Not Know Any Lender"   </span><span class="w">
</span><span class="c1">##  [3] "Do Not Like To Be In Debt" "Fear Not Be Able To Pay"  </span><span class="w">
</span><span class="c1">##  [5] "Have Adequate Farm"        "Inadequate Collateral"    </span><span class="w">
</span><span class="c1">##  [7] "No Farm or Business"       "Other (Specify)"          </span><span class="w">
</span><span class="c1">##  [9] "Too Expensive"             "Too Much Trouble"</span><span class="w">
</span></code></pre></div>  </div>
  <p>Of these reasons, only reasons [5] and [8] do not lead to a conclusion that a household is credit constrained, so we remove them from <code class="language-r highlighter-rouge"><span class="n">sel_ans</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Remove reasons 5 and 8</span><span class="w">
</span><span class="n">sel_ans</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sel_ans</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">)]</span><span class="w">

</span><span class="c1"># This is the default category, as households that did not </span><span class="w">
</span><span class="c1"># provide any reasons are classified as not credit </span><span class="w">
</span><span class="c1"># constrained.</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"No"</span><span class="w">

</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="w"> 
  </span><span class="o">%in%</span><span class="w"> </span><span class="n">sel_ans</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply2</span><span class="w"> 
  </span><span class="o">%in%</span><span class="w"> </span><span class="n">sel_ans</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Yes"</span><span class="w">

</span><span class="c1"># Change from character to factor variable</span><span class="w">
</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">factor</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##   No  Yes </span><span class="w">
</span><span class="c1">## 2184 3012</span><span class="w">
</span></code></pre></div>  </div>
  <p>The use of <code class="language-r highlighter-rouge"><span class="o">%in%</span></code> in the selection criterion <code class="language-r highlighter-rouge"><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">sel_ans</span></code> is a very useful programming technique that you can use to select data according to a list of values/variables. In this case, <code class="language-r highlighter-rouge"><span class="n">sel_ans</span></code> contains all the answers that we associate with a credit-constrained household.</p>
  <p><code class="language-r highlighter-rouge"><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">sel_ans</span></code> gives an outcome of <code class="language-r highlighter-rouge"><span class="kc">TRUE</span></code> if the answer to <code class="language-r highlighter-rouge"><span class="n">reason_not_apply1</span></code> is one of the answers in <code class="language-r highlighter-rouge"><span class="n">sel_ans</span></code>, then sets the value of <code class="language-r highlighter-rouge"><span class="n">credit_constrained</span></code> to ‘Yes’ for those observations.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stab4</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">addmargins</span><span class="p">(</span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="p">,</span><span class="w"> </span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="p">,</span><span class="w"> 
  </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ifany"</span><span class="p">,</span><span class="w"> </span><span class="n">dnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
    </span><span class="s2">"Constrained?"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Discouraged?"</span><span class="p">))))</span><span class="w">

</span><span class="n">stab4</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##             Discouraged?</span><span class="w">
</span><span class="c1">## Constrained?    No   Yes   Sum</span><span class="w">
</span><span class="c1">##          No  0.420 0.000 0.420</span><span class="w">
</span><span class="c1">##          Yes 0.467 0.113 0.580</span><span class="w">
</span><span class="c1">##          Sum 0.887 0.113 1.000</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Required for the use of the kable function</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="s2">"Reasons not to apply 1"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "Reasons not to apply 1"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 'kable' is optional but formats tables more neatly.</span><span class="w">
</span><span class="n">table5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply1</span><span class="p">))</span><span class="w">

</span><span class="n">kable</span><span class="p">(</span><span class="n">table5</span><span class="p">[</span><span class="n">rev</span><span class="p">(</span><span class="n">order</span><span class="p">(</span><span class="n">table5</span><span class="p">))])</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Var1</span><span class="w">                          </span><span class="n">Freq</span><span class="w">
</span><span class="o">--------------------------</span><span class="w">  </span><span class="o">------</span><span class="w">
</span><span class="n">Do</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Like</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">Debt</span><span class="w">    </span><span class="m">0.191</span><span class="w">
</span><span class="n">Have</span><span class="w"> </span><span class="n">Adequate</span><span class="w"> </span><span class="n">Farm</span><span class="w">           </span><span class="m">0.185</span><span class="w">
</span><span class="n">Fear</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">Able</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">Pay</span><span class="w">      </span><span class="m">0.170</span><span class="w">
</span><span class="n">Believe</span><span class="w"> </span><span class="n">Would</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">Refused</span><span class="w">     </span><span class="m">0.116</span><span class="w">
</span><span class="n">No</span><span class="w"> </span><span class="n">Farm</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">Business</span><span class="w">          </span><span class="m">0.102</span><span class="w">
</span><span class="n">Do</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Know</span><span class="w"> </span><span class="n">Any</span><span class="w"> </span><span class="n">Lender</span><span class="w">       </span><span class="m">0.068</span><span class="w">
</span><span class="n">Too</span><span class="w"> </span><span class="n">Expensive</span><span class="w">                </span><span class="m">0.049</span><span class="w">
</span><span class="n">Inadequate</span><span class="w"> </span><span class="n">Collateral</span><span class="w">        </span><span class="m">0.045</span><span class="w">
</span><span class="n">Other</span><span class="w"> </span><span class="p">(</span><span class="n">Specify</span><span class="p">)</span><span class="w">              </span><span class="m">0.041</span><span class="w">
</span><span class="n">Too</span><span class="w"> </span><span class="n">Much</span><span class="w"> </span><span class="n">Trouble</span><span class="w">             </span><span class="m">0.033</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r page-break-before highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="s2">"Reasons not to apply 2"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "Reasons not to apply 2"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">table6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">reason_not_apply2</span><span class="p">))</span><span class="w">

</span><span class="n">kable</span><span class="p">(</span><span class="n">table6</span><span class="p">[</span><span class="n">rev</span><span class="p">(</span><span class="n">order</span><span class="p">(</span><span class="n">table6</span><span class="p">))])</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Var1</span><span class="w">                          </span><span class="n">Freq</span><span class="w">
</span><span class="o">--------------------------</span><span class="w">  </span><span class="o">------</span><span class="w">
</span><span class="n">Fear</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">Able</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">Pay</span><span class="w">      </span><span class="m">0.277</span><span class="w">
</span><span class="n">Do</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Like</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">Debt</span><span class="w">    </span><span class="m">0.243</span><span class="w">
</span><span class="n">Inadequate</span><span class="w"> </span><span class="n">Collateral</span><span class="w">        </span><span class="m">0.087</span><span class="w">
</span><span class="n">Believe</span><span class="w"> </span><span class="n">Would</span><span class="w"> </span><span class="n">Be</span><span class="w"> </span><span class="n">Refused</span><span class="w">     </span><span class="m">0.087</span><span class="w">
</span><span class="n">Too</span><span class="w"> </span><span class="n">Expensive</span><span class="w">                </span><span class="m">0.068</span><span class="w">
</span><span class="n">Do</span><span class="w"> </span><span class="n">Not</span><span class="w"> </span><span class="n">Know</span><span class="w"> </span><span class="n">Any</span><span class="w"> </span><span class="n">Lender</span><span class="w">       </span><span class="m">0.064</span><span class="w">
</span><span class="n">Too</span><span class="w"> </span><span class="n">Much</span><span class="w"> </span><span class="n">Trouble</span><span class="w">             </span><span class="m">0.062</span><span class="w">
</span><span class="n">Have</span><span class="w"> </span><span class="n">Adequate</span><span class="w"> </span><span class="n">Farm</span><span class="w">           </span><span class="m">0.050</span><span class="w">
</span><span class="n">No</span><span class="w"> </span><span class="n">Farm</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">Business</span><span class="w">          </span><span class="m">0.040</span><span class="w">
</span><span class="n">Other</span><span class="w"> </span><span class="p">(</span><span class="n">Specify</span><span class="p">)</span><span class="w">              </span><span class="m">0.024</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<p>We will now analyse the stated reasons for wanting a loan, comparing those households that were successful (<code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> equal to ‘successful’) with those that were not successful (<code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> equal to ‘denied’).</p>
<ol class="text-question">
  <li>For both groups, create one table showing the proportion of households for each loan purpose. You will realize that in the ‘All households’ dataset, the reason for all ‘successful’ loans is ‘Other’. For that reason, you should use the ‘Got loan’ dataset to retrieve the reasons for loan information for successful loans. Was the purpose of loans for denied and successful borrowers similar? (<em>Hint:</em> It may help to think about the broad categories of spending on consumption and investment.)</li>
</ol>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-95-making-frequency-tables-to-compare-proportions"><strong>R walk-through 9.5</strong> Making frequency tables to compare proportions</h3>
  <p>Some of the data is in the <code class="language-r highlighter-rouge"><span class="n">allHH</span></code> dataset, while the rest is in the <code class="language-r highlighter-rouge"><span class="n">gotL</span></code> dataset, both of which we imported in <a href="#r-walk-through-91-importing-data-into-r" class="show-page-number">R walk-through 9.1</a>. We will combine that information into one new dataset called <code class="language-r highlighter-rouge"><span class="n">loan_data</span></code>, which we then use to produce the table.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"successful"</span><span class="p">,</span><span class="w"> </span><span class="s2">"denied"</span><span class="p">)))</span><span class="w">

</span><span class="c1"># Removes the unused 'did not apply' level</span><span class="w">
</span><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">droplevels</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">)</span><span class="w">

</span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="w">
  </span><span class="n">sel_allHHc</span><span class="o">$</span><span class="n">loan_purpose</span><span class="p">,</span><span class="w"> </span><span class="n">sel_allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">,</span><span class="w"> 
  </span><span class="n">dnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Loan Purpose"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Loan"</span><span class="p">)),</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                                             Loan</span><span class="w">
</span><span class="c1">## Loan Purpose                                 denied successful</span><span class="w">
</span><span class="c1">##   Business Start-up Capital                  0.2615     0.0000</span><span class="w">
</span><span class="c1">##   Expanding Business                         0.1385     1.0000</span><span class="w">
</span><span class="c1">##   Other (Specify)                            0.2718     0.0000</span><span class="w">
</span><span class="c1">##   Purchase Agricultural Inputs for Food Crop 0.2103     0.0000</span><span class="w">
</span><span class="c1">##   Purchase House/Lease Land                  0.0308     0.0000</span><span class="w">
</span><span class="c1">##   Purchase Inputs for other Crops            0.0615     0.0000</span><span class="w">
</span><span class="c1">##   Purchase Non-farm Inputs                   0.0256     0.0000</span><span class="w">
</span></code></pre></div>  </div>
  <p>This reveals a particular feature of the data, namely that for successful borrowers, the <code class="language-r highlighter-rouge"><span class="n">allHHc</span></code> dataset does not contain all the useful information, as every successful household has ‘Other (Specify)’ in the <code class="language-r highlighter-rouge"><span class="n">loan_purpose</span></code> variable. There is more useful information on loan purpose in the <code class="language-r highlighter-rouge"><span class="n">gotL</span></code> data, so we will extract the <code class="language-r highlighter-rouge"><span class="n">loan_purpose</span></code> variable for unsuccessful households from the <code class="language-r highlighter-rouge"><span class="n">allHHc</span></code> dataset, and the equivalent information for successful loaners from the <code class="language-r highlighter-rouge"><span class="n">gotL</span></code> dataset.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Select unsuccessful households from allHHc</span><span class="w">
</span><span class="n">loan_no</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"denied"</span><span class="p">,</span><span class="w"> 
  </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"loan_purpose"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HH_status"</span><span class="p">))</span><span class="w">

</span><span class="c1"># Select loan purpose for successful households from gotL</span><span class="w">
</span><span class="n">loan_yes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">gotL</span><span class="p">,</span><span class="w"> </span><span class="n">gotL</span><span class="o">$</span><span class="n">got_loan</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w">
  </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"loan_purpose"</span><span class="p">)</span><span class="w">

</span><span class="n">loan_yes</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"successful"</span><span class="w">

</span><span class="c1"># Combine into one dataset</span><span class="w">
</span><span class="n">loan_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">loan_no</span><span class="p">,</span><span class="w"> </span><span class="n">loan_yes</span><span class="p">)</span><span class="w">

</span><span class="c1"># Remove the unused 'did not apply' level</span><span class="w">
</span><span class="n">loan_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">droplevels</span><span class="p">(</span><span class="n">loan_data</span><span class="p">)</span><span class="w">

</span><span class="n">kable</span><span class="p">(</span><span class="n">prop.table</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="w">
  </span><span class="n">loan_data</span><span class="o">$</span><span class="n">loan_purpose</span><span class="p">,</span><span class="w"> </span><span class="n">loan_data</span><span class="o">$</span><span class="n">HH_status</span><span class="p">,</span><span class="w">
  </span><span class="n">dnn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Loan Purpose"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Loan"</span><span class="p">)),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">                                              </span><span class="n">denied</span><span class="w">   </span><span class="n">successful</span><span class="w">
</span><span class="o">-------------------------------------------</span><span class="w">  </span><span class="o">-------</span><span class="w">  </span><span class="o">-----------</span><span class="w">
</span><span class="n">Business</span><span class="w"> </span><span class="n">Start</span><span class="o">-</span><span class="n">up</span><span class="w"> </span><span class="n">Capital</span><span class="w">                      </span><span class="m">0.262</span><span class="w">        </span><span class="m">0.154</span><span class="w">
</span><span class="n">Expanding</span><span class="w"> </span><span class="n">Business</span><span class="w">                             </span><span class="m">0.138</span><span class="w">        </span><span class="m">0.081</span><span class="w">
</span><span class="n">Other</span><span class="w"> </span><span class="p">(</span><span class="n">Specify</span><span class="p">)</span><span class="w">                                </span><span class="m">0.272</span><span class="w">        </span><span class="m">0.027</span><span class="w">
</span><span class="n">Purchase</span><span class="w"> </span><span class="n">Agricultural</span><span class="w"> </span><span class="n">Inputs</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Food</span><span class="w"> </span><span class="n">Crop</span><span class="w">     </span><span class="m">0.210</span><span class="w">        </span><span class="m">0.300</span><span class="w">
</span><span class="n">Purchase</span><span class="w"> </span><span class="n">House</span><span class="o">/</span><span class="n">Lease</span><span class="w"> </span><span class="n">Land</span><span class="w">                      </span><span class="m">0.031</span><span class="w">        </span><span class="m">0.023</span><span class="w">
</span><span class="n">Purchase</span><span class="w"> </span><span class="n">Inputs</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">Crops</span><span class="w">                </span><span class="m">0.062</span><span class="w">        </span><span class="m">0.098</span><span class="w">
</span><span class="n">Purchase</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">farm</span><span class="w"> </span><span class="n">Inputs</span><span class="w">                       </span><span class="m">0.026</span><span class="w">        </span><span class="m">0.115</span><span class="w">
</span><span class="n">For</span><span class="w"> </span><span class="n">consumption</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">personal</span><span class="w"> </span><span class="n">expenses</span><span class="w">          </span><span class="m">0.000</span><span class="w">        </span><span class="m">0.201</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<ol class="text-question">
  <li>Using the information in the ‘All households’ and ‘Got loan’ tab, for ‘successful’ and ‘denied’ households:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table as shown in Figure 9.1 to compare the averages of the specified household characteristics.</li>
</ul>
<div class="figure figure-no-source" id="figure-9-1">
<div class="figure-body">
<div class="figure-md">
<table>
  <thead>
    <tr>
      <th>Household characteristic</th>
      <th>Successful</th>
      <th>Denied</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Age of household head</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Highest education in household</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Number of assets</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Household size</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Number of young children</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Number of working-age adults</td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>
</div>
<p class="description">
Characteristics of successful and denied borrowers.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.1 </span>
Characteristics of successful and denied borrowers.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
<ul class="text-sub-question">
  <li>For each characteristic, explain how it may affect a household’s ability to get a loan (<em>ceteris paribus</em>).</li>
</ul>
<dl class="definition">
<dt class="definition-term">conditional mean</dt><dd class="definition-description">An average of a variable, taken over a subgroup of observations that satisfy certain conditions, rather than all observations.</dd>
</dl>
<ul class="text-sub-question">
  <li>Looking at your table from Question 5<em>(a)</em>, discuss whether you see this pattern in the data. (For example, are successful borrowers older/younger on average than denied borrowers?)</li>
</ul>
<ul class="text-sub-question">
  <li>Now try <strong data-term="conditional mean">conditioning on</strong> the variable <code class="language-r highlighter-rouge"><span class="n">rural</span></code> or <code class="language-r highlighter-rouge"><span class="n">region</span></code> and discuss how (if at all) your results change.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-96-calculating-differences-in-household-characteristics"><strong>R walk-through 9.6</strong> Calculating differences in household characteristics</h3>
  <p>Here we show how to get average characteristics conditional on <code class="language-r highlighter-rouge"><span class="n">HH_status</span></code> using the <code class="language-r highlighter-rouge"><span class="n">mean</span></code> function. With the <code class="language-r highlighter-rouge"><span class="n">mosaic</span></code> package loaded (as we have done in <a href="#r-walk-through-92-creating-summary-tables" class="show-page-number">R walk-through 9.2</a>), we can use the conditioning symbol <code class="language-r highlighter-rouge"><span class="o">|</span></code> in the mean function to condition according to <code class="language-r highlighter-rouge"><span class="n">HH_status</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Show the number of observations in each category</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##      denied not applied  successful </span><span class="w">
</span><span class="c1">##         201        3632        1363</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Mean household size conditional on credit status</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="o">~</span><span class="n">hhsize</span><span class="o">|</span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##      denied not applied  successful </span><span class="w">
</span><span class="c1">##        4.82        4.46        4.87</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Mean max_education of household head, by credit status</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="o">~</span><span class="n">max_education</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allHHc</span><span class="p">,</span><span class="w"> 
  </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##      denied not applied  successful </span><span class="w">
</span><span class="c1">##        8.00        7.62        7.26</span><span class="w">
</span></code></pre></div>  </div>
  <p>Repeat the <code class="language-r highlighter-rouge"><span class="n">mean</span></code> command above for all variables to complete the table.</p>
  <p>If we want to repeat this analysis by also splitting the data according to <code class="language-r highlighter-rouge"><span class="n">rural</span></code> or <code class="language-r highlighter-rouge"><span class="n">region</span></code>, we can use the <code class="language-r highlighter-rouge"><span class="n">group</span></code> option (which is only available when <code class="language-r highlighter-rouge"><span class="n">mosaic</span></code> has been loaded).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Show the number of observations in each category</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">allHHc</span><span class="o">$</span><span class="n">rural</span><span class="p">,</span><span class="w"> </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                     </span><span class="w">
</span><span class="c1">##                      denied not applied successful</span><span class="w">
</span><span class="c1">##   Large town (urban)     56        1092        332</span><span class="w">
</span><span class="c1">##   Rural                 128        2236        903</span><span class="w">
</span><span class="c1">##   Small town (urban)     17         304        128</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Mean HH size, by rural and credit status variables</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="o">~</span><span class="n">hhsize</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rural</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allHHc</span><span class="p">,</span><span class="w"> 
  </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##      denied.Large town (urban) not applied.Large town (urban) </span><span class="w">
</span><span class="c1">##                           3.57                           3.44 </span><span class="w">
</span><span class="c1">##  successful.Large town (urban)                   denied.Rural </span><span class="w">
</span><span class="c1">##                           3.84                           5.47 </span><span class="w">
</span><span class="c1">##              not applied.Rural               successful.Rural </span><span class="w">
</span><span class="c1">##                           4.98                           5.35 </span><span class="w">
</span><span class="c1">##      denied.Small town (urban) not applied.Small town (urban) </span><span class="w">
</span><span class="c1">##                           4.06                           4.28 </span><span class="w">
</span><span class="c1">##  successful.Small town (urban)             Large town (urban) </span><span class="w">
</span><span class="c1">##                           4.12                           3.54 </span><span class="w">
</span><span class="c1">##                          Rural             Small town (urban) </span><span class="w">
</span><span class="c1">##                           5.10                           4.23</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Mean max_education of HH head, by rural and credit </span><span class="w">
</span><span class="c1"># status variables</span><span class="w">
</span><span class="n">mean</span><span class="p">(</span><span class="o">~</span><span class="n">working_age_adults</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rural</span><span class="p">,</span><span class="w"> 
  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##      denied.Large town (urban) not applied.Large town (urban) </span><span class="w">
</span><span class="c1">##                           2.36                           2.30 </span><span class="w">
</span><span class="c1">##  successful.Large town (urban)                   denied.Rural </span><span class="w">
</span><span class="c1">##                           2.42                           2.88 </span><span class="w">
</span><span class="c1">##              not applied.Rural               successful.Rural </span><span class="w">
</span><span class="c1">##                           2.58                           2.91 </span><span class="w">
</span><span class="c1">##      denied.Small town (urban) not applied.Small town (urban) </span><span class="w">
</span><span class="c1">##                           3.18                           2.75 </span><span class="w">
</span><span class="c1">##  successful.Small town (urban)             Large town (urban) </span><span class="w">
</span><span class="c1">##                           2.54                           2.33 </span><span class="w">
</span><span class="c1">##                          Rural             Small town (urban) </span><span class="w">
</span><span class="c1">##                           2.68                           2.71</span><span class="w">
</span></code></pre></div>  </div>
  <p>The same result can be also obtained using the piping operator (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>) from the <code class="language-r highlighter-rouge"><span class="n">tidyverse</span></code> package.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stats4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">avg_hhsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">hhsize</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">spread</span><span class="p">(</span><span class="n">HH_status</span><span class="p">,</span><span class="w"> </span><span class="n">avg_hhsize</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 11 x 4</span><span class="w">
</span><span class="c1">##    region          denied  not applied  successful</span><span class="w">
</span><span class="c1">##    &lt;fct&gt;            &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;</span><span class="w">
</span><span class="c1">##  1 Addis Ababa       2.50          4.00       3.84</span><span class="w">
</span><span class="c1">##  2 Afar              7.00          4.97       5.69</span><span class="w">
</span><span class="c1">##  3 Amhara            4.42          3.86       4.50</span><span class="w">
</span><span class="c1">##  4 Benshagul Gumuz   5.00          4.70       5.41</span><span class="w">
</span><span class="c1">##  5 Diredwa           4.57          4.04       4.28</span><span class="w">
</span><span class="c1">##  6 Gambelia          5.22          5.04       5.50</span><span class="w">
</span><span class="c1">##  7 Harari            3.75          5.02       3.74</span><span class="w">
</span><span class="c1">##  8 Oromia            4.91          4.53       5.21</span><span class="w">
</span><span class="c1">##  9 SNNP              5.20          4.88       5.09</span><span class="w">
</span><span class="c1">## 10 Somalie           4.33          5.15       5.26</span><span class="w">
</span><span class="c1">## 11 Tigray            4.62          4.01       4.78</span><span class="w">
</span></code></pre></div>  </div>
  <p>To understand what the <code class="language-r highlighter-rouge"><span class="n">spread</span></code> command does, run the above code without it and see the difference.</p>
</blockquote>
<ol class="text-question">
  <li>Using <a href="#figure-9-1" class="show-page-number">Figure 9.1</a>, without conditioning on <code class="language-r highlighter-rouge"><span class="n">rural</span></code> or <code class="language-r highlighter-rouge"><span class="n">region</span></code>:</li>
</ol>
<ul class="text-sub-question">
  <li>Calculate the difference in means (‘successful’ borrowers minus ‘denied’ borrowers).</li>
</ul>
<ul class="text-sub-question">
  <li>Calculate the 95% confidence interval for the difference in means between the two subgroups (‘successful’ minus ‘denied’). (See <a href="08-03.html#part-83-confidence-intervals-for-difference-in-the-mean" class="show-page-number">Part 8.3</a> of Empirical Project 8 for help on how to do this.)</li>
</ul>
<ul class="text-sub-question">
  <li>Plot a column chart showing the differences on the vertical axis (sorted from smallest to largest), and household characteristics on the horizontal axis. Add the confidence intervals from Question 6(<em>b</em>) to the chart.</li>
</ul>
<ul class="text-sub-question">
  <li>Interpret your findings.</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-97-calculating-confidence-intervals-and-adding-them-to-a-chart"><strong>R walk-through 9.7</strong> Calculating confidence intervals and adding them to a chart</h3>
  <p>To repeat the same set of calculations for a list of variables, we will use the piping operator (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>). First we create a list of these variables (called <code class="language-r highlighter-rouge"><span class="n">sel_var</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_var</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"age"</span><span class="p">,</span><span class="w"> </span><span class="s2">"max_education"</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_assets"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"hhsize"</span><span class="p">,</span><span class="w"> </span><span class="s2">"young_children"</span><span class="p">,</span><span class="w"> </span><span class="s2">"working_age_adults"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now we use the <code class="language-r highlighter-rouge"><span class="n">age</span></code> variable as an example.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stats5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Filters out the 'did not apply' cases</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">HH_status</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"denied"</span><span class="p">,</span><span class="w"> </span><span class="s2">"successful"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">HH_status</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">avg_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> 
    </span><span class="n">sd_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> 
    </span><span class="n">n_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">age</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
</span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 2 x 4</span><span class="w">
</span><span class="c1">##   HH_status   avg_   sd_    n_</span><span class="w">
</span><span class="c1">##   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;</span><span class="w">
</span><span class="c1">## 1 denied      41.2  12.9   201</span><span class="w">
</span><span class="c1">## 2 successful  43.4  14.3  1361</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now we use the <code class="language-r highlighter-rouge"><span class="n">t.test</span></code> function to calculate the difference between the successful group (<code class="language-r highlighter-rouge"><span class="n">sel_success</span></code>) and the denied borrowers (<code class="language-r highlighter-rouge"><span class="n">sel_denied</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Select the age variable (sel_var[1]) for successful and </span><span class="w">
</span><span class="c1"># denied borrowers</span><span class="w">
</span><span class="n">sel_success</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">allHHc</span><span class="p">[</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"successful"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">[</span><span class="m">1</span><span class="p">]])</span><span class="w">
</span><span class="n">sel_denied</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">allHHc</span><span class="p">[</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"denied"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">[</span><span class="m">1</span><span class="p">]])</span><span class="w">

</span><span class="c1"># The unlist function is needed to get data as a vector </span><span class="w">
</span><span class="c1"># instead of a dataframe/tibble.</span><span class="w">
</span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t.test</span><span class="p">(</span><span class="n">sel_success</span><span class="p">,</span><span class="w"> </span><span class="n">sel_denied</span><span class="p">,</span><span class="w"> 
  </span><span class="n">conf.level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>The output of this test provides us with the details required. Note that the <code class="language-r highlighter-rouge"><span class="n">conf.level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span></code> option is actually not necessary here, as 0.95 is the default level.</p>
  <p>We will now do this for all required variables and save the difference in means and the confidence interval values in a dataframe so we can plot this information.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create the dataframe to save the data used for the chart</span><span class="w">
</span><span class="n">temp_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sel_var</span><span class="p">,</span><span class="w"> 
  </span><span class="n">dmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">yhigh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">ylow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">sel_var</span><span class="p">){</span><span class="w">
  </span><span class="n">sel_success</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">allHHc</span><span class="p">[</span><span class="w">
    </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"successful"</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">])</span><span class="w">
  </span><span class="n">sel_denied</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="n">allHHc</span><span class="p">[</span><span class="w">
    </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"denied"</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">])</span><span class="w">
  </span><span class="n">temp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t.test</span><span class="p">(</span><span class="n">sel_success</span><span class="p">,</span><span class="w"> </span><span class="n">sel_denied</span><span class="p">,</span><span class="w"> 
    </span><span class="n">conf.level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="p">)</span><span class="w">
  </span><span class="c1"># Mean difference</span><span class="w">
  </span><span class="n">temp_plot</span><span class="o">$</span><span class="n">dmean</span><span class="p">[</span><span class="n">temp_plot</span><span class="o">$</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
    </span><span class="n">temp</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">temp</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> 
  </span><span class="c1"># Lower limit of the confidence interval</span><span class="w">
  </span><span class="n">temp_plot</span><span class="o">$</span><span class="n">ylow</span><span class="p">[</span><span class="n">temp_plot</span><span class="o">$</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">temp</span><span class="o">$</span><span class="n">conf.int</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> 
  </span><span class="c1"># Upper limit of the confidence interval</span><span class="w">
  </span><span class="n">temp_plot</span><span class="o">$</span><span class="n">yhigh</span><span class="p">[</span><span class="n">temp_plot</span><span class="o">$</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">temp</span><span class="o">$</span><span class="n">conf.int</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> 
</span><span class="p">}</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">temp_plot</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dmean</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_errorbar</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ylow</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhigh</span><span class="p">),</span><span class="w"> 
    </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Difference in means"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Variable"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Difference in HH characteristics 
    (successful and denied borrowers)"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-2">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-02.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-02.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-02.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Column chart showing difference in HH characteristics for successful and denied borrowers.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-02.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-02-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-02.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Column chart showing difference in HH characteristics for successful and denied borrowers.
" class="" />
        </a>
</div>
<p class="description">
Column chart showing difference in HH characteristics for successful and denied borrowers.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.2 </span>
Column chart showing difference in HH characteristics for successful and denied borrowers.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
</blockquote>
<ol class="text-question keep-with-next">
  <li>Using the information in the ‘All households’ dataset:</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table similar to <a href="#figure-9-1" class="show-page-number">Figure 9.1</a>, but with additional columns for discouraged borrowers and credit-constrained households.</li>
</ul>
<ul class="text-sub-question">
  <li>Compare the means across the four groups and discuss any similarities/differences you observe (you do not need to do any formal calculations).</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-98-calculating-conditional-means"><strong>R walk-through 9.8</strong> Calculating conditional means</h3>
  <p>We are interested in the means of a range of variables for different subgroups. Two subgroups are mutually exclusive (<code class="language-r highlighter-rouge"><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"successful"</span></code> and <code class="language-r highlighter-rouge"><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"denied"</span></code>), while the others ( <code class="language-r highlighter-rouge"><span class="n">credit_constrained</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"yes"</span></code> and <code class="language-r highlighter-rouge"><span class="n">discouraged_borrower</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"yes"</span></code>) are partially overlapping subgroups of the data. Our strategy is to create a temporary dataframe (<code class="language-r highlighter-rouge"><span class="n">sel_allHHc</span></code>) that only contains the relevant observations and the relevant variables. Then we can use the <code class="language-r highlighter-rouge"><span class="n">colMeans</span></code> function to calculate the required means.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># List variables we are interested in</span><span class="w">
</span><span class="n">el_var</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"age"</span><span class="p">,</span><span class="w"> </span><span class="s2">"max_education"</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_assets"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"hhsize"</span><span class="p">,</span><span class="w"> </span><span class="s2">"young_children"</span><span class="p">,</span><span class="w"> </span><span class="s2">"working_age_adults"</span><span class="p">)</span><span class="w">

</span><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="p">[</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="o">==</span><span class="s2">"successful"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">]</span><span class="w">

</span><span class="n">paste</span><span class="p">(</span><span class="s2">"successful (n = "</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">),</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "successful (n = 1363 )"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">colMeans</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                age      max_education      number_assets </span><span class="w">
</span><span class="c1">##              43.37               7.26              15.88 </span><span class="w">
</span><span class="c1">##             hhsize     young_children working_age_adults </span><span class="w">
</span><span class="c1">##               4.87               2.09               2.75</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="p">[</span><span class="n">allHHc</span><span class="o">$</span><span class="n">HH_status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"denied"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">]</span><span class="w">

</span><span class="n">paste</span><span class="p">(</span><span class="s2">"denied (n = "</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">),</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "denied (n = 201 )"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-with-next highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">colMeans</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                age      max_education      number_assets </span><span class="w">
</span><span class="c1">##              41.21               8.00              14.46 </span><span class="w">
</span><span class="c1">##             hhsize     young_children working_age_adults </span><span class="w">
</span><span class="c1">##               4.82               2.22               2.76</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="p">[</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">discouraged_borrower</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">]</span><span class="w">

</span><span class="n">paste</span><span class="p">(</span><span class="s2">"discouraged (n = "</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">),</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "discouraged (n = 588 )"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">colMeans</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                age      max_education      number_assets </span><span class="w">
</span><span class="c1">##              43.28               6.50              10.16 </span><span class="w">
</span><span class="c1">##             hhsize     young_children working_age_adults </span><span class="w">
</span><span class="c1">##               4.65               2.03               2.49</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sel_allHHc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allHHc</span><span class="p">[</span><span class="w">
  </span><span class="n">allHHc</span><span class="o">$</span><span class="n">credit_constrained</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Yes"</span><span class="p">,</span><span class="w"> </span><span class="n">sel_var</span><span class="p">]</span><span class="w">

</span><span class="n">paste</span><span class="p">(</span><span class="s2">"constrained (n = "</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">),</span><span class="w"> </span><span class="s2">")"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "constrained (n = 3012 )"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">colMeans</span><span class="p">(</span><span class="n">sel_allHHc</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                age      max_education      number_assets </span><span class="w">
</span><span class="c1">##              44.84               7.14              13.54 </span><span class="w">
</span><span class="c1">##             hhsize     young_children working_age_adults </span><span class="w">
</span><span class="c1">##               4.44               1.81               2.49</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<dl class="definition">
<dt class="definition-term">selection bias</dt><dd class="definition-description">An issue that occurs when the sample or data observed is not representative of the population of interest. For example, individuals with certain characteristics may be more likely to be part of the sample observed (such as students being more likely than CEOs to participate in computer lab experiments).</dd>
</dl>
<p>A study on <a href="https://tinyco.re/9835958" class="show-url">access to loans in Ethiopia</a> looked at the relationship between loan amount and household characteristics. When doing so, they needed to account for <strong data-term="selection bias">selection bias</strong>, because we only observe positive loan amounts for successful borrowers. If we only had data for successful borrowers, then our sample would not be representative of the population of interest (all households), so we would have to interpret our results with caution. In our case, we have information about all households, so we can compare observable characteristics to see whether successful borrowers are similar to other households.</p>
<p class="sidenote"><a href="https://tinyco.re/3225521">An article by the Institute for Work and Health</a> explains selection bias in more detail, and why it is a problem encountered by all areas of research.</p>
<ol class="text-question">
  <li>Think of another example where there might be selection bias, in other words, where the data we observe is not representative of the population of interest.</li>
</ol>
<h2 id="part-92-households-that-got-a-loan">Part 9.2 Households that got a loan</h2>
<blockquote class="box fixed">
  <h3 id="learning-objectives-for-this-part-1">Learning objectives for this part</h3>
  <ul>
    <li>analyse the characteristics of loans obtained by successful borrowers.</li>
  </ul>
</blockquote>
<p>For households that successfully got a loan, we will look at:</p>
<ul>
  <li>purpose of the loan</li>
  <li>duration of the loan(s)</li>
  <li>loan amount and interest rate charged</li>
  <li>who the household borrowed from.</li>
</ul>
<p>We will also see if there are any relationships between these loan characteristics and household characteristics.</p>
<p>Now we will use the variables relating to the loan start and end dates to calculate the duration of the loan. Before using these variables, we need to check that the variable entries make sense. Some of this information could be recorded incorrectly (for example, the year is missing a digit, or the month is a number rather than a word).</p>
<ol class="text-question">
  <li>Using the ‘Got loan’ dataset:</li>
</ol>
<ul class="text-sub-question">
  <li>Check the variables <code class="language-r highlighter-rouge"><span class="n">loan_startmonth</span></code>, <code class="language-r highlighter-rouge"><span class="n">loan_startyear</span></code>, <code class="language-r highlighter-rouge"><span class="n">loan_endmonth</span></code>, and <code class="language-r highlighter-rouge"><span class="n">loan_endyear</span></code>, and replace the entries that are recorded incorrectly with either the correct entry (if possible), or as blank (if not possible to infer the correct entry). (<em>Note:</em> Some entries are recorded as ‘Pagume’, which corresponds to early September in the Ethiopian calendar.)</li>
</ul>
<ul class="text-sub-question">
  <li>To calculate loan duration, combine the month and year variables into one date variable and format them as date variables.</li>
</ul>
<ul class="text-sub-question">
  <li>Some of the dates (months or years) are missing. Calculate the percentage of the data that is missing and explain whether you think missing data is a serious problem.</li>
</ul>
<ul class="text-sub-question">
  <li>Create a new variable containing the loan duration (end date minus start date), which will be measured in days.</li>
</ul>
<ul class="text-sub-question">
  <li>You will notice that some dates were recorded incorrectly, with the start date later than the end date. We could either treat these entries as missing or swap the start and end dates. Create two new variables for loan duration, one with all negative entries recorded as blank, and one with negative entries replaced as positive numbers.</li>
</ul>
<ul class="text-sub-question">
  <li>For this project we will define a long-term loan as lasting more than a year (365 days), which we will use in later questions. For this definition, use the <code class="language-r highlighter-rouge"><span class="n">loan_length</span></code> variable that converts negative loan lengths to positive ones (see Question 1<em>(e)</em> above). Create an indicator variable called <code class="language-r highlighter-rouge"><span class="n">long_term</span></code> that equals 1 if the loan was long term, and 0 otherwise. What percentage of loans were long term?</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-99-data-cleaning-and-summarizing-loan-characteristics"><strong>R walk-through 9.9</strong> Data cleaning and summarizing loan characteristics</h3>
  <p>We start by cleaning up the loan dates. We have information on start month and year as well as end month and year. Let’s look at these in turn. The structure of the dataframe (<code class="language-r highlighter-rouge"><span class="n">str</span><span class="p">(</span><span class="n">gotL</span><span class="p">)</span></code>) indicates that the start and end year are numeric variables, but the months are factor variables with month names (for example ‘April’).</p>
  <p>Let’s first look at the years by creating a scatterplot.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">gotL</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_endyear</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_startyear</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan start and end year"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-3">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-03.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-03.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-03.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot showing loan start and end year.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-03.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-03-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-03.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot showing loan start and end year.
" class="" />
        </a>
</div>
<p class="description">
Scatterplot showing loan start and end year.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.3 </span>
Scatterplot showing loan start and end year.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>We can see that there are three observations that have very low (&lt; 500) start or end year values, which does not make sense. We will replace these with ‘NA’, but leave the original data untouched and create a new dataset called <code class="language-r highlighter-rouge"><span class="n">gotLc</span></code>, where the ‘c’ indicates cleaned data.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotL</span><span class="w">

</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startyear</span><span class="p">[</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startyear</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">500</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">
</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endyear</span><span class="p">[</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endyear</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">500</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_endyear</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_startyear</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan start and end year"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-4">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-04.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-04.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-04.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Revised scatterplot showing loan start and end year without outliers.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-04.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-04-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-04.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Revised scatterplot showing loan start and end year without outliers.
" class="" />
        </a>
</div>
<p class="description">
Revised scatterplot showing loan start and end year without outliers.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.4 </span>
Revised scatterplot showing loan start and end year without outliers.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>In the top left corner, there is a loan with the start year (2006) after the end year (2003). Clearly this is incorrect, so we should remove this observation when analysing loan periods. However, we wait until we have combined the years with the months as there may be more observations with this issue.</p>
  <p>Also, we can only see a small number of points because there are many identical observations (for example <code class="language-r highlighter-rouge"><span class="n">startyear</span></code> of 2006 and <code class="language-r highlighter-rouge"><span class="n">endyear</span></code> of 2006). To see these points you could replace<code class="language-r highlighter-rouge"><span class="n">geom_point</span></code> with <code class="language-r highlighter-rouge"><span class="n">geom_jitter</span></code> in the command above <code class="language-r highlighter-rouge"><span class="n">ggplot</span></code> command . Use <code class="language-r highlighter-rouge"><span class="o">?</span><span class="n">geom_jitter</span></code> to understand what this option does.</p>
  <p>Now let’s look at the values in <code class="language-r highlighter-rouge"><span class="n">start_month</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startmonth</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##     April    August  December  February   January      July      June </span><span class="w">
</span><span class="c1">##        95        63       133       145       176       115       156 </span><span class="w">
</span><span class="c1">##     March       May  November   October September      NA's </span><span class="w">
</span><span class="c1">##        85       141       115       106       146         4</span><span class="w">
</span></code></pre></div>  </div>
  <p>There is no particular issue with the start months. What about the end months?</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">summary</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endmonth</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##     April    August  December  February   January      July      June </span><span class="w">
</span><span class="c1">##       136        53        49       170        52        34        94 </span><span class="w">
</span><span class="c1">##     March       May  November   October    Pagume September      NA's </span><span class="w">
</span><span class="c1">##       155        89        33        39         5        37       534</span><span class="w">
</span></code></pre></div>  </div>
  <p>Two things are noteworthy here: there are now many ‘NA’ entries, and there is an entry called ‘Pagume’. As described in the task, ‘Pagume’ can be approximated by September. Let’s recode that.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endmonth</span><span class="p">[</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endmonth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Pagume"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">
  </span><span class="s2">"September"</span><span class="w">
</span></code></pre></div>  </div>
  <p>Another call of <code class="language-r highlighter-rouge"><span class="n">summary</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endmonth</span><span class="p">)</span></code> would confirm that there are no observations with ‘Pagume’ left.</p>
  <p>Now we want to calculate the length of the loan, in other words, the number of days between start and end day. As we only have months and not days, this will be an approximation. We will create a new variable combining months and years using the <code class="language-r highlighter-rouge"><span class="n">paste</span></code> function, assuming that all loan start and end dates are on the first day of each month.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># We assume that all loan start and end dates are on the </span><span class="w">
</span><span class="c1"># 1st of the month.</span><span class="w">
</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"1"</span><span class="p">,</span><span class="w">
 </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startmonth</span><span class="p">,</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startyear</span><span class="p">)</span><span class="w">
</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"1"</span><span class="p">,</span><span class="w">
 </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endmonth</span><span class="p">,</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_endyear</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>For observations with an unknown end date (recall we had more than 500 of these), we will code as missing. Currently these are recorded as ‘1 NA NA’. First we need to find which observations have missing data elements for either the <code class="language-r highlighter-rouge"><span class="n">loan_startdate</span></code> or <code class="language-r highlighter-rouge"><span class="n">loan_enddate</span></code> variable. R has very powerful tools to identify text patterns such as this, which you can learn about by searching the Internet for help (you could search for ‘R test whether character contains string’). For example, a useful <a href="https://tinyco.re/6886629" class="show-url">short introduction</a> to using such tools contains one solution to our problem.</p>
  <p class="keep-with-next">See the first 20 observations of <code class="language-r highlighter-rouge"><span class="n">loan_enddate</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##  [1] "1 NA NA"          "1 NA NA"          "1 June 2006"     </span><span class="w">
</span><span class="c1">##  [4] "1 March 2006"     "1 February 2006"  "1 September 2007"</span><span class="w">
</span><span class="c1">##  [7] "1 March 2006"     "1 March 2006"     "1 March 2006"    </span><span class="w">
</span><span class="c1">## [10] "1 March 2006"     "1 February 2006"  "1 NA NA"         </span><span class="w">
</span><span class="c1">## [13] "1 August 2007"    "1 August 2007"    "1 February 2006" </span><span class="w">
</span><span class="c1">## [16] "1 June 2007"      "1 November 2007"  "1 March 2006"    </span><span class="w">
</span><span class="c1">## [19] "1 April 2006"     "1 NA NA"</span><span class="w">
</span></code></pre></div>  </div>
  <p>You can find NAs in observations 1, 2, 12, and 20. The command <code class="language-r highlighter-rouge"><span class="n">grep</span></code> will identify these rows automatically.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Identify the position of the observations that contain </span><span class="w">
</span><span class="c1"># NAs</span><span class="w">
</span><span class="n">selNA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s1">'NA'</span><span class="p">,</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">)</span><span class="w">
</span><span class="n">selNA</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1]  1  2 12 20 26</span><span class="w">
</span></code></pre></div>  </div>
  <p>As you can see, <code class="language-r highlighter-rouge"><span class="n">grep</span></code> identifies the first four instances correctly, and we can see that the next missing end date is in observation 26. Now we will replace all these observations as missing values and then convert the non-missing observations to dates, using the <code class="language-r highlighter-rouge"><span class="n">as.Date</span></code> function.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">[</span><span class="n">selNA</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">

</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">,</span><span class="w"> 
  </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%d %B %Y"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>The option <code class="language-r highlighter-rouge"><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%d %B %Y"</span></code> specifies the format that dates are recorded as (for example ‘1 June 2006’), where <code class="language-r highlighter-rouge"><span class="o">%</span><span class="n">B</span></code> stands for full months (view <a href="https://tinyco.re/7793931" class="show-url">this page</a> for examples of other date formatting options). Now we repeat the same steps for the start date.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Identify the position of the observations that contain </span><span class="w">
</span><span class="c1"># NAs</span><span class="w">
</span><span class="n">selNA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grep</span><span class="p">(</span><span class="s1">'NA'</span><span class="p">,</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="p">)</span><span class="w">

</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="p">[</span><span class="n">selNA</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">

</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="p">,</span><span class="w"> 
  </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"%d %B %Y"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Let’s use the <code class="language-r highlighter-rouge"><span class="n">is.na</span></code> function to find out the percentage of observations with missing values for start and/or end date. Here, we used the <code class="language-r highlighter-rouge"><span class="n">paste</span></code> function to print the output as both a number and a percentage.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Missing start dates</span><span class="w">
</span><span class="n">paste</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="p">)),</span><span class="w"> </span><span class="s2">"("</span><span class="p">,</span><span class="w">
  </span><span class="m">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="p">)),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s2">"% )"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "6 ( 0.41 % )"</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Missing end dates</span><span class="w">
</span><span class="n">paste</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">)),</span><span class="w"> </span><span class="s2">"("</span><span class="p">,</span><span class="w">
  </span><span class="m">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="p">)),</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="s2">"% )"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "535 ( 36.15 % )"</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now we will add a new variable indicating the length of the loan period. As R knows that <code class="language-r highlighter-rouge"><span class="n">loan_startdate</span></code> and <code class="language-r highlighter-rouge"><span class="n">loan_enddate</span></code> are dates, it recognizes automatically that the difference between two dates should be expressed as the number of days.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_enddate</span><span class="o">-</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_startdate</span><span class="w">
</span></code></pre></div>  </div>
  <p>Let’s look at the first few observations.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"loan_startdate"</span><span class="p">,</span><span class="w">
 </span><span class="s2">"loan_enddate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"loan_length"</span><span class="p">)]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 5 x 3</span><span class="w">
</span><span class="c1">##   loan_startdate loan_enddate loan_length</span><span class="w">
</span><span class="c1">##   &lt;date&gt;         &lt;date&gt;       &lt;time&gt;     </span><span class="w">
</span><span class="c1">## 1 2004-03-01     NA           &lt;NA&gt;       </span><span class="w">
</span><span class="c1">## 2 2006-11-01     NA           &lt;NA&gt;       </span><span class="w">
</span><span class="c1">## 3 2006-11-01     2006-06-01   -153       </span><span class="w">
</span><span class="c1">## 4 2005-06-01     2006-03-01   273        </span><span class="w">
</span><span class="c1">## 5 2005-06-01     2006-02-01   245</span><span class="w">
</span></code></pre></div>  </div>
  <p>Notice the following:</p>
  <ul>
    <li>Where any of the two dates is missing, the length is missing as well.</li>
    <li>Some loan lengths are negative (for example observation 3), because the recorded end date is before the start date. It could be that the two dates were switched when the data was entered into the system.</li>
  </ul>
  <p>This is unfortunate, but is a common feature of real-life data, and you will have to be on the lookout for such occasions.</p>
  <p>As required in Question 1, we will create two variants of the <code class="language-r highlighter-rouge"><span class="n">loan_length</span></code> variable: one where we assign missing values to all observations that have negative <code class="language-r highlighter-rouge"><span class="n">loan_length</span></code>, and one where we assume that the problem was the switching of start and end date, so we transform all loan lengths to positive values.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length_NA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length</span><span class="w">

</span><span class="c1"># Assign NA to negative loan lengths</span><span class="w">
</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length_NA</span><span class="p">[</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length_NA</span><span class="o">&lt;</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span><span class="w">

</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length_abs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now we can create the <code class="language-r highlighter-rouge"><span class="n">long_term</span></code> variable and look at the number of long-term loans.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">long_term</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_length_abs</span><span class="o">&gt;</span><span class="m">365</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">long_term</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##    Mode   FALSE    TRUE    NA's </span><span class="w">
</span><span class="c1">## logical     728     215     537</span><span class="w">
</span></code></pre></div>  </div>
  <p>We therefore have about 23% long-term loans (only looking at loans for which we do have date information).</p>
</blockquote>
<ol class="text-question keep-with-next">
  <li>Using the variables <code class="language-r highlighter-rouge"><span class="n">loan_amount</span></code> and <code class="language-r highlighter-rouge"><span class="n">loan_interest</span></code>:</li>
</ol>
<ul class="text-sub-question keep-together">
  <li>Create summary tables to summarize the distribution of loan amount (mean, standard deviation, maximum, and minimum): one using the loan amount, the other using the total amount to repay (loan amount + interest). Make sure to exclude the one observation previously identified as having an extremely high interest rate. Remember to give your tables meaningful titles. Describe any features of the data that you find interesting.</li>
</ul>
<ul class="text-sub-question">
  <li>As mentioned earlier, the interest rate is a borrowing condition that can vary widely across households. Here we will take the interest rate to be the interest paid as a percentage of the loan amount. Calculate the interest rate for each loan in the data. (Exclude observations where the interest paid is not recorded.)</li>
</ul>
<ul class="text-sub-question">
  <li>Check for extreme values (interest rates that are either very large or zero). You may also want to create a scatterplot (with interest rate on the vertical axis and loan amount on the horizontal axis) to help you identify extreme (atypical) observations. Exclude the observation with the most extreme interest rate from further calculations. What percentage of the loans are zero interest?</li>
</ul>
<ul class="text-sub-question">
  <li>Make summary tables of the mean, maximum, minimum, and quartiles of the loan amount and interest rate, calculating these measures separately for long-term and short-term loans. Compare the distributions of interest rates for short-term and long-term loans.</li>
</ul>
<ul class="text-sub-question">
  <li>Create a table showing the correlation between the interest rate and household characteristics (you may want to refer to <a href="08-03.html#figure-8-4" class="show-page-number">Figure 8.4</a> in Empirical Project 8 for an example). Interpreting the interest rate charged as a measure of default risk (inability to repay), explain whether the relationships implied by the coefficients are what you expected (for example, would you expect interest rates to be higher for households with less assets, more dependents, etc.).</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-910-making-summary-tables-and-calculating-correlations"><strong>R walk-through 9.10</strong> Making summary tables and calculating correlations</h3>
  <p>To make summary tables, we use the <code class="language-r highlighter-rouge"><span class="n">favstats</span></code> function from the <code class="language-r highlighter-rouge"><span class="n">mosaic</span></code> package.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># loan_amount</span><span class="w">
</span><span class="n">favstats</span><span class="p">(</span><span class="o">~</span><span class="n">loan_amount</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gotLc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##  min  Q1 median   Q3   max  mean     sd    n missing</span><span class="w">
</span><span class="c1">##    1 400   1200 3490 3e+07 26896 783587 1479       1</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># loan_amount + loan_interest</span><span class="w">
</span><span class="n">favstats</span><span class="p">(</span><span class="o">~</span><span class="p">(</span><span class="n">loan_amount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">loan_interest</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gotLc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##  min  Q1 median   Q3      max  mean     sd    n missing</span><span class="w">
</span><span class="c1">##   20 500   1400 3780 31260000 29223 827144 1445      35</span><span class="w">
</span></code></pre></div>  </div>
  <p>It is best to look at loan amounts and interest rate graphically, for example in a scatterplot.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_amount</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_interest</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan amounts and interest payments"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-5">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-05.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-05.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-05.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot showing loan amounts and interest payments.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-05.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-05-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-05.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot showing loan amounts and interest payments.
" class="" />
        </a>
</div>
<p class="description">
Scatterplot showing loan amounts and interest payments.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.5 </span>
Scatterplot showing loan amounts and interest payments.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>One large loan (top right corner) dominates this graph. Let’s exclude observations with a loan amount larger than 200,000 from the graph.</p>
  <div class="language-r keep-together highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_amount</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_interest</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># Set horizontal axis limits</span><span class="w">
  </span><span class="n">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">200000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># Set vertical axis limits</span><span class="w">
  </span><span class="n">ylim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">30000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan amounts and interest payments"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-6">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-06.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-06.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-06.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Revised scatterplot showing loan amounts and interest payments without outliers.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-06.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-06-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-06.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Revised scatterplot showing loan amounts and interest payments without outliers.
" class="" />
        </a>
</div>
<p class="description">
Revised scatterplot showing loan amounts and interest payments without outliers.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.6 </span>
Revised scatterplot showing loan amounts and interest payments without outliers.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>Interestingly we can see many zero interest loans. Now we will calculate the interest rate as <code class="language-r highlighter-rouge"><span class="n">loan_interest</span></code>/<code class="language-r highlighter-rouge"><span class="n">loan_amount</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="o">$</span><span class="n">interest_rate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> 
  </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_interest</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">loan_amount</span><span class="w">

</span><span class="n">favstats</span><span class="p">(</span><span class="o">~</span><span class="n">interest_rate</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gotLc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##  min Q1 median    Q3 max  mean   sd    n missing</span><span class="w">
</span><span class="c1">##    0  0      0 0.167 200 0.257 5.26 1445      35</span><span class="w">
</span></code></pre></div>  </div>
  <p>The maximum interest rate is 200 (in other words 20,000%), which does not make sense and could be due to a data entry error. Making another scatterplot can also identify extreme values for loan amounts.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_amount</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interest_rate</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan amounts and interest rates"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-7">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-07.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-07.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot identifying extreme values for loan amounts.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-07.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-07-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-07.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot identifying extreme values for loan amounts.
" class="" />
        </a>
</div>
<p class="description">
Scatterplot identifying extreme values for loan amounts.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.7 </span>
Scatterplot identifying extreme values for loan amounts.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>Let’s make another scatterplot, excluding the observation with the extremely high interest rate and only looking at small loan amounts (&lt; 1,000).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">subset</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">interest_rate</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">50</span><span class="p">),</span><span class="w"> 
  </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loan_amount</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">interest_rate</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">23</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># Set horizontal axis limits</span><span class="w">
  </span><span class="n">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># Set vertical axis limits</span><span class="w">
  </span><span class="n">ylim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Loan amount and interest rates"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="figure figure-no-source" id="figure-9-8">
<div class="figure-body">
<div class="figure-images contains-1">
        <a href="https://core-econ.org/doing-economics/book/images/web/r-figure-09-08.jpg" class="figure-image-link">
                <noscript>
                    <img src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-08.jpg" srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-320.jpg 320w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-640.jpg 640w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-1024.jpg 1024w,
                                    https://core-econ.org/doing-economics/book/images/web/r-figure-09-08.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot excluding extremely high interest rate and including only small loan amounts.
" class="" />
                </noscript>
                <img data-src="https://core-econ.org/doing-economics/book/images/web/r-figure-09-08.jpg" data-srcset="https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-320.jpg 320w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-640.jpg 640w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-08-1024.jpg 1024w,
                                     https://core-econ.org/doing-economics/book/images/web/r-figure-09-08.jpg 1280w" sizes="(min-width: 600px) 1300px, 100vw" alt="Scatterplot excluding extremely high interest rate and including only small loan amounts.
" class="" />
        </a>
</div>
<p class="description">
Scatterplot excluding extremely high interest rate and including only small loan amounts.
</p>
<p class="caption">
<span class="figure-reference">Figure 9.8 </span>
Scatterplot excluding extremely high interest rate and including only small loan amounts.
        <span class="figure-download">
        </span>
</p>
</div><!--.figure-body-->
</div>
  <p>Again we can see that there are many zero interest loans. From the summary statistics above, we can see that the median interest rate is 0, which implies that at least 50% of loans have a zero interest rate. The following code calculates that percentage precisely.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp_all</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">interest_rate</span><span class="p">[</span><span class="w">
  </span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">interest_rate</span><span class="p">)]</span><span class="w">

</span><span class="n">temp_0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">temp_all</span><span class="p">[</span><span class="n">temp_all</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w">

</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Percentage of zero interest rate loans: "</span><span class="p">,</span><span class="w"> 
  </span><span class="nf">round</span><span class="p">(</span><span class="m">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">temp_0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">temp_all</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> 
  </span><span class="s2">"%"</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## [1] "Percentage of zero interest rate loans: 50.52 %"</span><span class="w">
</span></code></pre></div>  </div>
  <p>Now let’s calculate statistics conditional on whether a loan is long term or not. Before we do this, we will remove the observation with the very extreme interest rate (20,000%) from our ‘gotLc’ dataset (but not from the original ‘gotL’ dataset). That observation has a loan amount of 1 and an interest payment of 200, which is probably a data entry mistake. There is another extreme observation (with a loan amount of 30,000,000), but there is no indication that this observation is misrecorded as there is a significant interest payment for this loan.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">gotLc</span><span class="p">,</span><span class="w"> </span><span class="n">interest_rate</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">200</span><span class="p">)</span><span class="w">

</span><span class="n">favstats</span><span class="p">(</span><span class="o">~</span><span class="n">interest_rate</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">long_term</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gotLc</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##   long_term min Q1 median    Q3  max  mean    sd   n missing</span><span class="w">
</span><span class="c1">## 1     FALSE   0  0  0.050 0.171 1.12 0.110 0.173 717       0</span><span class="w">
</span><span class="c1">## 2      TRUE   0  0  0.141 0.245 2.24 0.189 0.268 211       0</span><span class="w">
</span></code></pre></div>  </div>
  <p>Both the mean and median interest rate are higher for long-term loans. You can adapt the code above to calculate statistics for the <code class="language-r highlighter-rouge"><span class="n">loan_amount</span></code> variable.</p>
  <p>We now calculate correlations between interest rates and household characteristics. Below we use piping operations (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>) to select the relevant data (as in Project 8). We store the correlation coefficients in a matrix (array of rows and columns) called <code class="language-r highlighter-rouge"><span class="n">M</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gotLc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Only select observations with interest rate information</span><span class="w">
  </span><span class="n">subset</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">interest_rate</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">max_education</span><span class="p">,</span><span class="w"> </span><span class="n">number_assets</span><span class="p">,</span><span class="w"> </span><span class="n">hhsize</span><span class="p">,</span><span class="w"> 
    </span><span class="n">young_children</span><span class="p">,</span><span class="w"> </span><span class="n">working_age_adults</span><span class="p">,</span><span class="w"> </span><span class="n">interest_rate</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">cor</span><span class="p">(</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"pairwise.complete.obs"</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">M</span><span class="w">

</span><span class="n">M</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"interest_rate"</span><span class="p">)]</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                age      max_education      number_assets </span><span class="w">
</span><span class="c1">##             0.0258            -0.0841            -0.0474 </span><span class="w">
</span><span class="c1">##             hhsize     young_children working_age_adults </span><span class="w">
</span><span class="c1">##             0.1050             0.1022             0.0466 </span><span class="w">
</span><span class="c1">##      interest_rate </span><span class="w">
</span><span class="c1">##             1.0000</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<ol class="text-question keep-with-next">
  <li>Now we will look at sources of finance and how they are related to loan characteristics.</li>
</ol>
<ul class="text-sub-question">
  <li>Create a table showing the proportion of loans (in terms of the column variable) with source of finance (<code class="language-r highlighter-rouge"><span class="n">borrowed_from</span></code>) as the row variable and <code class="language-r highlighter-rouge"><span class="n">rural</span></code> as the column variable. Make a similar table but with <code class="language-r highlighter-rouge"><span class="n">borrowed_from_other</span></code> as the row variable instead. Does it look like rural households use different sources of finance from urban households? (<em>Hint:</em> It may help to think about sources of finance in terms of formal, informal, and other institutions such as microfinancers or NGOs.)</li>
</ul>
<ul class="text-sub-question">
  <li>
    <p>For each of the variables below, create a table showing the average of that variable, with <code class="language-r highlighter-rouge"><span class="n">borrowed_from</span></code> as the row variable and <code class="language-r highlighter-rouge"><span class="n">rural</span></code> as the column variable. Comment on any similarities or differences between rows and columns that you find interesting, and suggest explanations for what you observe.</p>
    <ul>
      <li>duration of loan (using the variable in which negative durations were transformed to positive durations)</li>
      <li>loan amount</li>
      <li>interest rate</li>
    </ul>
  </li>
</ul>
<ul class="text-sub-question">
  <li>Create a table showing the proportion of <code class="language-r highlighter-rouge"><span class="n">gender</span></code> (in terms of the row variable) with <code class="language-r highlighter-rouge"><span class="n">borrowed_from</span></code> as the row variable and <code class="language-r highlighter-rouge"><span class="n">rural</span></code> as the column variable. Describe any relationships you observe between the gender of household head, the place where he/she lives, and the types of finance used.</li>
</ul>
<ul class="text-sub-question">
  <li>What other variables are currently not in our dataset but could also be important for our analysis in Questions 2 and 3?</li>
</ul>
<blockquote class="expandable-box">
  <h3 id="r-walk-through-911-creating-summary-tables-of-means"><strong>R walk-through 9.11</strong> Creating summary tables of means</h3>
  <p>First we use the <code class="language-r highlighter-rouge"><span class="n">table</span></code> function to create the table with the variable <code class="language-r highlighter-rouge"><span class="n">borrowed_from</span></code>.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">stab10</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">gotLc</span><span class="o">$</span><span class="n">borrowed_from</span><span class="p">,</span><span class="w"> </span><span class="n">gotLc</span><span class="o">$</span><span class="n">rural</span><span class="p">)</span><span class="w">

</span><span class="n">addmargins</span><span class="p">(</span><span class="n">prop.table</span><span class="p">(</span><span class="n">stab10</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##                           </span><span class="w">
</span><span class="c1">##                            Large town (urban)   Rural Small town (urban)</span><span class="w">
</span><span class="c1">##   Bank (commercial)                   0.01881 0.00393            0.00000</span><span class="w">
</span><span class="c1">##   Employer                            0.04075 0.00196            0.01031</span><span class="w">
</span><span class="c1">##   Grocery/Local Merchant              0.08150 0.04711            0.10309</span><span class="w">
</span><span class="c1">##   Microfinance Institution            0.19122 0.27969            0.26804</span><span class="w">
</span><span class="c1">##   Money Lender (Katapila)             0.00313 0.04809            0.02062</span><span class="w">
</span><span class="c1">##   NGO                                 0.01254 0.04711            0.05155</span><span class="w">
</span><span class="c1">##   Neighbour                           0.10658 0.11580            0.07216</span><span class="w">
</span><span class="c1">##   Other (specify)                     0.05643 0.12071            0.04124</span><span class="w">
</span><span class="c1">##   Relative                            0.48589 0.31501            0.43299</span><span class="w">
</span><span class="c1">##   Religious Institution               0.00313 0.02061            0.00000</span><span class="w">
</span><span class="c1">##   Sum                                 1.00000 1.00000            1.00000</span><span class="w">
</span></code></pre></div>  </div>
  <p>Note that in all settings, most loans come from relatives. To create the table with <code class="language-r highlighter-rouge"><span class="n">borrowed_from_other</span></code>, substitute this variable name in the above command.</p>
  <p>When creating a table with categorical (factor) variables in the rows and columns, but with the cells reporting a statistic based on a third variable such as the average duration of a loan (rather than counts or proportions), we use piping operations (<code class="language-r highlighter-rouge"><span class="o">%&gt;%</span></code>).</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tab10</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotLc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">borrowed_from</span><span class="p">,</span><span class="w"> </span><span class="n">rural</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">mean_duration</span><span class="w"> </span><span class="o">=</span><span class="w"> 
    </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">loan_length_abs</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">rural</span><span class="p">,</span><span class="w"> </span><span class="n">mean_duration</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 11 x 4</span><span class="w">
</span><span class="c1">## # Groups:   borrowed_from [11]</span><span class="w">
</span><span class="c1">##    borrowed_from            `Large town (urban)` Rural  `Small town (urba~</span><span class="w">
</span><span class="c1">##    &lt;fct&gt;                    &lt;time&gt;               &lt;time&gt; &lt;time&gt;            </span><span class="w">
</span><span class="c1">##  1 Bank (commercial)        1814                 619    &lt;NA&gt;              </span><span class="w">
</span><span class="c1">##  2 Employer                 602                  290    NaN               </span><span class="w">
</span><span class="c1">##  3 Grocery/Local Merchant   166                  259    176               </span><span class="w">
</span><span class="c1">##  4 Microfinance Institution 712                  411    510               </span><span class="w">
</span><span class="c1">##  5 Money Lender (Katapila)  365                  332    365               </span><span class="w">
</span><span class="c1">##  6 Neighbour                125                  187    296               </span><span class="w">
</span><span class="c1">##  7 NGO                      372                  395    236               </span><span class="w">
</span><span class="c1">##  8 Other (specify)          274                  372    806               </span><span class="w">
</span><span class="c1">##  9 Relative                 237                  217    393               </span><span class="w">
</span><span class="c1">## 10 Religious Institution    1461                 343    &lt;NA&gt;              </span><span class="w">
</span><span class="c1">## 11 &lt;NA&gt;                     1096                 289    151</span><span class="w">
</span></code></pre></div>  </div>
  <p>To get the tables for the loan amount and interest rate, change the variable name in the <code class="language-r highlighter-rouge"><span class="n">mean</span><span class="p">()</span></code> calculation above.</p>
  <blockquote class="box fixed">
    <h3 id="extension">Extension</h3>
    <p>Investigating sources of finance associated with zero interest loans</p>
    <p>We previously saw that a large percentage of loans have a zero interest rate. Here we investigate whether particular sources of finance are responsible for these interest rates. The code we use is very similar to the code above, but instead of calculating the mean of a variable, we calculate the mean of a boolean (true/false) variable (<code class="language-r highlighter-rouge"><span class="p">(</span><span class="n">interest_rate</span><span class="o">==</span><span class="m">0</span><span class="p">)</span></code>). This will deliver the proportion of ‘true’ observations, in other words, loans where the interest rate was equal to zero.</p>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tab10</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotLc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">borrowed_from</span><span class="p">,</span><span class="w"> </span><span class="n">rural</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">prop_0_interest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">((</span><span class="n">interest_rate</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w">
    </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">rural</span><span class="p">,</span><span class="w"> </span><span class="n">prop_0_interest</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>    </div>
    <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 11 x 4</span><span class="w">
</span><span class="c1">## # Groups:   borrowed_from [11]</span><span class="w">
</span><span class="c1">##    borrowed_from            `Large town (urban)`  Rural `Small town (urba~</span><span class="w">
</span><span class="c1">##    &lt;fct&gt;                                   &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;</span><span class="w">
</span><span class="c1">##  1 Bank (commercial)                      0.     0.                NA     </span><span class="w">
</span><span class="c1">##  2 Employer                               0.692  0.500              1.00  </span><span class="w">
</span><span class="c1">##  3 Grocery/Local Merchant                 1.00   0.812              1.00  </span><span class="w">
</span><span class="c1">##  4 Microfinance Institution               0.0820 0.0351             0.0385</span><span class="w">
</span><span class="c1">##  5 Money Lender (Katapila)                0.     0.0204             0.500 </span><span class="w">
</span><span class="c1">##  6 NGO                                    0.250  0.0833             0.400 </span><span class="w">
</span><span class="c1">##  7 Neighbour                              1.00   0.763              1.00  </span><span class="w">
</span><span class="c1">##  8 Other (specify)                        0.222  0.171              0.    </span><span class="w">
</span><span class="c1">##  9 Relative                               0.961  0.819              0.976 </span><span class="w">
</span><span class="c1">## 10 Religious Institution                  1.00   0.190             NA     </span><span class="w">
</span><span class="c1">## 11 &lt;NA&gt;                                   0.     0.571              1.00</span><span class="w">
</span></code></pre></div>    </div>
  </blockquote>
  <p>You can see that in both urban and rural settings, a high proportion of loans granted by local merchants, neighbours, and relatives are zero interest (possibly because these people have a close relationship with the borrower so there is a lower chance of default).</p>
  <p>We will use exactly the same technique to determine the proportion of loans that go to households with female heads.</p>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tab11</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gotLc</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">borrowed_from</span><span class="p">,</span><span class="w"> </span><span class="n">rural</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">prop_female</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">((</span><span class="n">gender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Female"</span><span class="p">),</span><span class="w">
    </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">rural</span><span class="p">,</span><span class="w"> </span><span class="n">prop_female</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">print</span><span class="p">()</span><span class="w">
</span></code></pre></div>  </div>
  <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## # A tibble: 11 x 4</span><span class="w">
</span><span class="c1">## # Groups:   borrowed_from [11]</span><span class="w">
</span><span class="c1">##    borrowed_from            `Large town (urban)` Rural `Small town (urban~</span><span class="w">
</span><span class="c1">##    &lt;fct&gt;                                   &lt;dbl&gt; &lt;dbl&gt;               &lt;dbl&gt;</span><span class="w">
</span><span class="c1">##  1 Bank (commercial)                       0.    0.500              NA    </span><span class="w">
</span><span class="c1">##  2 Employer                                0.308 0.                  0.   </span><span class="w">
</span><span class="c1">##  3 Grocery/Local Merchant                  0.385 0.188               0.500</span><span class="w">
</span><span class="c1">##  4 Microfinance Institution                0.410 0.130               0.308</span><span class="w">
</span><span class="c1">##  5 Money Lender (Katapila)                 0.    0.265               0.500</span><span class="w">
</span><span class="c1">##  6 NGO                                     0.250 0.312               0.200</span><span class="w">
</span><span class="c1">##  7 Neighbour                               0.353 0.254               0.429</span><span class="w">
</span><span class="c1">##  8 Other (specify)                         0.389 0.187               0.250</span><span class="w">
</span><span class="c1">##  9 Relative                                0.400 0.206               0.286</span><span class="w">
</span><span class="c1">## 10 Religious Institution                   1.00  0.238              NA    </span><span class="w">
</span><span class="c1">## 11 &lt;NA&gt;                                    1.00  0.429               1.00</span><span class="w">
</span></code></pre></div>  </div>
</blockquote>
<ol class="text-question">
  <li>In this project we have looked at patterns in borrowing and access to credit, but we are not able to make any causal statements such as ‘changes in <em>X</em> will cause households to be credit constrained’ or ‘characteristic <em>Y</em> causes improved access to credit’. Outline a policy intervention that could help improve households’ access to loans, and how to design the implementation so you can assess the causal effects of this policy.</li>
</ol>
	</div><!--#content-->
    <div id="nav" class="non-printing">
            <h2>Doing Economics</h2>
            <div class="search">
<form class="search" action="../../search.html" method="get">
  <label for="search-box"></label>
  <input type="text" id="search-box" class="search-box" name="query" placeholder="Search">
  <input id="search-language" type="hidden" name="lang" value="en">
</form>
            </div><!--.search-->
            <div class="nav-list">
                    <ol class="nav-series-home">
                        <li><a href="../../index.html">Home</a></li>
                    </ol>
    <ol>
        <li class="
        no-children
        ">
            <a href="0-3-contents.html#contents"
               class="">
                Table of contents
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-4-preface.html#preface"
               class="">
                Preface
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-5-note-to-instructors.html#a-note-to-instructors"
               class="">
                A note to instructors
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-6-contributors.html#producing-doing-economics"
               class="">
                Producing <em>Doing Economics</em>
            </a>
        </li>
        <li class="
        no-children
        toc-frontmatter">
            <a href="0-7-resources.html#resources"
               class="">
                List of resources
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                1—Measuring climate change
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-02.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-02.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-02.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-11-the-behaviour-of-average-surface-temperature-over-time"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-03.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-05.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-05.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-05.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="01-04.html"
               class="">
                Part 1.1 The behaviour of average surface temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-04.html#part-12-variation-in-temperature-over-time"
               class="">
                Part 1.2 Variation in temperature over time
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="01-04.html#part-13-carbon-emissions-and-the-environment"
               class="">
                Part 1.3 Carbon emissions and the environment
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                2—Collecting and analysing data from experiments
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-02.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-02.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-02.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-21-collecting-data-by-playing-a-public-goods-game"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-03.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-05.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-05.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-05.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="02-04.html"
               class="">
                Part 2.1 Collecting data by playing a public goods game
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-04.html#part-22-describing-the-data"
               class="">
                Part 2.2 Describing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="02-04.html#part-23-did-changing-the-rules-of-the-game-affect-behaviour"
               class="">
                Part 2.3 Did changing the rules of the game affect behaviour?
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                3—Measuring the effect of a sugar tax
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-02.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-02.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-03.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-03.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-05.html#part-31-before-and-after-comparisons-of-retail-prices"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-05.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="03-04.html"
               class="">
                Part 3.1 Before-and-after comparisons of retail prices
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="03-04.html#part-32-before-and-after-comparisons-with-prices-in-other-areas"
               class="">
                Part 3.2 Before-and-after comparisons with prices in other areas
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                4—Measuring wellbeing
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-02.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-02.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-03.html"
               class="">
                R-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#getting-started-in-r"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-03.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-05.html#part-41-gdp-and-its-components-as-a-measure-of-material-wellbeing"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-05.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="04-04.html"
               class="">
                Part 4.1 GDP and its components as a measure of material wellbeing
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="04-04.html#part-42-the-hdi-as-a-measure-of-wellbeing"
               class="">
                Part 4.2 The HDI as a measure of wellbeing
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                5—Measuring inequality: Lorenz curves and Gini coefficients
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-02.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-02.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-03.html"
               class="">
                R-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#getting-started-in-r"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#part-51-measuring-income-inequality"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-03.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        has-children
        ">
            <a href="05-05.html#empirical-project-5-working-in-google-sheets"
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-05.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-05.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="05-04.html"
               class="">
                Part 5.1 Measuring income inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="05-04.html#part-52-measuring-other-kinds-of-inequality"
               class="">
                Part 5.2 Measuring other kinds of inequality
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                6—Measuring management practices
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-02.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-02.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-02.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-61-looking-for-patterns-in-the-survey-data"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-03.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-05.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-05.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-05.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="06-04.html"
               class="">
                Part 6.1 Looking for patterns in the survey data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-04.html#part-62-do-management-practices-differ-between-countries"
               class="">
                Part 6.2 Do management practices differ between countries?
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="06-04.html#part-63-what-factors-affect-the-quality-of-management"
               class="">
                Part 6.3 What factors affect the quality of management?
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                7—Supply and demand
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-02.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-02.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-03.html#part-71-drawing-supply-and-demand-diagrams"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-03.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-05.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-05.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="07-04.html"
               class="">
                Part 7.1 Drawing supply and demand diagrams
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="07-04.html#part-72-interpreting-supply-and-demand-curves"
               class="">
                Part 7.2 Interpreting supply and demand curves
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                8—Measuring the non-monetary cost of unemployment
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-02.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-02.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-02.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-03.html#part-81-cleaning-and-summarizing-the-data"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-03.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-03.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-05.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-05.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-05.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="08-04.html"
               class="">
                Part 8.1 Cleaning and summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-04.html#part-82-visualizing-the-data"
               class="">
                Part 8.2 Visualizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="08-04.html#part-83-confidence-intervals-for-difference-in-the-mean"
               class="">
                Part 8.3 Confidence intervals for difference in the mean
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                9—Credit-excluded households in a developing country
            </a>
    <ol class="active">
        <li class="
        no-children
        ">
            <a href="09-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-02.html#part-91-households-that-did-not-get-a-loan"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-02.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="active
        no-file
        no-link
        has-children
        ">
            <a 
               class="active">
                Working in R
            </a>
    <ol class="active">
        <li class="active
        no-children
        ">
            <a href="09-03.html"
               class="active">
                Getting started in R
            </a>
        </li>
        <li class="active
        no-children
        ">
            <a href="09-03.html#part-91-households-that-did-not-get-a-loan"
               class="active">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="active
        no-children
        ">
            <a href="09-03.html#part-92-households-that-got-a-loan"
               class="active">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-05.html#part-91-households-that-did-not-get-a-loan"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-05.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="09-04.html"
               class="">
                Part 9.1 Households that did not get a loan
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="09-04.html#part-92-households-that-got-a-loan"
               class="">
                Part 9.2 Households that got a loan
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                10—Characteristics of banking systems around the world
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-02.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-02.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-03.html#part-101-summarizing-the-data"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-03.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-05.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-05.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="10-04.html"
               class="">
                Part 10.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="10-04.html#part-102-comparing-financial-stability-before-and-after-the-2008-global-financial-crisis"
               class="">
                Part 10.2 Comparing financial stability before and after the 2008 global financial crisis
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                11—Measuring willingness to pay for climate change mitigation
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-02.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-02.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-03.html#part-111-summarizing-the-data"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-03.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-05.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-05.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="11-04.html"
               class="">
                Part 11.1 Summarizing the data
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="11-04.html#part-112-comparing-willingness-to-pay-across-methods-and-individual-characteristics"
               class="">
                Part 11.2 Comparing willingness to pay across methods and individual characteristics
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                12—Government policies and popularity: Hong Kong cash handout
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-01.html"
               class="">
                Learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-01.html#introduction"
               class="">
                Introduction
            </a>
        </li>
        <li class="
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Excel
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-02.html"
               class="">
                Excel-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-02.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-02.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in R
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-03.html"
               class="">
                Getting started in R
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-03.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-03.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Working in Google Sheets
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-05.html"
               class="">
                Google Sheets-specific learning objectives
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-05.html#part-121-inequality"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-05.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-link
        has-children
        ">
            <a 
               class="">
                Solutions
            </a>
    <ol>
        <li class="
        no-children
        ">
            <a href="12-04.html"
               class="">
                Part 12.1 Inequality
            </a>
        </li>
        <li class="
        no-children
        ">
            <a href="12-04.html#part-122-government-popularity"
               class="">
                Part 12.2 Government popularity
            </a>
        </li>
    </ol>
        </li>
    </ol>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-00-technical-reference.html"
               class="">
                Technical Reference
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-01-glossary.html#glossary"
               class="">
                Glossary
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-02-bibliography.html#bibliography"
               class="">
                Bibliography
            </a>
        </li>
        <li class="
        no-file
        no-children
        toc-endmatter">
            <a href="50-03-copyright-acknowledgements.html#copyright-acknowledgements"
               class="">
                Copyright acknowledgements
            </a>
        </li>
    </ol>
            </div><!--.nav-list-->
            <div class="widgets">
            </div><!--.widgets-->
    </div><!--#nav-->
    <div id="footer" dir="ltr">
        <div class="footer-content">
            <div class="footer-logos">
                <a href="http://core-econ.org">
                    <img src="../../assets/coreecon_logo_bw.png">
                </a>
            </div>
            <div class="footer-text">
                <p>This ebook is developed by the CORE project. More information and additional resources for learning and teaching can be found at <a href="https://www.core-econ.org">www.core-econ.org</a>.</p>
            </div>
            <div class="footer-licence">
                <a title="Licensed under Creative Commons BY NC ND" alt="Licensed under Creative Commons BY NC ND" href="https://creativecommons.org/licenses/by-nc-nd/4.0/"><img src="../../assets/cc-byncnd.png"></a>
                <br />
                Version 1.0.0 &bull; Produced by <a href='https://electricbookworks.com'>Electric Book Works</a>
            </div>
        </div><!--.footer-content-->
    </div><!--#footer-->
    <script src="../../assets/js/bundle.js?date=20200224120313"></script>
    <style>
        .js-mcq .mcq-correct .mcq-feedback:before {
            content: "Correct!";
        }
        .js-mcq .mcq-incorrect .mcq-feedback:before {
            content: "Incorrect";
        }
        .js-mcq .mcq-partially-correct .mcq-feedback:before {
            content: "You haven't selected all the correct answers.";
        }
    </style>
</div><!--#wrapper-->
</body>
</html>
